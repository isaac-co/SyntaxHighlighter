<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>

<span class="comment">""" Here I implemented the scoring functions.
    MAE, MSE, RMSE, RMSLE are included.

    Those are used for calculating differences between
    predicted values and actual values.

    Metrics are slightly differentiated. Sometimes squared, rooted,
    even log is used.

    Using log and roots can be perceived as tools for penalizing big
    errors. However, using appropriate metrics depends on the situations,
    and types of data
"""</span>


<span class="comment"># Mean Absolute Error</span>
<span class="keyword">def</span> <span class="identifier">mae</span><span class="grouping">(</span><span class="identifier">predict</span><span class="punctuation">,</span> <span class="identifier">actual</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    Examples(rounded for precision):
    &gt;&gt;&gt; actual = [1,2,3];predict = [1,4,3]
    &gt;&gt;&gt; np.around(mae(predict,actual),decimals = 2)
    0.67

    &gt;&gt;&gt; actual = [1,1,1];predict = [1,1,1]
    &gt;&gt;&gt; mae(predict,actual)
    0.0
    """</span>
    <span class="identifier">predict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span>
    <span class="identifier">actual</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">actual</span><span class="grouping">)</span>

    <span class="identifier">difference</span> <span class="arithmetic-assignment">=</span> <span class="identifier">abs</span><span class="grouping">(</span><span class="identifier">predict</span> <span class="arithmetic-operator">-</span> <span class="identifier">actual</span><span class="grouping">)</span>
    <span class="identifier">score</span> <span class="arithmetic-assignment">=</span> <span class="identifier">difference</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">score</span>


<span class="comment"># Mean Squared Error</span>
<span class="keyword">def</span> <span class="identifier">mse</span><span class="grouping">(</span><span class="identifier">predict</span><span class="punctuation">,</span> <span class="identifier">actual</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    Examples(rounded for precision):
    &gt;&gt;&gt; actual = [1,2,3];predict = [1,4,3]
    &gt;&gt;&gt; np.around(mse(predict,actual),decimals = 2)
    1.33

    &gt;&gt;&gt; actual = [1,1,1];predict = [1,1,1]
    &gt;&gt;&gt; mse(predict,actual)
    0.0
    """</span>
    <span class="identifier">predict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span>
    <span class="identifier">actual</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">actual</span><span class="grouping">)</span>

    <span class="identifier">difference</span> <span class="arithmetic-assignment">=</span> <span class="identifier">predict</span> <span class="arithmetic-operator">-</span> <span class="identifier">actual</span>
    <span class="identifier">square_diff</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">square</span><span class="grouping">(</span><span class="identifier">difference</span><span class="grouping">)</span>

    <span class="identifier">score</span> <span class="arithmetic-assignment">=</span> <span class="identifier">square_diff</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">score</span>


<span class="comment"># Root Mean Squared Error</span>
<span class="keyword">def</span> <span class="identifier">rmse</span><span class="grouping">(</span><span class="identifier">predict</span><span class="punctuation">,</span> <span class="identifier">actual</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    Examples(rounded for precision):
    &gt;&gt;&gt; actual = [1,2,3];predict = [1,4,3]
    &gt;&gt;&gt; np.around(rmse(predict,actual),decimals = 2)
    1.15

    &gt;&gt;&gt; actual = [1,1,1];predict = [1,1,1]
    &gt;&gt;&gt; rmse(predict,actual)
    0.0
    """</span>
    <span class="identifier">predict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span>
    <span class="identifier">actual</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">actual</span><span class="grouping">)</span>

    <span class="identifier">difference</span> <span class="arithmetic-assignment">=</span> <span class="identifier">predict</span> <span class="arithmetic-operator">-</span> <span class="identifier">actual</span>
    <span class="identifier">square_diff</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">square</span><span class="grouping">(</span><span class="identifier">difference</span><span class="grouping">)</span>
    <span class="identifier">mean_square_diff</span> <span class="arithmetic-assignment">=</span> <span class="identifier">square_diff</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">score</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sqrt</span><span class="grouping">(</span><span class="identifier">mean_square_diff</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">score</span>


<span class="comment"># Root Mean Square Logarithmic Error</span>
<span class="keyword">def</span> <span class="identifier">rmsle</span><span class="grouping">(</span><span class="identifier">predict</span><span class="punctuation">,</span> <span class="identifier">actual</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    Examples(rounded for precision):
    &gt;&gt;&gt; actual = [10,10,30];predict = [10,2,30]
    &gt;&gt;&gt; np.around(rmsle(predict,actual),decimals = 2)
    0.75

    &gt;&gt;&gt; actual = [1,1,1];predict = [1,1,1]
    &gt;&gt;&gt; rmsle(predict,actual)
    0.0
    """</span>
    <span class="identifier">predict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span>
    <span class="identifier">actual</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">actual</span><span class="grouping">)</span>

    <span class="identifier">log_predict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">log</span><span class="grouping">(</span><span class="identifier">predict</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="grouping">)</span>
    <span class="identifier">log_actual</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">log</span><span class="grouping">(</span><span class="identifier">actual</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="grouping">)</span>

    <span class="identifier">difference</span> <span class="arithmetic-assignment">=</span> <span class="identifier">log_predict</span> <span class="arithmetic-operator">-</span> <span class="identifier">log_actual</span>
    <span class="identifier">square_diff</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">square</span><span class="grouping">(</span><span class="identifier">difference</span><span class="grouping">)</span>
    <span class="identifier">mean_square_diff</span> <span class="arithmetic-assignment">=</span> <span class="identifier">square_diff</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="identifier">score</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sqrt</span><span class="grouping">(</span><span class="identifier">mean_square_diff</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">score</span>


<span class="comment"># Mean Bias Deviation</span>
<span class="keyword">def</span> <span class="identifier">mbd</span><span class="grouping">(</span><span class="identifier">predict</span><span class="punctuation">,</span> <span class="identifier">actual</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    This value is Negative, if the model underpredicts,
    positive, if it overpredicts.

    Example(rounded for precision):

    Here the model overpredicts
    &gt;&gt;&gt; actual = [1,2,3];predict = [2,3,4]
    &gt;&gt;&gt; np.around(mbd(predict,actual),decimals = 2)
    50.0

    Here the model underpredicts
    &gt;&gt;&gt; actual = [1,2,3];predict = [0,1,1]
    &gt;&gt;&gt; np.around(mbd(predict,actual),decimals = 2)
    -66.67
    """</span>
    <span class="identifier">predict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span>
    <span class="identifier">actual</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">actual</span><span class="grouping">)</span>

    <span class="identifier">difference</span> <span class="arithmetic-assignment">=</span> <span class="identifier">predict</span> <span class="arithmetic-operator">-</span> <span class="identifier">actual</span>
    <span class="identifier">numerator</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">difference</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span>
    <span class="identifier">denumerator</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">actual</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span>
    <span class="comment"># print(numerator, denumerator)</span>
    <span class="identifier">score</span> <span class="arithmetic-assignment">=</span> <span class="identifier">float</span><span class="grouping">(</span><span class="identifier">numerator</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">denumerator</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span>

    <span class="keyword">return</span> <span class="identifier">score</span>


<span class="keyword">def</span> <span class="identifier">manual_accuracy</span><span class="grouping">(</span><span class="identifier">predict</span><span class="punctuation">,</span> <span class="identifier">actual</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="keyword">return</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">actual</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">predict</span><span class="grouping">)</span><span class="grouping">)</span>

    </pre>
  </body>
</html>