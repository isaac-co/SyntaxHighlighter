<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
===================================
Simple 1D Kernel Density Estimation
===================================
This example uses the :class:`~sklearn.neighbors.KernelDensity` class to
demonstrate the principles of Kernel Density Estimation in one dimension.

The first plot shows one of the problems with using histograms to visualize
the density of points in 1D. Intuitively, a histogram can be thought of as a
scheme in which a unit "block" is stacked above each point on a regular grid.
As the top two panels show, however, the choice of gridding for these blocks
can lead to wildly divergent ideas about the underlying shape of the density
distribution.  If we instead center each block on the point it represents, we
get the estimate shown in the bottom left panel.  This is a kernel density
estimation with a "top hat" kernel.  This idea can be generalized to other
kernel shapes: the bottom-right panel of the first figure shows a Gaussian
kernel density estimate over the same distribution.

Scikit-learn implements efficient kernel density estimation using either
a Ball Tree or KD Tree structure, through the
:class:`~sklearn.neighbors.KernelDensity` estimator.  The available kernels
are shown in the second figure of this example.

The third figure compares kernel density estimates for a distribution of 100
samples in 1 dimension.  Though this example uses 1D distributions, kernel
density estimation is easily and efficiently extensible to higher dimensions
as well.
"""</span>
<span class="comment"># Author: Jake Vanderplas &lt;jakevdp@cs.washington.edu&gt;</span>
<span class="comment">#</span>
<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="keyword">from</span> <span class="identifier">scipy</span><span class="punctuation">.</span><span class="identifier">stats</span> <span class="keyword">import</span> <span class="identifier">norm</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">neighbors</span> <span class="keyword">import</span> <span class="identifier">KernelDensity</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">utils</span><span class="punctuation">.</span><span class="identifier">fixes</span> <span class="keyword">import</span> <span class="identifier">parse_version</span>

<span class="comment"># `normed` is being deprecated in favor of `density` in histograms</span>
<span class="keyword">if</span> <span class="identifier">parse_version</span><span class="grouping">(</span><span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">__version__</span><span class="grouping">)</span> <span class="relational-operator">&gt;=</span> <span class="identifier">parse_version</span><span class="grouping">(</span><span class="string-literal">'2.1'</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">density_param</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="string-literal">'density'</span><span class="punctuation">:</span> <span class="bool-literal">True</span><span class="grouping">}</span>
<span class="keyword">else</span><span class="punctuation">:</span>
    <span class="identifier">density_param</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="string-literal">'normed'</span><span class="punctuation">:</span> <span class="bool-literal">True</span><span class="grouping">}</span>

<span class="comment"># ----------------------------------------------------------------------</span>
<span class="comment"># Plot the progression of histograms to kernels</span>
<span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">seed</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span>
<span class="identifier">N</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">20</span>
<span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">concatenate</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">normal</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">int</span><span class="grouping">(</span><span class="float-literal">0.3</span> <span class="arithmetic-operator">*</span> <span class="identifier">N</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                    <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">normal</span><span class="grouping">(</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">int</span><span class="grouping">(</span><span class="float-literal">0.7</span> <span class="arithmetic-operator">*</span> <span class="identifier">N</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">newaxis</span><span class="grouping">]</span>
<span class="identifier">X_plot</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="punctuation">,</span> <span class="int-literal">1000</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">newaxis</span><span class="grouping">]</span>
<span class="identifier">bins</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="grouping">)</span>

<span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">sharex</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">sharey</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
<span class="identifier">fig</span><span class="punctuation">.</span><span class="identifier">subplots_adjust</span><span class="grouping">(</span><span class="identifier">hspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.05</span><span class="punctuation">,</span> <span class="identifier">wspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.05</span><span class="grouping">)</span>

<span class="comment"># histogram 1</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">hist</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">bins</span><span class="arithmetic-assignment">=</span><span class="identifier">bins</span><span class="punctuation">,</span> <span class="identifier">fc</span><span class="arithmetic-assignment">=</span><span class="string-literal">'#AAAAFF'</span><span class="punctuation">,</span> <span class="arithmetic-operator">**</span><span class="identifier">density_param</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span><span class="float-literal">-3.5</span><span class="punctuation">,</span> <span class="float-literal">0.31</span><span class="punctuation">,</span> <span class="string-literal">"Histogram"</span><span class="grouping">)</span>

<span class="comment"># histogram 2</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">hist</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">bins</span><span class="arithmetic-assignment">=</span><span class="identifier">bins</span> <span class="arithmetic-operator">+</span> <span class="float-literal">0.75</span><span class="punctuation">,</span> <span class="identifier">fc</span><span class="arithmetic-assignment">=</span><span class="string-literal">'#AAAAFF'</span><span class="punctuation">,</span> <span class="arithmetic-operator">**</span><span class="identifier">density_param</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span><span class="float-literal">-3.5</span><span class="punctuation">,</span> <span class="float-literal">0.31</span><span class="punctuation">,</span> <span class="string-literal">"Histogram, bins shifted"</span><span class="grouping">)</span>

<span class="comment"># tophat KDE</span>
<span class="identifier">kde</span> <span class="arithmetic-assignment">=</span> <span class="identifier">KernelDensity</span><span class="grouping">(</span><span class="identifier">kernel</span><span class="arithmetic-assignment">=</span><span class="string-literal">'tophat'</span><span class="punctuation">,</span> <span class="identifier">bandwidth</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.75</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
<span class="identifier">log_dens</span> <span class="arithmetic-assignment">=</span> <span class="identifier">kde</span><span class="punctuation">.</span><span class="identifier">score_samples</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">fill</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">exp</span><span class="grouping">(</span><span class="identifier">log_dens</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">fc</span><span class="arithmetic-assignment">=</span><span class="string-literal">'#AAAAFF'</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span><span class="float-literal">-3.5</span><span class="punctuation">,</span> <span class="float-literal">0.31</span><span class="punctuation">,</span> <span class="string-literal">"Tophat Kernel Density"</span><span class="grouping">)</span>

<span class="comment"># Gaussian KDE</span>
<span class="identifier">kde</span> <span class="arithmetic-assignment">=</span> <span class="identifier">KernelDensity</span><span class="grouping">(</span><span class="identifier">kernel</span><span class="arithmetic-assignment">=</span><span class="string-literal">'gaussian'</span><span class="punctuation">,</span> <span class="identifier">bandwidth</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.75</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
<span class="identifier">log_dens</span> <span class="arithmetic-assignment">=</span> <span class="identifier">kde</span><span class="punctuation">.</span><span class="identifier">score_samples</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">fill</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">exp</span><span class="grouping">(</span><span class="identifier">log_dens</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">fc</span><span class="arithmetic-assignment">=</span><span class="string-literal">'#AAAAFF'</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span><span class="float-literal">-3.5</span><span class="punctuation">,</span> <span class="float-literal">0.31</span><span class="punctuation">,</span> <span class="string-literal">"Gaussian Kernel Density"</span><span class="grouping">)</span>

<span class="keyword">for</span> <span class="identifier">axi</span> <span class="relational-operator">in</span> <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">full</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="float-literal">-0.01</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="string-literal">'+k'</span><span class="grouping">)</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">set_xlim</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">9</span><span class="grouping">)</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">set_ylim</span><span class="grouping">(</span><span class="float-literal">-0.02</span><span class="punctuation">,</span> <span class="float-literal">0.34</span><span class="grouping">)</span>

<span class="keyword">for</span> <span class="identifier">axi</span> <span class="relational-operator">in</span> <span class="identifier">ax</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">:</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">set_ylabel</span><span class="grouping">(</span><span class="string-literal">'Normalized Density'</span><span class="grouping">)</span>

<span class="keyword">for</span> <span class="identifier">axi</span> <span class="relational-operator">in</span> <span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="punctuation">:</span><span class="grouping">]</span><span class="punctuation">:</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">set_xlabel</span><span class="grouping">(</span><span class="string-literal">'x'</span><span class="grouping">)</span>

<span class="comment"># ----------------------------------------------------------------------</span>
<span class="comment"># Plot all available kernels</span>
<span class="identifier">X_plot</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="int-literal">6</span><span class="punctuation">,</span> <span class="int-literal">1000</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">]</span>
<span class="identifier">X_src</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="identifier">sharex</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">sharey</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
<span class="identifier">fig</span><span class="punctuation">.</span><span class="identifier">subplots_adjust</span><span class="grouping">(</span><span class="identifier">left</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.05</span><span class="punctuation">,</span> <span class="identifier">right</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.95</span><span class="punctuation">,</span> <span class="identifier">hspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.05</span><span class="punctuation">,</span> <span class="identifier">wspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.05</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">u</span><span class="invalid">n</span><span class="invalid">c</span><span class="grouping">(</span><span class="identifier">x</span><span class="punctuation">,</span> <span class="identifier">loc</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="keyword">if</span> <span class="identifier">x</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="string-literal">'0'</span>
    <span class="keyword">elif</span> <span class="identifier">x</span> <span class="relational-operator">==</span> <span class="int-literal">1</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="string-literal">'h'</span>
    <span class="keyword">elif</span> <span class="identifier">x</span> <span class="relational-operator">==</span> <span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="string-literal">'-h'</span>
    <span class="keyword">else</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="string-literal">'%ih'</span> <span class="arithmetic-operator">%</span> <span class="identifier">x</span>

<span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">kernel</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="grouping">[</span><span class="string-literal">'gaussian', 'tophat', 'epanechnikov'</span><span class="punctuation">,</span>
                            <span class="string-literal">'exponential', 'linear', 'cosine'</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">axi</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span>
    <span class="identifier">log_dens</span> <span class="arithmetic-assignment">=</span> <span class="identifier">KernelDensity</span><span class="grouping">(</span><span class="identifier">kernel</span><span class="arithmetic-assignment">=</span><span class="identifier">kernel</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X_src</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">score_samples</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">)</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">fill</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">exp</span><span class="grouping">(</span><span class="identifier">log_dens</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="string-literal">'-k', fc='#AAAAFF'</span><span class="grouping">)</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span><span class="float-literal">-2.6</span><span class="punctuation">,</span> <span class="float-literal">0.95</span><span class="punctuation">,</span> <span class="identifier">kernel</span><span class="grouping">)</span>

    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">xaxis</span><span class="punctuation">.</span><span class="identifier">set_major_formatter</span><span class="grouping">(</span><span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">FuncFormatter</span><span class="grouping">(</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">u</span><span class="invalid">n</span><span class="invalid">c</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">xaxis</span><span class="punctuation">.</span><span class="identifier">set_major_locator</span><span class="grouping">(</span><span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">MultipleLocator</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">yaxis</span><span class="punctuation">.</span><span class="identifier">set_major_locator</span><span class="grouping">(</span><span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">NullLocator</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>

    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">set_ylim</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="float-literal">1.05</span><span class="grouping">)</span>
    <span class="identifier">axi</span><span class="punctuation">.</span><span class="identifier">set_xlim</span><span class="grouping">(</span><span class="float-literal">-2.9</span><span class="punctuation">,</span> <span class="float-literal">2.9</span><span class="grouping">)</span>

<span class="identifier">ax</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">set_title</span><span class="grouping">(</span><span class="string-literal">'Available Kernels'</span><span class="grouping">)</span>

<span class="comment"># ----------------------------------------------------------------------</span>
<span class="comment"># Plot a 1D density example</span>
<span class="identifier">N</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">100</span>
<span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">seed</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span>
<span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">concatenate</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">normal</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">int</span><span class="grouping">(</span><span class="float-literal">0.3</span> <span class="arithmetic-operator">*</span> <span class="identifier">N</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                    <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">normal</span><span class="grouping">(</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">int</span><span class="grouping">(</span><span class="float-literal">0.7</span> <span class="arithmetic-operator">*</span> <span class="identifier">N</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">newaxis</span><span class="grouping">]</span>

<span class="identifier">X_plot</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="punctuation">,</span> <span class="int-literal">1000</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">newaxis</span><span class="grouping">]</span>

<span class="identifier">true_dens</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="float-literal">0.3</span> <span class="arithmetic-operator">*</span> <span class="identifier">norm</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">pdf</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
             <span class="arithmetic-operator">+</span> <span class="float-literal">0.7</span> <span class="arithmetic-operator">*</span> <span class="identifier">norm</span><span class="grouping">(</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">pdf</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">fill</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">true_dens</span><span class="punctuation">,</span> <span class="identifier">fc</span><span class="arithmetic-assignment">=</span><span class="string-literal">'black'</span><span class="punctuation">,</span> <span class="identifier">alpha</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.2</span><span class="punctuation">,</span>
        <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">'input distribution'</span><span class="grouping">)</span>
<span class="identifier">colors</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'navy', 'cornflowerblue', 'darkorange'</span><span class="grouping">]</span>
<span class="identifier">kernels</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'gaussian', 'tophat', 'epanechnikov'</span><span class="grouping">]</span>
<span class="identifier">lw</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">2</span>

<span class="keyword">for</span> <span class="identifier">color</span><span class="punctuation">,</span> <span class="identifier">kernel</span> <span class="relational-operator">in</span> <span class="identifier">zip</span><span class="grouping">(</span><span class="identifier">colors</span><span class="punctuation">,</span> <span class="identifier">kernels</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">kde</span> <span class="arithmetic-assignment">=</span> <span class="identifier">KernelDensity</span><span class="grouping">(</span><span class="identifier">kernel</span><span class="arithmetic-assignment">=</span><span class="identifier">kernel</span><span class="punctuation">,</span> <span class="identifier">bandwidth</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.5</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
    <span class="identifier">log_dens</span> <span class="arithmetic-assignment">=</span> <span class="identifier">kde</span><span class="punctuation">.</span><span class="identifier">score_samples</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">X_plot</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">exp</span><span class="grouping">(</span><span class="identifier">log_dens</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="identifier">color</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="identifier">lw</span><span class="punctuation">,</span>
            <span class="identifier">linestyle</span><span class="arithmetic-assignment">=</span><span class="string-literal">'-', label="kernel = '{0}'</span><span class="invalid">"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">kernel</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="float-literal">0.38</span><span class="punctuation">,</span> <span class="string-literal">"N={0} points"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">N</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">legend</span><span class="grouping">(</span><span class="identifier">loc</span><span class="arithmetic-assignment">=</span><span class="string-literal">'upper left'</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="float-literal">-0.005</span> <span class="arithmetic-operator">-</span> <span class="float-literal">0.01</span> <span class="arithmetic-operator">*</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">random</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="string-literal">'+k'</span><span class="grouping">)</span>

<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_xlim</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">9</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_ylim</span><span class="grouping">(</span><span class="float-literal">-0.02</span><span class="punctuation">,</span> <span class="float-literal">0.4</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>