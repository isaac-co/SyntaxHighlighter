<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">#!/usr/bin/python</span>
<span class="comment"># -*- coding: utf-8 -*-</span>

<span class="comment">"""
=================================================================
Iso-probability lines for Gaussian Processes classification (GPC)
=================================================================

A two-dimensional classification example showing iso-probability lines for
the predicted probabilities.
"""</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">__doc__</span><span class="grouping">)</span>

<span class="comment"># Author: Vincent Dubourg &lt;vincent.dubourg@gmail.com&gt;</span>
<span class="comment"># Adapted to GaussianProcessClassifier:</span>
<span class="comment">#         Jan Hendrik Metzen &lt;jhm@informatik.uni-bremen.de&gt;</span>
<span class="comment"># License: BSD 3 clause</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>

<span class="keyword">from</span> <span class="identifier">matplotlib</span> <span class="keyword">import</span> <span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="keyword">from</span> <span class="identifier">matplotlib</span> <span class="keyword">import</span> <span class="identifier">cm</span>

<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">gaussian_process</span> <span class="keyword">import</span> <span class="identifier">GaussianProcessClassifier</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">gaussian_process</span><span class="punctuation">.</span><span class="identifier">kernels</span> <span class="keyword">import</span> <span class="identifier">DotProduct</span><span class="punctuation">,</span> <span class="identifier">ConstantKernel</span> <span class="keyword">as</span> <span class="identifier">C</span>

<span class="comment"># A few constants</span>
<span class="identifier">lim</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">8</span>


<span class="keyword">def</span> <span class="identifier">g</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""The function to predict (classification will then consist in predicting
    whether g(x) &lt;= 0 or not)"""</span>
    <span class="keyword">return</span> <span class="int-literal">5</span><span class="punctuation">.</span> <span class="arithmetic-operator">-</span> <span class="identifier">x</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span> <span class="arithmetic-operator">-</span> <span class="float-literal">.5</span> <span class="arithmetic-operator">*</span> <span class="identifier">x</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span><span class="punctuation">.</span>

<span class="comment"># Design of experiments</span>
<span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">[</span><span class="float-literal">-4.61611719</span><span class="punctuation">,</span> <span class="float-literal">-6.00099547</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="float-literal">4.10469096</span><span class="punctuation">,</span> <span class="float-literal">5.32782448</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="float-literal">0.00000000</span><span class="punctuation">,</span> <span class="float-literal">-0.50000000</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="float-literal">-6.17289014</span><span class="punctuation">,</span> <span class="float-literal">-4.6984743</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="float-literal">1.3109306</span><span class="punctuation">,</span> <span class="float-literal">-6.93271427</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="float-literal">-5.03823144</span><span class="punctuation">,</span> <span class="float-literal">3.10584743</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="float-literal">-2.87600388</span><span class="punctuation">,</span> <span class="float-literal">6.74310541</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="float-literal">5.21301203</span><span class="punctuation">,</span> <span class="float-literal">4.26386883</span><span class="grouping">]</span><span class="grouping">]</span><span class="grouping">)</span>

<span class="comment"># Observations</span>
<span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">g</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="grouping">)</span>

<span class="comment"># Instantiate and fit Gaussian Process Model</span>
<span class="identifier">kernel</span> <span class="arithmetic-assignment">=</span> <span class="identifier">C</span><span class="grouping">(</span><span class="float-literal">0.1</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="float-literal">1e-5</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">inf</span><span class="grouping">)</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="identifier">DotProduct</span><span class="grouping">(</span><span class="identifier">sigma_0</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.1</span><span class="grouping">)</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span>
<span class="identifier">gp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">GaussianProcessClassifier</span><span class="grouping">(</span><span class="identifier">kernel</span><span class="arithmetic-assignment">=</span><span class="identifier">kernel</span><span class="grouping">)</span>
<span class="identifier">gp</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="grouping">)</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Learned kernel: %s "</span> <span class="arithmetic-operator">%</span> <span class="identifier">gp</span><span class="punctuation">.</span><span class="identifier">kernel_</span><span class="grouping">)</span>

<span class="comment"># Evaluate real function and the predicted probability</span>
<span class="identifier">res</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">50</span>
<span class="identifier">x1</span><span class="punctuation">,</span> <span class="identifier">x2</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">meshgrid</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="arithmetic-operator">-</span> <span class="identifier">lim</span><span class="punctuation">,</span> <span class="identifier">lim</span><span class="punctuation">,</span> <span class="identifier">res</span><span class="grouping">)</span><span class="punctuation">,</span>
                     <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="arithmetic-operator">-</span> <span class="identifier">lim</span><span class="punctuation">,</span> <span class="identifier">lim</span><span class="punctuation">,</span> <span class="identifier">res</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">xx</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">vstack</span><span class="grouping">(</span><span class="grouping">[</span><span class="identifier">x1</span><span class="punctuation">.</span><span class="identifier">reshape</span><span class="grouping">(</span><span class="identifier">x1</span><span class="punctuation">.</span><span class="identifier">size</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">x2</span><span class="punctuation">.</span><span class="identifier">reshape</span><span class="grouping">(</span><span class="identifier">x2</span><span class="punctuation">.</span><span class="identifier">size</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">T</span>

<span class="identifier">y_true</span> <span class="arithmetic-assignment">=</span> <span class="identifier">g</span><span class="grouping">(</span><span class="identifier">xx</span><span class="grouping">)</span>
<span class="identifier">y_prob</span> <span class="arithmetic-assignment">=</span> <span class="identifier">gp</span><span class="punctuation">.</span><span class="identifier">predict_proba</span><span class="grouping">(</span><span class="identifier">xx</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span>
<span class="identifier">y_true</span> <span class="arithmetic-assignment">=</span> <span class="identifier">y_true</span><span class="punctuation">.</span><span class="identifier">reshape</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">res</span><span class="punctuation">,</span> <span class="identifier">res</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">y_prob</span> <span class="arithmetic-assignment">=</span> <span class="identifier">y_prob</span><span class="punctuation">.</span><span class="identifier">reshape</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">res</span><span class="punctuation">,</span> <span class="identifier">res</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="comment"># Plot the probabilistic classification iso-values</span>
<span class="identifier">fig</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">figure</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span>
<span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">fig</span><span class="punctuation">.</span><span class="identifier">gca</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">axes</span><span class="punctuation">.</span><span class="identifier">set_aspect</span><span class="grouping">(</span><span class="string-literal">'equal'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">xticks</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">yticks</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_xticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_yticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">xlabel</span><span class="grouping">(</span><span class="string-literal">'$x_1$'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">ylabel</span><span class="grouping">(</span><span class="string-literal">'$x_2$'</span><span class="grouping">)</span>

<span class="identifier">cax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">imshow</span><span class="grouping">(</span><span class="identifier">y_prob</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">gray_r</span><span class="punctuation">,</span> <span class="identifier">alpha</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.8</span><span class="punctuation">,</span>
                 <span class="identifier">extent</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="identifier">lim</span><span class="punctuation">,</span> <span class="identifier">lim</span><span class="punctuation">,</span> <span class="arithmetic-operator">-</span><span class="identifier">lim</span><span class="punctuation">,</span> <span class="identifier">lim</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">norm</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">colors</span><span class="punctuation">.</span><span class="identifier">Normalize</span><span class="grouping">(</span><span class="identifier">vmin</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="identifier">vmax</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.9</span><span class="grouping">)</span>
<span class="identifier">cb</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">colorbar</span><span class="grouping">(</span><span class="identifier">cax</span><span class="punctuation">,</span> <span class="identifier">ticks</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="float-literal">0.2</span><span class="punctuation">,</span> <span class="float-literal">0.4</span><span class="punctuation">,</span> <span class="float-literal">0.6</span><span class="punctuation">,</span> <span class="float-literal">0.8</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">.</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">norm</span><span class="arithmetic-assignment">=</span><span class="identifier">norm</span><span class="grouping">)</span>
<span class="identifier">cb</span><span class="punctuation">.</span><span class="identifier">set_label</span><span class="grouping">(</span><span class="identifier">r</span><span class="string-literal">'${\rm \mathbb{P}}\left[\widehat{G}(\mathbf{x}) \leq 0\right]$'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">clim</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">&lt;=</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">&lt;=</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="string-literal">'r.'</span><span class="punctuation">,</span> <span class="identifier">markersize</span><span class="arithmetic-assignment">=</span><span class="int-literal">12</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="string-literal">'b.'</span><span class="punctuation">,</span> <span class="identifier">markersize</span><span class="arithmetic-assignment">=</span><span class="int-literal">12</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">contour</span><span class="grouping">(</span><span class="identifier">x1</span><span class="punctuation">,</span> <span class="identifier">x2</span><span class="punctuation">,</span> <span class="identifier">y_true</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">.</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">colors</span><span class="arithmetic-assignment">=</span><span class="string-literal">'k', linestyles='dashdot'</span><span class="grouping">)</span>

<span class="identifier">cs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">contour</span><span class="grouping">(</span><span class="identifier">x1</span><span class="punctuation">,</span> <span class="identifier">x2</span><span class="punctuation">,</span> <span class="identifier">y_prob</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">0.666</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">colors</span><span class="arithmetic-assignment">=</span><span class="string-literal">'b'</span><span class="punctuation">,</span>
                 <span class="identifier">linestyles</span><span class="arithmetic-assignment">=</span><span class="string-literal">'solid'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">clabel</span><span class="grouping">(</span><span class="identifier">cs</span><span class="punctuation">,</span> <span class="identifier">fontsize</span><span class="arithmetic-assignment">=</span><span class="int-literal">11</span><span class="grouping">)</span>

<span class="identifier">cs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">contour</span><span class="grouping">(</span><span class="identifier">x1</span><span class="punctuation">,</span> <span class="identifier">x2</span><span class="punctuation">,</span> <span class="identifier">y_prob</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">0.5</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">colors</span><span class="arithmetic-assignment">=</span><span class="string-literal">'k'</span><span class="punctuation">,</span>
                 <span class="identifier">linestyles</span><span class="arithmetic-assignment">=</span><span class="string-literal">'dashed'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">clabel</span><span class="grouping">(</span><span class="identifier">cs</span><span class="punctuation">,</span> <span class="identifier">fontsize</span><span class="arithmetic-assignment">=</span><span class="int-literal">11</span><span class="grouping">)</span>

<span class="identifier">cs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">contour</span><span class="grouping">(</span><span class="identifier">x1</span><span class="punctuation">,</span> <span class="identifier">x2</span><span class="punctuation">,</span> <span class="identifier">y_prob</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">0.334</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">colors</span><span class="arithmetic-assignment">=</span><span class="string-literal">'r'</span><span class="punctuation">,</span>
                 <span class="identifier">linestyles</span><span class="arithmetic-assignment">=</span><span class="string-literal">'solid'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">clabel</span><span class="grouping">(</span><span class="identifier">cs</span><span class="punctuation">,</span> <span class="identifier">fontsize</span><span class="arithmetic-assignment">=</span><span class="int-literal">11</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>