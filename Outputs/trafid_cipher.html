<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment"># https://en.wikipedia.org/wiki/Trifid_cipher</span>


<span class="keyword">def</span> <span class="identifier">__encryptPart</span><span class="grouping">(</span><span class="identifier">messagePart</span><span class="punctuation">:</span> <span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">character2Number</span><span class="punctuation">:</span> <span class="identifier">dict</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">str</span><span class="punctuation">:</span>
    <span class="identifier">one</span><span class="punctuation">,</span> <span class="identifier">two</span><span class="punctuation">,</span> <span class="identifier">three</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"", "", ""</span>
    <span class="identifier">tmp</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>

    <span class="keyword">for</span> <span class="identifier">character</span> <span class="relational-operator">in</span> <span class="identifier">messagePart</span><span class="punctuation">:</span>
        <span class="identifier">tmp</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">character2Number</span><span class="grouping">[</span><span class="identifier">character</span><span class="grouping">]</span><span class="grouping">)</span>

    <span class="keyword">for</span> <span class="identifier">each</span> <span class="relational-operator">in</span> <span class="identifier">tmp</span><span class="punctuation">:</span>
        <span class="identifier">one</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">each</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
        <span class="identifier">two</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">each</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span>
        <span class="identifier">three</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">each</span><span class="grouping">[</span><span class="int-literal">2</span><span class="grouping">]</span>

    <span class="keyword">return</span> <span class="identifier">one</span> <span class="arithmetic-operator">+</span> <span class="identifier">two</span> <span class="arithmetic-operator">+</span> <span class="identifier">three</span>


<span class="keyword">def</span> <span class="identifier">__decryptPart</span><span class="grouping">(</span>
    <span class="identifier">messagePart</span><span class="punctuation">:</span> <span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">character2Number</span><span class="punctuation">:</span> <span class="identifier">dict</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">tuple</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="punctuation">:</span>
    <span class="identifier">tmp</span><span class="punctuation">,</span> <span class="identifier">thisPart</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"", ""</span>
    <span class="identifier">result</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>

    <span class="keyword">for</span> <span class="identifier">character</span> <span class="relational-operator">in</span> <span class="identifier">messagePart</span><span class="punctuation">:</span>
        <span class="identifier">thisPart</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">character2Number</span><span class="grouping">[</span><span class="identifier">character</span><span class="grouping">]</span>

    <span class="keyword">for</span> <span class="identifier">digit</span> <span class="relational-operator">in</span> <span class="identifier">thisPart</span><span class="punctuation">:</span>
        <span class="identifier">tmp</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">digit</span>
        <span class="keyword">if</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">tmp</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">messagePart</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">result</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">tmp</span><span class="grouping">)</span>
            <span class="identifier">tmp</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>

    <span class="keyword">return</span> <span class="identifier">result</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">result</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">result</span><span class="grouping">[</span><span class="int-literal">2</span><span class="grouping">]</span>


<span class="keyword">def</span> <span class="identifier">__prepare</span><span class="grouping">(</span>
    <span class="identifier">message</span><span class="punctuation">:</span> <span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="punctuation">:</span> <span class="identifier">str</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">tuple</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">dict</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">dict</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="grouping">]</span><span class="punctuation">:</span>
    <span class="comment"># Validate message and alphabet, set to upper and remove spaces</span>
    <span class="identifier">alphabet</span> <span class="arithmetic-assignment">=</span> <span class="identifier">alphabet</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">" ", ""</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">upper</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">message</span> <span class="arithmetic-assignment">=</span> <span class="identifier">message</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">" ", ""</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">upper</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="comment"># Check length and characters</span>
    <span class="keyword">if</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">alphabet</span><span class="grouping">)</span> <span class="relational-operator">!=</span> <span class="int-literal">27</span><span class="punctuation">:</span>
        <span class="keyword">raise</span> <span class="identifier">KeyError</span><span class="grouping">(</span><span class="string-literal">"Length of alphabet has to be 27."</span><span class="grouping">)</span>
    <span class="keyword">for</span> <span class="identifier">each</span> <span class="relational-operator">in</span> <span class="identifier">message</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="identifier">each</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="identifier">alphabet</span><span class="punctuation">:</span>
            <span class="keyword">raise</span> <span class="identifier">ValueError</span><span class="grouping">(</span><span class="string-literal">"Each message character has to be included in alphabet!"</span><span class="grouping">)</span>

    <span class="comment"># Generate dictionares</span>
    <span class="identifier">numbers</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span>
        <span class="string-literal">"111"</span><span class="punctuation">,</span>
        <span class="string-literal">"112"</span><span class="punctuation">,</span>
        <span class="string-literal">"113"</span><span class="punctuation">,</span>
        <span class="string-literal">"121"</span><span class="punctuation">,</span>
        <span class="string-literal">"122"</span><span class="punctuation">,</span>
        <span class="string-literal">"123"</span><span class="punctuation">,</span>
        <span class="string-literal">"131"</span><span class="punctuation">,</span>
        <span class="string-literal">"132"</span><span class="punctuation">,</span>
        <span class="string-literal">"133"</span><span class="punctuation">,</span>
        <span class="string-literal">"211"</span><span class="punctuation">,</span>
        <span class="string-literal">"212"</span><span class="punctuation">,</span>
        <span class="string-literal">"213"</span><span class="punctuation">,</span>
        <span class="string-literal">"221"</span><span class="punctuation">,</span>
        <span class="string-literal">"222"</span><span class="punctuation">,</span>
        <span class="string-literal">"223"</span><span class="punctuation">,</span>
        <span class="string-literal">"231"</span><span class="punctuation">,</span>
        <span class="string-literal">"232"</span><span class="punctuation">,</span>
        <span class="string-literal">"233"</span><span class="punctuation">,</span>
        <span class="string-literal">"311"</span><span class="punctuation">,</span>
        <span class="string-literal">"312"</span><span class="punctuation">,</span>
        <span class="string-literal">"313"</span><span class="punctuation">,</span>
        <span class="string-literal">"321"</span><span class="punctuation">,</span>
        <span class="string-literal">"322"</span><span class="punctuation">,</span>
        <span class="string-literal">"323"</span><span class="punctuation">,</span>
        <span class="string-literal">"331"</span><span class="punctuation">,</span>
        <span class="string-literal">"332"</span><span class="punctuation">,</span>
        <span class="string-literal">"333"</span><span class="punctuation">,</span>
    <span class="grouping">)</span>
    <span class="identifier">character2Number</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="grouping">}</span>
    <span class="identifier">number2Character</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="grouping">}</span>
    <span class="keyword">for</span> <span class="identifier">letter</span><span class="punctuation">,</span> <span class="identifier">number</span> <span class="relational-operator">in</span> <span class="identifier">zip</span><span class="grouping">(</span><span class="identifier">alphabet</span><span class="punctuation">,</span> <span class="identifier">numbers</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">character2Number</span><span class="grouping">[</span><span class="identifier">letter</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">number</span>
        <span class="identifier">number2Character</span><span class="grouping">[</span><span class="identifier">number</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">letter</span>

    <span class="keyword">return</span> <span class="identifier">message</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="punctuation">,</span> <span class="identifier">character2Number</span><span class="punctuation">,</span> <span class="identifier">number2Character</span>


<span class="keyword">def</span> <span class="identifier">encryptMessage</span><span class="grouping">(</span>
    <span class="identifier">message</span><span class="punctuation">:</span> <span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="punctuation">:</span> <span class="identifier">str</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"ABCDEFGHIJKLMNOPQRSTUVWXYZ."</span><span class="punctuation">,</span> <span class="identifier">period</span><span class="punctuation">:</span> <span class="identifier">int</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">5</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">str</span><span class="punctuation">:</span>
    <span class="identifier">message</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="punctuation">,</span> <span class="identifier">character2Number</span><span class="punctuation">,</span> <span class="identifier">number2Character</span> <span class="arithmetic-assignment">=</span> <span class="identifier">__prepare</span><span class="grouping">(</span><span class="identifier">message</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="grouping">)</span>
    <span class="identifier">encrypted</span><span class="punctuation">,</span> <span class="identifier">encrypted_numeric</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"", ""</span>

    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">message</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">period</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">encrypted_numeric</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">__encryptPart</span><span class="grouping">(</span><span class="identifier">message</span><span class="grouping">[</span><span class="identifier">i</span> <span class="punctuation">:</span> <span class="identifier">i</span> <span class="arithmetic-operator">+</span> <span class="identifier">period</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">character2Number</span><span class="grouping">)</span>

    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">encrypted_numeric</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">encrypted</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">number2Character</span><span class="grouping">[</span><span class="identifier">encrypted_numeric</span><span class="grouping">[</span><span class="identifier">i</span> <span class="punctuation">:</span> <span class="identifier">i</span> <span class="arithmetic-operator">+</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="grouping">]</span>

    <span class="keyword">return</span> <span class="identifier">encrypted</span>


<span class="keyword">def</span> <span class="identifier">decryptMessage</span><span class="grouping">(</span>
    <span class="identifier">message</span><span class="punctuation">:</span> <span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="punctuation">:</span> <span class="identifier">str</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"ABCDEFGHIJKLMNOPQRSTUVWXYZ."</span><span class="punctuation">,</span> <span class="identifier">period</span><span class="punctuation">:</span> <span class="identifier">int</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">5</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">str</span><span class="punctuation">:</span>
    <span class="identifier">message</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="punctuation">,</span> <span class="identifier">character2Number</span><span class="punctuation">,</span> <span class="identifier">number2Character</span> <span class="arithmetic-assignment">=</span> <span class="identifier">__prepare</span><span class="grouping">(</span><span class="identifier">message</span><span class="punctuation">,</span> <span class="identifier">alphabet</span><span class="grouping">)</span>
    <span class="identifier">decrypted_numeric</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
    <span class="identifier">decrypted</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>

    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">message</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">period</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">a</span><span class="punctuation">,</span> <span class="identifier">b</span><span class="punctuation">,</span> <span class="identifier">c</span> <span class="arithmetic-assignment">=</span> <span class="identifier">__decryptPart</span><span class="grouping">(</span><span class="identifier">message</span><span class="grouping">[</span><span class="identifier">i</span> <span class="punctuation">:</span> <span class="identifier">i</span> <span class="arithmetic-operator">+</span> <span class="identifier">period</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">character2Number</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">a</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">decrypted_numeric</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">a</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">b</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">c</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span><span class="grouping">)</span>

    <span class="keyword">for</span> <span class="identifier">each</span> <span class="relational-operator">in</span> <span class="identifier">decrypted_numeric</span><span class="punctuation">:</span>
        <span class="identifier">decrypted</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">number2Character</span><span class="grouping">[</span><span class="identifier">each</span><span class="grouping">]</span>

    <span class="keyword">return</span> <span class="identifier">decrypted</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="relational-operator">==</span> <span class="string-literal">"__main__"</span><span class="punctuation">:</span>
    <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"DEFEND THE EAST WALL OF THE CASTLE."</span>
    <span class="identifier">encrypted</span> <span class="arithmetic-assignment">=</span> <span class="identifier">encryptMessage</span><span class="grouping">(</span><span class="identifier">msg</span><span class="punctuation">,</span> <span class="string-literal">"EPSDUCVWYM.ZLKXNBTFGORIJHAQ"</span><span class="grouping">)</span>
    <span class="identifier">decrypted</span> <span class="arithmetic-assignment">=</span> <span class="identifier">decryptMessage</span><span class="grouping">(</span><span class="identifier">encrypted</span><span class="punctuation">,</span> <span class="string-literal">"EPSDUCVWYM.ZLKXNBTFGORIJHAQ"</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Encrypted: {encrypted}\nDecrypted: {decrypted}"</span><span class="grouping">)</span>

    </pre>
  </body>
</html>