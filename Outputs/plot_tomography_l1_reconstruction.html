<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
======================================================================
Compressive sensing: tomography reconstruction with L1 prior (Lasso)
======================================================================

This example shows the reconstruction of an image from a set of parallel
projections, acquired along different angles. Such a dataset is acquired in
**computed tomography** (CT).

Without any prior information on the sample, the number of projections
required to reconstruct the image is of the order of the linear size
``l`` of the image (in pixels). For simplicity we consider here a sparse
image, where only pixels on the boundary of objects have a non-zero
value. Such data could correspond for example to a cellular material.
Note however that most images are sparse in a different basis, such as
the Haar wavelets. Only ``l/7`` projections are acquired, therefore it is
necessary to use prior information available on the sample (its
sparsity): this is an example of **compressive sensing**.

The tomography projection operation is a linear transformation. In
addition to the data-fidelity term corresponding to a linear regression,
we penalize the L1 norm of the image to account for its sparsity. The
resulting optimization problem is called the :ref:`lasso`. We use the
class :class:`~sklearn.linear_model.Lasso`, that uses the coordinate descent
algorithm. Importantly, this implementation is more computationally efficient
on a sparse matrix, than the projection operator used here.

The reconstruction with L1 penalization gives a result with zero error
(all pixels are successfully labeled with 0 or 1), even if noise was
added to the projections. In comparison, an L2 penalization
(:class:`~sklearn.linear_model.Ridge`) produces a large number of labeling
errors for the pixels. Important artifacts are observed on the
reconstructed image, contrary to the L1 penalization. Note in particular
the circular artifact separating the pixels in the corners, that have
contributed to fewer projections than the central disk.
"""</span>

<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">__doc__</span><span class="grouping">)</span>

<span class="comment"># Author: Emmanuelle Gouillart &lt;emmanuelle.gouillart@nsup.org&gt;</span>
<span class="comment"># License: BSD 3 clause</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">from</span> <span class="identifier">scipy</span> <span class="keyword">import</span> <span class="identifier">sparse</span>
<span class="keyword">from</span> <span class="identifier">scipy</span> <span class="keyword">import</span> <span class="identifier">ndimage</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">linear_model</span> <span class="keyword">import</span> <span class="identifier">Lasso</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">linear_model</span> <span class="keyword">import</span> <span class="identifier">Ridge</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>


<span class="keyword">def</span> <span class="identifier">_weights</span><span class="grouping">(</span><span class="identifier">x</span><span class="punctuation">,</span> <span class="identifier">dx</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">orig</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">x</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span>
    <span class="identifier">floor_x</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">floor</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">x</span> <span class="arithmetic-operator">-</span> <span class="identifier">orig</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">dx</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">int64</span><span class="grouping">)</span>
    <span class="identifier">alpha</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">x</span> <span class="arithmetic-operator">-</span> <span class="identifier">orig</span> <span class="arithmetic-operator">-</span> <span class="identifier">floor_x</span> <span class="arithmetic-operator">*</span> <span class="identifier">dx</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">dx</span>
    <span class="keyword">return</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">hstack</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">floor_x</span><span class="punctuation">,</span> <span class="identifier">floor_x</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">hstack</span><span class="grouping">(</span><span class="grouping">(</span><span class="int-literal">1</span> <span class="arithmetic-operator">-</span> <span class="identifier">alpha</span><span class="punctuation">,</span> <span class="identifier">alpha</span><span class="grouping">)</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">_generate_center_coordinates</span><span class="grouping">(</span><span class="identifier">l_x</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">Y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">mgrid</span><span class="grouping">[</span><span class="punctuation">:</span><span class="identifier">l_x</span><span class="punctuation">,</span> <span class="punctuation">:</span><span class="identifier">l_x</span><span class="grouping">]</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">float64</span><span class="grouping">)</span>
    <span class="identifier">center</span> <span class="arithmetic-assignment">=</span> <span class="identifier">l_x</span> <span class="arithmetic-operator">/</span> <span class="int-literal">2</span><span class="punctuation">.</span>
    <span class="identifier">X</span> <span class="arithmetic-assignment">+=</span> <span class="float-literal">0.5</span> <span class="arithmetic-operator">-</span> <span class="identifier">center</span>
    <span class="identifier">Y</span> <span class="arithmetic-assignment">+=</span> <span class="float-literal">0.5</span> <span class="arithmetic-operator">-</span> <span class="identifier">center</span>
    <span class="keyword">return</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">Y</span>


<span class="keyword">def</span> <span class="identifier">build_projection_operator</span><span class="grouping">(</span><span class="identifier">l_x</span><span class="punctuation">,</span> <span class="identifier">n_dir</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">""" Compute the tomography design matrix.

    Parameters
    ----------

    l_x : int
        linear size of image array

    n_dir : int
        number of angles at which projections are acquired.

    Returns
    -------
    p : sparse matrix of shape (n_dir l_x, l_x**2)
    """</span>
    <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">Y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_generate_center_coordinates</span><span class="grouping">(</span><span class="identifier">l_x</span><span class="grouping">)</span>
    <span class="identifier">angles</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">pi</span><span class="punctuation">,</span> <span class="identifier">n_dir</span><span class="punctuation">,</span> <span class="identifier">endpoint</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
    <span class="identifier">data_inds</span><span class="punctuation">,</span> <span class="identifier">weights</span><span class="punctuation">,</span> <span class="identifier">camera_inds</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="grouping">]</span>
    <span class="identifier">data_unravel_indices</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arange</span><span class="grouping">(</span><span class="identifier">l_x</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span><span class="grouping">)</span>
    <span class="identifier">data_unravel_indices</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">hstack</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">data_unravel_indices</span><span class="punctuation">,</span>
                                      <span class="identifier">data_unravel_indices</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">angle</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">angles</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">Xrot</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">cos</span><span class="grouping">(</span><span class="identifier">angle</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="identifier">X</span> <span class="arithmetic-operator">-</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sin</span><span class="grouping">(</span><span class="identifier">angle</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="identifier">Y</span>
        <span class="identifier">inds</span><span class="punctuation">,</span> <span class="identifier">w</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_weights</span><span class="grouping">(</span><span class="identifier">Xrot</span><span class="punctuation">,</span> <span class="identifier">dx</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">orig</span><span class="arithmetic-assignment">=</span><span class="identifier">X</span><span class="punctuation">.</span><span class="identifier">min</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">mask</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">logical_and</span><span class="grouping">(</span><span class="identifier">inds</span> <span class="relational-operator">&gt;=</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">inds</span> <span class="relational-operator">&lt;</span> <span class="identifier">l_x</span><span class="grouping">)</span>
        <span class="identifier">weights</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">w</span><span class="grouping">[</span><span class="identifier">mask</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">camera_inds</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">inds</span><span class="grouping">[</span><span class="identifier">mask</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">i</span> <span class="arithmetic-operator">*</span> <span class="identifier">l_x</span><span class="grouping">)</span>
        <span class="identifier">data_inds</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">data_unravel_indices</span><span class="grouping">[</span><span class="identifier">mask</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">proj_operator</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sparse</span><span class="punctuation">.</span><span class="identifier">coo_matrix</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">weights</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="identifier">camera_inds</span><span class="punctuation">,</span> <span class="identifier">data_inds</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">proj_operator</span>


<span class="keyword">def</span> <span class="identifier">generate_synthetic_data</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">""" Synthetic binary data """</span>
    <span class="identifier">rs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">RandomState</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span>
    <span class="identifier">n_pts</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">36</span>
    <span class="identifier">x</span><span class="punctuation">,</span> <span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">ogrid</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">:</span><span class="identifier">l</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="punctuation">:</span><span class="identifier">l</span><span class="grouping">]</span>
    <span class="identifier">mask_outer</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">x</span> <span class="arithmetic-operator">-</span> <span class="identifier">l</span> <span class="arithmetic-operator">/</span> <span class="int-literal">2</span><span class="punctuation">.</span><span class="grouping">)</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span> <span class="arithmetic-operator">+</span> <span class="grouping">(</span><span class="identifier">y</span> <span class="arithmetic-operator">-</span> <span class="identifier">l</span> <span class="arithmetic-operator">/</span> <span class="int-literal">2</span><span class="punctuation">.</span><span class="grouping">)</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span> <span class="relational-operator">&lt;</span> <span class="grouping">(</span><span class="identifier">l</span> <span class="arithmetic-operator">/</span> <span class="int-literal">2</span><span class="punctuation">.</span><span class="grouping">)</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span>
    <span class="identifier">mask</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">l</span><span class="punctuation">,</span> <span class="identifier">l</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">points</span> <span class="arithmetic-assignment">=</span> <span class="identifier">l</span> <span class="arithmetic-operator">*</span> <span class="identifier">rs</span><span class="punctuation">.</span><span class="identifier">rand</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">n_pts</span><span class="grouping">)</span>
    <span class="identifier">mask</span><span class="grouping">[</span><span class="grouping">(</span><span class="identifier">points</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">int</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="identifier">points</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">int</span><span class="grouping">)</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">1</span>
    <span class="identifier">mask</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ndimage</span><span class="punctuation">.</span><span class="identifier">gaussian_filter</span><span class="grouping">(</span><span class="identifier">mask</span><span class="punctuation">,</span> <span class="identifier">sigma</span><span class="arithmetic-assignment">=</span><span class="identifier">l</span> <span class="arithmetic-operator">/</span> <span class="identifier">n_pts</span><span class="grouping">)</span>
    <span class="identifier">res</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">logical_and</span><span class="grouping">(</span><span class="identifier">mask</span> <span class="relational-operator">&gt;</span> <span class="identifier">mask</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">mask_outer</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">logical_xor</span><span class="grouping">(</span><span class="identifier">res</span><span class="punctuation">,</span> <span class="identifier">ndimage</span><span class="punctuation">.</span><span class="identifier">binary_erosion</span><span class="grouping">(</span><span class="identifier">res</span><span class="grouping">)</span><span class="grouping">)</span>


<span class="comment"># Generate synthetic images, and projections</span>
<span class="identifier">l</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">128</span>
<span class="identifier">proj_operator</span> <span class="arithmetic-assignment">=</span> <span class="identifier">build_projection_operator</span><span class="grouping">(</span><span class="identifier">l</span><span class="punctuation">,</span> <span class="identifier">l</span> <span class="arithmetic-operator">//</span> <span class="int-literal">7</span><span class="grouping">)</span>
<span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">generate_synthetic_data</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">proj</span> <span class="arithmetic-assignment">=</span> <span class="identifier">proj_operator</span> <span class="punctuation">@</span> <span class="identifier">data</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">newaxis</span><span class="grouping">]</span>
<span class="identifier">proj</span> <span class="arithmetic-assignment">+=</span> <span class="float-literal">0.15</span> <span class="arithmetic-operator">*</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randn</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="identifier">proj</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">)</span>

<span class="comment"># Reconstruction with L2 (Ridge) penalization</span>
<span class="identifier">rgr_ridge</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Ridge</span><span class="grouping">(</span><span class="identifier">alpha</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.2</span><span class="grouping">)</span>
<span class="identifier">rgr_ridge</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">proj_operator</span><span class="punctuation">,</span> <span class="identifier">proj</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">rec_l2</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rgr_ridge</span><span class="punctuation">.</span><span class="identifier">coef_</span><span class="punctuation">.</span><span class="identifier">reshape</span><span class="grouping">(</span><span class="identifier">l</span><span class="punctuation">,</span> <span class="identifier">l</span><span class="grouping">)</span>

<span class="comment"># Reconstruction with L1 (Lasso) penalization</span>
<span class="comment"># the best value of alpha was determined using cross validation</span>
<span class="comment"># with LassoCV</span>
<span class="identifier">rgr_lasso</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Lasso</span><span class="grouping">(</span><span class="identifier">alpha</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.001</span><span class="grouping">)</span>
<span class="identifier">rgr_lasso</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">proj_operator</span><span class="punctuation">,</span> <span class="identifier">proj</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">rec_l1</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rgr_lasso</span><span class="punctuation">.</span><span class="identifier">coef_</span><span class="punctuation">.</span><span class="identifier">reshape</span><span class="grouping">(</span><span class="identifier">l</span><span class="punctuation">,</span> <span class="identifier">l</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">figure</span><span class="grouping">(</span><span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">8</span><span class="punctuation">,</span> <span class="float-literal">3.3</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="int-literal">131</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">imshow</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">gray</span><span class="punctuation">,</span> <span class="identifier">interpolation</span><span class="arithmetic-assignment">=</span><span class="string-literal">'nearest'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">axis</span><span class="grouping">(</span><span class="string-literal">'off'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="string-literal">'original image'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="int-literal">132</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">imshow</span><span class="grouping">(</span><span class="identifier">rec_l2</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">gray</span><span class="punctuation">,</span> <span class="identifier">interpolation</span><span class="arithmetic-assignment">=</span><span class="string-literal">'nearest'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="string-literal">'L2 penalization'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">axis</span><span class="grouping">(</span><span class="string-literal">'off'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="int-literal">133</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">imshow</span><span class="grouping">(</span><span class="identifier">rec_l1</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">gray</span><span class="punctuation">,</span> <span class="identifier">interpolation</span><span class="arithmetic-assignment">=</span><span class="string-literal">'nearest'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="string-literal">'L1 penalization'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">axis</span><span class="grouping">(</span><span class="string-literal">'off'</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots_adjust</span><span class="grouping">(</span><span class="identifier">hspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.01</span><span class="punctuation">,</span> <span class="identifier">wspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.01</span><span class="punctuation">,</span> <span class="identifier">top</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">bottom</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">left</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                    <span class="identifier">right</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>