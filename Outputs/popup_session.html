<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">#!/usr/bin python3</span>
<span class="comment">""" Pop-up Graph launched from the Analysis tab of the Faceswap GUI """</span>

<span class="keyword">import</span> <span class="identifier">csv</span>
<span class="keyword">import</span> <span class="identifier">gettext</span>
<span class="keyword">import</span> <span class="identifier">logging</span>
<span class="keyword">import</span> <span class="identifier">tkinter</span> <span class="keyword">as</span> <span class="identifier">tk</span>
<span class="keyword">from</span> <span class="identifier">tkinter</span> <span class="keyword">import</span> <span class="identifier">ttk</span>

<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">control_helper</span> <span class="keyword">import</span> <span class="identifier">ControlBuilder</span><span class="punctuation">,</span> <span class="identifier">ControlPanelOption</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">custom_widgets</span> <span class="keyword">import</span> <span class="identifier">Tooltip</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">display_graph</span> <span class="keyword">import</span> <span class="identifier">SessionGraph</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">analysis</span> <span class="keyword">import</span> <span class="identifier">Calculations</span><span class="punctuation">,</span> <span class="identifier">Session</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">FileHandler</span><span class="punctuation">,</span> <span class="identifier">get_images</span><span class="punctuation">,</span> <span class="identifier">LongRunningTask</span>

<span class="identifier">logger</span> <span class="arithmetic-assignment">=</span> <span class="identifier">logging</span><span class="punctuation">.</span><span class="identifier">getLogger</span><span class="grouping">(</span><span class="identifier">__name__</span><span class="grouping">)</span>  <span class="comment"># pylint: disable=invalid-name</span>

<span class="comment"># LOCALES</span>
<span class="identifier">_LANG</span> <span class="arithmetic-assignment">=</span> <span class="identifier">gettext</span><span class="punctuation">.</span><span class="identifier">translation</span><span class="grouping">(</span><span class="string-literal">"gui.tooltips", localedir="locales"</span><span class="punctuation">,</span> <span class="identifier">fallback</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
<span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_LANG</span><span class="punctuation">.</span><span class="identifier">gettext</span>


<span class="keyword">class</span> <span class="identifier">SessionPopUp</span><span class="grouping">(</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Toplevel</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">""" Pop up for detailed graph/stats for selected session.

    session_id: int or `"Total"`
        The session id number for the selected session from the Analysis tab. Should be the string
        `"Total"` if all sessions are being graphed
    data_points: int
        The number of iterations in the selected session
    """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">session_id</span><span class="punctuation">,</span> <span class="identifier">data_points</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initializing: %s: (session_id: %s, data_points: %s)"</span><span class="punctuation">,</span>
                     <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="punctuation">,</span> <span class="identifier">session_id</span><span class="punctuation">,</span> <span class="identifier">data_points</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_thread</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>  <span class="comment"># Thread for loading data in a background task</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_default_view</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"avg" if data_points &gt; 1000 else "smoothed"</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_session_id</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span> <span class="keyword">if</span> <span class="identifier">session_id</span> <span class="relational-operator">==</span> <span class="string-literal">"Total"</span> <span class="keyword">else</span> <span class="identifier">int</span><span class="grouping">(</span><span class="identifier">session_id</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_frame</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_set_vars</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_initialised</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">False</span>

        <span class="identifier">optsframe</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_layout_frames</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_build_options</span><span class="grouping">(</span><span class="identifier">optsframe</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_lbl_loading</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Label</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_frame</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Loading Data..."</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">CENTER</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_lbl_loading</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTH</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_idletasks</span><span class="grouping">(</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_compile_display_data</span><span class="grouping">(</span><span class="grouping">)</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initialized: %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_set_vars</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Set status tkinter String variable and tkinter Boolean variable to callback when the
        graph is ready to build.

        Returns
        -------
        dict
            The tkinter Variables for the pop up graph
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Setting tk graph build variable and internal variables"</span><span class="grouping">)</span>

        <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">status</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">StringVar</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="identifier">var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BooleanVar</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">var</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">False</span><span class="grouping">)</span>
        <span class="identifier">var</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"w"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_build</span><span class="grouping">)</span>

        <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"buildgraph"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">var</span>
        <span class="keyword">return</span> <span class="identifier">retval</span>

    <span class="keyword">def</span> <span class="identifier">_layout_frames</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Top level container frames """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Layout frames"</span><span class="grouping">)</span>

        <span class="identifier">leftframe</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span>
        <span class="identifier">sep</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">width</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">relief</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIDGE</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTH</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">sep</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Y</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="grouping">)</span>
        <span class="identifier">leftframe</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTH</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="grouping">)</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Laid out frames"</span><span class="grouping">)</span>

        <span class="keyword">return</span> <span class="identifier">leftframe</span>

    <span class="keyword">def</span> <span class="identifier">_build_options</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">frame</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Build Options into the options frame.

        Parameters
        ----------
        frame: `tkinter.ttk.Frame`
            The frame that the options reside in
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Options"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_opts_combobox</span><span class="grouping">(</span><span class="identifier">frame</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_opts_checkbuttons</span><span class="grouping">(</span><span class="identifier">frame</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_opts_loss_keys</span><span class="grouping">(</span><span class="identifier">frame</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_opts_slider</span><span class="grouping">(</span><span class="identifier">frame</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_opts_buttons</span><span class="grouping">(</span><span class="identifier">frame</span><span class="grouping">)</span>
        <span class="identifier">sep</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">height</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">relief</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIDGE</span><span class="grouping">)</span>
        <span class="identifier">sep</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTTOM</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Options"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_opts_combobox</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">frame</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the options combo boxes.

        Parameters
        ----------
        frame: `tkinter.ttk.Frame`
            The frame that the options reside in
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Combo boxes"</span><span class="grouping">)</span>
        <span class="identifier">choices</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">Display</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="string-literal">"Loss", "Rate"), Scale=("Linear", "Log"</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">item</span> <span class="relational-operator">in</span> <span class="grouping">[</span><span class="string-literal">"Display", "Scale"</span><span class="grouping">]</span><span class="punctuation">:</span>
            <span class="identifier">var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">StringVar</span><span class="grouping">(</span><span class="grouping">)</span>

            <span class="identifier">cmbframe</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">frame</span><span class="grouping">)</span>
            <span class="identifier">lblcmb</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Label</span><span class="grouping">(</span><span class="identifier">cmbframe</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="string-literal">"{}:"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">item</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">width</span><span class="arithmetic-assignment">=</span><span class="int-literal">7</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
            <span class="identifier">cmb</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Combobox</span><span class="grouping">(</span><span class="identifier">cmbframe</span><span class="punctuation">,</span> <span class="identifier">textvariable</span><span class="arithmetic-assignment">=</span><span class="identifier">var</span><span class="punctuation">,</span> <span class="identifier">width</span><span class="arithmetic-assignment">=</span><span class="int-literal">10</span><span class="grouping">)</span>
            <span class="identifier">cmb</span><span class="grouping">[</span><span class="string-literal">"values"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">choices</span><span class="grouping">[</span><span class="identifier">item</span><span class="grouping">]</span>
            <span class="identifier">cmb</span><span class="punctuation">.</span><span class="identifier">current</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span>

            <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_option_button_reload</span> <span class="keyword">if</span> <span class="identifier">item</span> <span class="relational-operator">==</span> <span class="string-literal">"Display"</span> <span class="keyword">else</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_scale</span>
            <span class="identifier">var</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"w"</span><span class="punctuation">,</span> <span class="identifier">cmd</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="identifier">item</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">var</span>

            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_set_help</span><span class="grouping">(</span><span class="identifier">item</span><span class="grouping">)</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">cmbframe</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

            <span class="identifier">cmb</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>
            <span class="identifier">lblcmb</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="grouping">)</span>
            <span class="identifier">cmbframe</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Combo boxes"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_opts_checkbuttons</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">frame</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the options check buttons.

        Parameters
        ----------
        frame: `tkinter.ttk.Frame`
            The frame that the options reside in
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Check Buttons"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_section</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="string-literal">"Display"</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">item</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"raw", "trend", "avg", "smoothed", "outliers"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">item</span> <span class="relational-operator">==</span> <span class="string-literal">"avg"</span><span class="punctuation">:</span>
                <span class="identifier">text</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Show Rolling Average"</span>
            <span class="keyword">elif</span> <span class="identifier">item</span> <span class="relational-operator">==</span> <span class="string-literal">"outliers"</span><span class="punctuation">:</span>
                <span class="identifier">text</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Flatten Outliers"</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="identifier">text</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Show {}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">item</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>

            <span class="identifier">var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BooleanVar</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">item</span> <span class="relational-operator">==</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_default_view</span><span class="punctuation">:</span>
                <span class="identifier">var</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="identifier">item</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">var</span>

            <span class="identifier">ctl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Checkbutton</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">variable</span><span class="arithmetic-assignment">=</span><span class="identifier">var</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">text</span><span class="grouping">)</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_set_help</span><span class="grouping">(</span><span class="identifier">item</span><span class="grouping">)</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">ctl</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
            <span class="identifier">ctl</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Check Buttons"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_opts_loss_keys</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">frame</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add loss key selections.

        Parameters
        ----------
        frame: `tkinter.ttk.Frame`
            The frame that the options reside in
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Loss Key Check Buttons"</span><span class="grouping">)</span>
        <span class="identifier">loss_keys</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Session</span><span class="punctuation">.</span><span class="identifier">get_loss_keys</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_session_id</span><span class="grouping">)</span>
        <span class="identifier">lk_vars</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">section_added</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">False</span>
        <span class="keyword">for</span> <span class="identifier">loss_key</span> <span class="relational-operator">in</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">loss_keys</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">loss_key</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"total"</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="keyword">continue</span>

            <span class="identifier">text</span> <span class="arithmetic-assignment">=</span> <span class="identifier">loss_key</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">"_", " "</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="identifier">helptext</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Display {}"</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">text</span><span class="grouping">)</span>

            <span class="identifier">var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BooleanVar</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="identifier">var</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span>
            <span class="identifier">lk_vars</span><span class="grouping">[</span><span class="identifier">loss_key</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">var</span>

            <span class="keyword">if</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">loss_keys</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="int-literal">1</span><span class="punctuation">:</span>
                <span class="comment"># Don't display if there's only one item</span>
                <span class="keyword">break</span>

            <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">section_added</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_section</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="string-literal">"Keys"</span><span class="grouping">)</span>
                <span class="identifier">section_added</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">True</span>

            <span class="identifier">ctl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Checkbutton</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">variable</span><span class="arithmetic-assignment">=</span><span class="identifier">var</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">text</span><span class="grouping">)</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">ctl</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">helptext</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
            <span class="identifier">ctl</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"loss_keys"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">lk_vars</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Loss Key Check Buttons"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_opts_slider</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">frame</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the options entry boxes.

        Parameters
        ----------
        frame: `tkinter.ttk.Frame`
            The frame that the options reside in
        """</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_section</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="string-literal">"Parameters"</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Slider Controls"</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">item</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"avgiterations", "smoothamount"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">item</span> <span class="relational-operator">==</span> <span class="string-literal">"avgiterations"</span><span class="punctuation">:</span>
                <span class="identifier">dtype</span> <span class="arithmetic-assignment">=</span> <span class="identifier">int</span>
                <span class="identifier">text</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Iterations to Average:"</span>
                <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">500</span>
                <span class="identifier">rounding</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">25</span>
                <span class="identifier">min_max</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="int-literal">25</span><span class="punctuation">,</span> <span class="int-literal">2500</span><span class="grouping">)</span>
            <span class="keyword">elif</span> <span class="identifier">item</span> <span class="relational-operator">==</span> <span class="string-literal">"smoothamount"</span><span class="punctuation">:</span>
                <span class="identifier">dtype</span> <span class="arithmetic-assignment">=</span> <span class="identifier">float</span>
                <span class="identifier">text</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Smoothing Amount:"</span>
                <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span> <span class="arithmetic-assignment">=</span> <span class="float-literal">0.90</span>
                <span class="identifier">rounding</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">2</span>
                <span class="identifier">min_max</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="float-literal">0.99</span><span class="grouping">)</span>
            <span class="identifier">slider</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ControlPanelOption</span><span class="grouping">(</span><span class="identifier">text</span><span class="punctuation">,</span>
                                        <span class="identifier">dtype</span><span class="punctuation">,</span>
                                        <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="punctuation">,</span>
                                        <span class="identifier">rounding</span><span class="arithmetic-assignment">=</span><span class="identifier">rounding</span><span class="punctuation">,</span>
                                        <span class="identifier">min_max</span><span class="arithmetic-assignment">=</span><span class="identifier">min_max</span><span class="punctuation">,</span>
                                        <span class="identifier">helptext</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_set_help</span><span class="grouping">(</span><span class="identifier">item</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="identifier">item</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">slider</span><span class="punctuation">.</span><span class="identifier">tk_var</span>
            <span class="identifier">ControlBuilder</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">slider</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">19</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="punctuation">,</span> <span class="string-literal">"Analysis."</span><span class="punctuation">,</span> <span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Sliders"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_opts_buttons</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">frame</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the option buttons.

        Parameters
        ----------
        frame: `tkinter.ttk.Frame`
            The frame that the options reside in
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Buttons"</span><span class="grouping">)</span>
        <span class="identifier">btnframe</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">frame</span><span class="grouping">)</span>
        <span class="identifier">lblstatus</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Label</span><span class="grouping">(</span><span class="identifier">btnframe</span><span class="punctuation">,</span>
                              <span class="identifier">width</span><span class="arithmetic-assignment">=</span><span class="int-literal">40</span><span class="punctuation">,</span>
                              <span class="identifier">textvariable</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"status"</span><span class="grouping">]</span><span class="punctuation">,</span>
                              <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">btntype</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"reload", "save"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">getattr</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="string-literal">"_option_button_{}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">btntype</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">btn</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Button</span><span class="grouping">(</span><span class="identifier">btnframe</span><span class="punctuation">,</span>
                             <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span><span class="grouping">[</span><span class="identifier">btntype</span><span class="grouping">]</span><span class="punctuation">,</span>
                             <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">cmd</span><span class="grouping">)</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_set_help</span><span class="grouping">(</span><span class="identifier">btntype</span><span class="grouping">)</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">btn</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
            <span class="identifier">btn</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>

        <span class="identifier">lblstatus</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">btnframe</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTTOM</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Buttons"</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">_add_section</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">title</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add a separator and section title between options

        Parameters
        ----------
        title: str
            The section title to display
        """</span>
        <span class="identifier">sep</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">height</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">relief</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">SOLID</span><span class="grouping">)</span>
        <span class="identifier">lbl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Label</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">title</span><span class="grouping">)</span>

        <span class="identifier">lbl</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">CENTER</span><span class="grouping">)</span>
        <span class="identifier">sep</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_option_button_save</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Action for save button press. """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Saving File"</span><span class="grouping">)</span>
        <span class="identifier">savefile</span> <span class="arithmetic-assignment">=</span> <span class="identifier">FileHandler</span><span class="grouping">(</span><span class="string-literal">"save", "csv"</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">i</span><span class="invalid">l</span><span class="invalid">e</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">savefile</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Save Cancelled"</span><span class="grouping">)</span>
            <span class="keyword">return</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Saving to: %s"</span><span class="punctuation">,</span> <span class="identifier">savefile</span><span class="grouping">)</span>
        <span class="identifier">save_data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span><span class="punctuation">.</span><span class="identifier">stats</span>
        <span class="identifier">fieldnames</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">key</span> <span class="keyword">for</span> <span class="identifier">key</span> <span class="relational-operator">in</span> <span class="identifier">save_data</span><span class="punctuation">.</span><span class="identifier">keys</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="keyword">with</span> <span class="identifier">savefile</span> <span class="keyword">as</span> <span class="identifier">outfile</span><span class="punctuation">:</span>
            <span class="identifier">csvout</span> <span class="arithmetic-assignment">=</span> <span class="identifier">csv</span><span class="punctuation">.</span><span class="identifier">writer</span><span class="grouping">(</span><span class="identifier">outfile</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">l</span><span class="invalid">i</span><span class="invalid">m</span><span class="invalid">i</span><span class="invalid">t</span><span class="invalid">e</span><span class="invalid">r</span><span class="arithmetic-assignment">=</span><span class="string-literal">","</span><span class="grouping">)</span>
            <span class="identifier">csvout</span><span class="punctuation">.</span><span class="identifier">writerow</span><span class="grouping">(</span><span class="identifier">fieldnames</span><span class="grouping">)</span>
            <span class="identifier">csvout</span><span class="punctuation">.</span><span class="identifier">writerows</span><span class="grouping">(</span><span class="identifier">zip</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="grouping">[</span><span class="identifier">save_data</span><span class="grouping">[</span><span class="identifier">key</span><span class="grouping">]</span> <span class="keyword">for</span> <span class="identifier">key</span> <span class="relational-operator">in</span> <span class="identifier">fieldnames</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_option_button_reload</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint: disable=unused-argument</span>
        <span class="comment">""" Action for reset button press and checkbox changes. """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Refreshing Graph"</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_initialised</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="identifier">valid</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_compile_display_data</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">valid</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Invalid data"</span><span class="grouping">)</span>
            <span class="keyword">return</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span><span class="punctuation">.</span><span class="identifier">refresh</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span><span class="punctuation">,</span>
                            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"display"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
                            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"scale"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Refreshed Graph"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_graph_scale</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint: disable=unused-argument</span>
        <span class="comment">""" Action for changing graph scale. """</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_initialised</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span><span class="punctuation">.</span><span class="identifier">set_yscale_type</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"scale"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">m</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">h</span><span class="invalid">o</span><span class="invalid">d</span>
    <span class="keyword">def</span> <span class="identifier">_set_help</span><span class="grouping">(</span><span class="identifier">cls</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Set the help text for option buttons.

        Parameters
        ----------
        action: string
            The action to get the help text for

        Returns
        -------
        str
            The help text for the given action
        """</span>
        <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>
        <span class="identifier">action</span> <span class="arithmetic-assignment">=</span> <span class="identifier">action</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"reload"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Refresh graph"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"save"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Save display data to csv"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"avgiterations"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Number of data points to sample for rolling average"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"smoothamount"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Set the smoothing amount. 0 is no smoothing, 0.99 is maximum smoothing"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"outliers"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Flatten data points that fall more than 1 standard deviation from the mean "</span>
                    <span class="string-literal">"to the mean value."</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"avg"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Display rolling average of the data"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"smoothed"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Smooth the data"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"raw"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Display raw data"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"trend"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Display polynormal data trend"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"display"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Set the data to display"</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="string-literal">"scale"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Change y-axis scale"</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">hlp</span>

    <span class="keyword">def</span> <span class="identifier">_compile_display_data</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Compile the data to be displayed. """</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_thread</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Compiling Display Data in background thread"</span><span class="grouping">)</span>
            <span class="identifier">loss_keys</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">key</span> <span class="keyword">for</span> <span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">val</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"loss_keys"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span>
                         <span class="keyword">if</span> <span class="identifier">val</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">]</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Selected loss_keys: %s"</span><span class="punctuation">,</span> <span class="identifier">loss_keys</span><span class="grouping">)</span>

            <span class="identifier">selections</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_selections_to_list</span><span class="grouping">(</span><span class="grouping">)</span>

            <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_check_valid_selection</span><span class="grouping">(</span><span class="identifier">loss_keys</span><span class="punctuation">,</span> <span class="identifier">selections</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">warning</span><span class="grouping">(</span><span class="string-literal">"No data to display. Not refreshing"</span><span class="grouping">)</span>
                <span class="keyword">return</span> <span class="bool-literal">False</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"status"].set("Loading Data..."</span><span class="grouping">)</span>

            <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span><span class="punctuation">.</span><span class="identifier">pack_forget</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_lbl_loading</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTH</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_idletasks</span><span class="grouping">(</span><span class="grouping">)</span>

            <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">session_id</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_session_id</span><span class="punctuation">,</span>
                          <span class="identifier">display</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"display"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
                          <span class="identifier">loss_keys</span><span class="arithmetic-assignment">=</span><span class="identifier">loss_keys</span><span class="punctuation">,</span>
                          <span class="identifier">selections</span><span class="arithmetic-assignment">=</span><span class="identifier">selections</span><span class="punctuation">,</span>
                          <span class="identifier">avg_samples</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"avgiterations"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
                          <span class="identifier">smooth_amount</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"smoothamount"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
                          <span class="identifier">flatten_outliers</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"outliers"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_thread</span> <span class="arithmetic-assignment">=</span> <span class="identifier">LongRunningTask</span><span class="grouping">(</span><span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_get_display_data</span><span class="punctuation">,</span>
                                           <span class="identifier">kwargs</span><span class="arithmetic-assignment">=</span><span class="identifier">kwargs</span><span class="punctuation">,</span>
                                           <span class="identifier">widget</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_thread</span><span class="punctuation">.</span><span class="identifier">start</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">after</span><span class="grouping">(</span><span class="int-literal">1000</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_compile_display_data</span><span class="grouping">)</span>
            <span class="keyword">return</span> <span class="bool-literal">True</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_thread</span><span class="punctuation">.</span><span class="identifier">complete</span><span class="punctuation">.</span><span class="identifier">is_set</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Popup Data not yet available"</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">after</span><span class="grouping">(</span><span class="int-literal">1000</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_compile_display_data</span><span class="grouping">)</span>
            <span class="keyword">return</span> <span class="bool-literal">True</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Getting Popup from background Thread"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_thread</span><span class="punctuation">.</span><span class="identifier">get_result</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_thread</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_check_valid_data</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">warning</span><span class="grouping">(</span><span class="string-literal">"No valid data to display. Not refreshing"</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"status"].set(""</span><span class="grouping">)</span>
            <span class="keyword">return</span> <span class="bool-literal">False</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Compiled Display Data"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"buildgraph"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="bool-literal">True</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">_get_display_data</span><span class="grouping">(</span><span class="arithmetic-operator">**</span><span class="identifier">kwargs</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Get the display data in a LongRunningTask.

        Parameters
        ----------
        kwargs: dict
            The keyword arguments to pass to `lib.gui.analysis.Calculations`

        Returns
        -------
        :class:`lib.gui.analysis.Calculations`
            The summarized results for the given session
        """</span>
        <span class="keyword">return</span> <span class="identifier">Calculations</span><span class="grouping">(</span><span class="arithmetic-operator">**</span><span class="identifier">kwargs</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_check_valid_selection</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">loss_keys</span><span class="punctuation">,</span> <span class="identifier">selections</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Check that there will be data to display.

        Parameters
        ----------
        loss_keys: list
            The selected loss to display
        selections: list
            The selected checkbox options

        Returns
        -------
        bool
            ``True` if there is data to be displayed, otherwise ``False``
        """</span>
        <span class="identifier">display</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"display"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Validating selection. (loss_keys: %s, selections: %s, display: %s)"</span><span class="punctuation">,</span>
                     <span class="identifier">loss_keys</span><span class="punctuation">,</span> <span class="identifier">selections</span><span class="punctuation">,</span> <span class="identifier">display</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">selections</span> <span class="logical-operator">or</span> <span class="grouping">(</span><span class="identifier">display</span> <span class="relational-operator">==</span> <span class="string-literal">"loss"</span> <span class="logical-operator">and</span> <span class="logical-operator">not</span> <span class="identifier">loss_keys</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">return</span> <span class="bool-literal">False</span>
        <span class="keyword">return</span> <span class="bool-literal">True</span>

    <span class="keyword">def</span> <span class="identifier">_check_valid_data</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Check that the selections holds valid data to display
            NB: len-as-condition is used as data could be a list or a numpy array
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Validating data. %s"</span><span class="punctuation">,</span>
                     <span class="grouping">{</span><span class="identifier">key</span><span class="punctuation">:</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">val</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">val</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span><span class="punctuation">.</span><span class="identifier">stats</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">}</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">any</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">val</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="int-literal">0</span>  <span class="comment"># pylint:disable=len-as-condition</span>
               <span class="keyword">for</span> <span class="identifier">val</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span><span class="punctuation">.</span><span class="identifier">stats</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">return</span> <span class="bool-literal">False</span>
        <span class="keyword">return</span> <span class="bool-literal">True</span>

    <span class="keyword">def</span> <span class="identifier">_selections_to_list</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Compile checkbox selections to a list.

        Returns
        -------
        list
            The selected options from the check-boxes
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Compiling selections to list"</span><span class="grouping">)</span>
        <span class="identifier">selections</span> <span class="arithmetic-assignment">=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">val</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="grouping">(</span><span class="identifier">isinstance</span><span class="grouping">(</span><span class="identifier">val</span><span class="punctuation">,</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BooleanVar</span><span class="grouping">)</span>
                    <span class="logical-operator">and</span> <span class="identifier">key</span> <span class="relational-operator">!=</span> <span class="string-literal">"outliers"</span>
                    <span class="logical-operator">and</span> <span class="identifier">val</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">selections</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">key</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Compiling selections to list: %s"</span><span class="punctuation">,</span> <span class="identifier">selections</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">selections</span>

    <span class="keyword">def</span> <span class="identifier">_graph_build</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint:disable=unused-argument</span>
        <span class="comment">""" Build the graph in the top right paned window """</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"buildgraph"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"status"].set("Loading Data..."</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Graph"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_lbl_loading</span><span class="punctuation">.</span><span class="identifier">pack_forget</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_idletasks</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span> <span class="arithmetic-assignment">=</span> <span class="identifier">SessionGraph</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_frame</span><span class="punctuation">,</span>
                                       <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span><span class="punctuation">,</span>
                                       <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"display"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
                                       <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"scale"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTH</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span><span class="punctuation">.</span><span class="identifier">build</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph_initialised</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">True</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span><span class="punctuation">.</span><span class="identifier">refresh</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data</span><span class="punctuation">,</span>
                                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"display"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
                                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"scale"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_graph</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTH</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"status"].set(""</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_vars</span><span class="grouping">[</span><span class="string-literal">"buildgraph"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">False</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Graph"</span><span class="grouping">)</span>

    </pre>
  </body>
</html>