<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">#!/usr/bin python3</span>
<span class="comment">""" Command specific tabs of Display Frame of the Faceswap GUI """</span>
<span class="keyword">import</span> <span class="identifier">datetime</span>
<span class="keyword">import</span> <span class="identifier">gettext</span>
<span class="keyword">import</span> <span class="identifier">logging</span>
<span class="keyword">import</span> <span class="identifier">os</span>
<span class="keyword">import</span> <span class="identifier">tkinter</span> <span class="keyword">as</span> <span class="identifier">tk</span>

<span class="keyword">from</span> <span class="identifier">tkinter</span> <span class="keyword">import</span> <span class="identifier">ttk</span>


<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">display_graph</span> <span class="keyword">import</span> <span class="identifier">TrainingGraph</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">display_page</span> <span class="keyword">import</span> <span class="identifier">DisplayOptionalPage</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">custom_widgets</span> <span class="keyword">import</span> <span class="identifier">Tooltip</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">analysis</span> <span class="keyword">import</span> <span class="identifier">Calculations</span><span class="punctuation">,</span> <span class="identifier">Session</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">control_helper</span> <span class="keyword">import</span> <span class="identifier">set_slider_rounding</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">FileHandler</span><span class="punctuation">,</span> <span class="identifier">get_config</span><span class="punctuation">,</span> <span class="identifier">get_images</span><span class="punctuation">,</span> <span class="identifier">preview_trigger</span>

<span class="identifier">logger</span> <span class="arithmetic-assignment">=</span> <span class="identifier">logging</span><span class="punctuation">.</span><span class="identifier">getLogger</span><span class="grouping">(</span><span class="identifier">__name__</span><span class="grouping">)</span>  <span class="comment"># pylint: disable=invalid-name</span>

<span class="comment"># LOCALES</span>
<span class="identifier">_LANG</span> <span class="arithmetic-assignment">=</span> <span class="identifier">gettext</span><span class="punctuation">.</span><span class="identifier">translation</span><span class="grouping">(</span><span class="string-literal">"gui.tooltips", localedir="locales"</span><span class="punctuation">,</span> <span class="identifier">fallback</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
<span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_LANG</span><span class="punctuation">.</span><span class="identifier">gettext</span>


<span class="keyword">class</span> <span class="identifier">PreviewExtract</span><span class="grouping">(</span><span class="identifier">DisplayOptionalPage</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint: disable=too-many-ancestors</span>
    <span class="comment">""" Tab to display output preview images for extract and convert """</span>

    <span class="keyword">def</span> <span class="identifier">display_item_set</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Load the latest preview if available """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Loading latest preview"</span><span class="grouping">)</span>
        <span class="identifier">size</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">256</span> <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">command</span> <span class="relational-operator">==</span> <span class="string-literal">"convert"</span> <span class="keyword">else</span> <span class="int-literal">128</span>
        <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">load_latest_preview</span><span class="grouping">(</span><span class="identifier">thumbnail_size</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="grouping">(</span><span class="identifier">size</span> <span class="arithmetic-operator">*</span> <span class="identifier">get_config</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">scaling_factor</span><span class="grouping">)</span><span class="punctuation">,</span>
                                         <span class="identifier">frame_dims</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">winfo_width</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">winfo_height</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewoutput</span>

    <span class="keyword">def</span> <span class="identifier">display_item_process</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Display the preview """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Displaying preview"</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">.</span><span class="identifier">children</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_child</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_child</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">add_child</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the preview label child """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding child"</span><span class="grouping">)</span>
        <span class="identifier">preview</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook_add_page</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">tabname</span><span class="punctuation">,</span> <span class="identifier">widget</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span>
        <span class="identifier">lblpreview</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Label</span><span class="grouping">(</span><span class="identifier">preview</span><span class="punctuation">,</span> <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewoutput</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">lblpreview</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">NW</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">lblpreview</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">helptext</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">update_child</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Update the preview image on the label """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Updating preview"</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">widget</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook_get_widgets</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">widget</span><span class="punctuation">.</span><span class="identifier">configure</span><span class="grouping">(</span><span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewoutput</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">save_items</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Open save dialogue and save preview """</span>
        <span class="identifier">location</span> <span class="arithmetic-assignment">=</span> <span class="identifier">FileHandler</span><span class="grouping">(</span><span class="string-literal">"dir"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">i</span><span class="invalid">l</span><span class="invalid">e</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">location</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="identifier">filename</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"extract_convert_preview"</span>
        <span class="identifier">now</span> <span class="arithmetic-assignment">=</span> <span class="identifier">datetime</span><span class="punctuation">.</span><span class="identifier">datetime</span><span class="punctuation">.</span><span class="identifier">now</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strftime</span><span class="grouping">(</span><span class="string-literal">"%Y%m%d_%H%M%S"</span><span class="grouping">)</span>
        <span class="identifier">filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">location</span><span class="punctuation">,</span>
                                <span class="string-literal">"{}_{}.{}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">filename</span><span class="punctuation">,</span>
                                                  <span class="identifier">now</span><span class="punctuation">,</span>
                                                  <span class="string-literal">"png"</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewoutput</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Saved preview to %s"</span><span class="punctuation">,</span> <span class="identifier">filename</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Saved preview to {}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span><span class="grouping">)</span>


<span class="keyword">class</span> <span class="identifier">PreviewTrain</span><span class="grouping">(</span><span class="identifier">DisplayOptionalPage</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint: disable=too-many-ancestors</span>
    <span class="comment">""" Training preview image(s) """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="punctuation">,</span> <span class="arithmetic-operator">**</span><span class="identifier">kwargs</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_preview</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_config</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"updatepreview"</span><span class="grouping">]</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="punctuation">,</span> <span class="arithmetic-operator">**</span><span class="identifier">kwargs</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">add_options</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the additional options """</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_option_refresh</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_option_mask_toggle</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">add_options</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_option_refresh</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add refresh button to refresh preview immediately """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding refresh option"</span><span class="grouping">)</span>
        <span class="identifier">btnrefresh</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Button</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">optsframe</span><span class="punctuation">,</span>
                                <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span><span class="grouping">[</span><span class="string-literal">"reload"</span><span class="grouping">]</span><span class="punctuation">,</span>
                                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="arithmetic-assignment">=</span><span class="string-literal">"update"</span><span class="punctuation">:</span> <span class="identifier">preview_trigger</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">btnrefresh</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">btnrefresh</span><span class="punctuation">,</span>
                <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Preview updates at every model save. Click to refresh now."</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Added refresh option"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_option_mask_toggle</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add button to toggle mask display on and off """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding mask toggle option"</span><span class="grouping">)</span>
        <span class="identifier">btntoggle</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Button</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">optsframe</span><span class="punctuation">,</span>
                               <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span><span class="grouping">[</span><span class="string-literal">"mask2"</span><span class="grouping">]</span><span class="punctuation">,</span>
                               <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="arithmetic-assignment">=</span><span class="string-literal">"mask_toggle"</span><span class="punctuation">:</span> <span class="identifier">preview_trigger</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">btntoggle</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">btntoggle</span><span class="punctuation">,</span>
                <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Click to toggle mask overlay on and off."</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Added mask toggle option"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">display_item_set</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Load the latest preview if available """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Loading latest preview"</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_preview</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Preview not updated"</span><span class="grouping">)</span>
            <span class="keyword">return</span>
        <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">load_training_preview</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span>

    <span class="keyword">def</span> <span class="identifier">display_item_process</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Display the preview(s) resized as appropriate """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Displaying preview"</span><span class="grouping">)</span>
        <span class="identifier">sortednames</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">list</span><span class="grouping">(</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span><span class="punctuation">.</span><span class="identifier">keys</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">existing</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook_get_titles_ids</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">should_update</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_preview</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">name</span> <span class="relational-operator">in</span> <span class="identifier">sortednames</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">name</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="identifier">existing</span><span class="punctuation">.</span><span class="identifier">keys</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_child</span><span class="grouping">(</span><span class="identifier">name</span><span class="grouping">)</span>
            <span class="keyword">elif</span> <span class="identifier">should_update</span><span class="punctuation">:</span>
                <span class="identifier">tab_id</span> <span class="arithmetic-assignment">=</span> <span class="identifier">existing</span><span class="grouping">[</span><span class="identifier">name</span><span class="grouping">]</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_child</span><span class="grouping">(</span><span class="identifier">tab_id</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span>

        <span class="keyword">if</span> <span class="identifier">should_update</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">update_preview</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">False</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">add_child</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the preview canvas child """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding child"</span><span class="grouping">)</span>
        <span class="identifier">preview</span> <span class="arithmetic-assignment">=</span> <span class="identifier">PreviewTrainCanvas</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span>
        <span class="identifier">preview</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook_add_page</span><span class="grouping">(</span><span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">widget</span><span class="arithmetic-assignment">=</span><span class="identifier">preview</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">preview</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">helptext</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"modified"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span><span class="grouping">[</span><span class="identifier">name</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">2</span><span class="grouping">]</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">update_child</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">tab_id</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Update the preview canvas """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Updating preview"</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"modified"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span> <span class="relational-operator">!=</span> <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span><span class="grouping">[</span><span class="identifier">name</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">2</span><span class="grouping">]</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"modified"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span><span class="grouping">[</span><span class="identifier">name</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">2</span><span class="grouping">]</span><span class="grouping">)</span>
            <span class="identifier">widget</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook_page_from_id</span><span class="grouping">(</span><span class="identifier">tab_id</span><span class="grouping">)</span>
            <span class="identifier">widget</span><span class="punctuation">.</span><span class="identifier">reload</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">save_items</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Open save dialogue and save preview """</span>
        <span class="identifier">location</span> <span class="arithmetic-assignment">=</span> <span class="identifier">FileHandler</span><span class="grouping">(</span><span class="string-literal">"dir"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">i</span><span class="invalid">l</span><span class="invalid">e</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">location</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="keyword">for</span> <span class="identifier">preview</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">.</span><span class="identifier">children</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">preview</span><span class="punctuation">.</span><span class="identifier">save_preview</span><span class="grouping">(</span><span class="identifier">location</span><span class="grouping">)</span>


<span class="keyword">class</span> <span class="identifier">PreviewTrainCanvas</span><span class="grouping">(</span><span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint: disable=too-many-ancestors</span>
    <span class="comment">""" Canvas to hold a training preview image """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">parent</span><span class="punctuation">,</span> <span class="identifier">previewname</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initializing %s: (previewname: '%s')"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="punctuation">,</span> <span class="identifier">previewname</span><span class="grouping">)</span>
        <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">parent</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">name</span> <span class="arithmetic-assignment">=</span> <span class="identifier">previewname</span>
        <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">resize_image</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">name</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">previewimage</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span><span class="grouping">[</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">name</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">canvas</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Canvas</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">bd</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">highlightthickness</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">canvas</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTH</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">imgcanvas</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">canvas</span><span class="punctuation">.</span><span class="identifier">create_image</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span>
                                                  <span class="int-literal">0</span><span class="punctuation">,</span>
                                                  <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">previewimage</span><span class="punctuation">,</span>
                                                  <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">NW</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">bind</span><span class="grouping">(</span><span class="string-literal">"&lt;Configure&gt;"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">resize</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initialized %s:"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">resize</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">event</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">"""  Resize the image to fit the frame, maintaining aspect ratio """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Resizing preview image"</span><span class="grouping">)</span>
        <span class="identifier">framesize</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">event</span><span class="punctuation">.</span><span class="identifier">width</span><span class="punctuation">,</span> <span class="identifier">event</span><span class="punctuation">.</span><span class="identifier">height</span><span class="grouping">)</span>
        <span class="comment"># Sometimes image is resized before frame is drawn</span>
        <span class="identifier">framesize</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span> <span class="keyword">if</span> <span class="identifier">framesize</span> <span class="relational-operator">==</span> <span class="grouping">(</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span> <span class="keyword">else</span> <span class="identifier">framesize</span>
        <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">resize_image</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">framesize</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">reload</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">reload</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Reload the preview image """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Reloading preview image"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">previewimage</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span><span class="grouping">[</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">name</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">canvas</span><span class="punctuation">.</span><span class="identifier">itemconfig</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">imgcanvas</span><span class="punctuation">,</span> <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">previewimage</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">save_preview</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">location</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Save the figure to file """</span>
        <span class="identifier">filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">name</span>
        <span class="identifier">now</span> <span class="arithmetic-assignment">=</span> <span class="identifier">datetime</span><span class="punctuation">.</span><span class="identifier">datetime</span><span class="punctuation">.</span><span class="identifier">now</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strftime</span><span class="grouping">(</span><span class="string-literal">"%Y%m%d_%H%M%S"</span><span class="grouping">)</span>
        <span class="identifier">filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">location</span><span class="punctuation">,</span>
                                <span class="string-literal">"{}_{}.{}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">filename</span><span class="punctuation">,</span>
                                                  <span class="identifier">now</span><span class="punctuation">,</span>
                                                  <span class="string-literal">"png"</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">previewtrain</span><span class="grouping">[</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">name</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Saved preview to %s"</span><span class="punctuation">,</span> <span class="identifier">filename</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Saved preview to {}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span><span class="grouping">)</span>


<span class="keyword">class</span> <span class="identifier">GraphDisplay</span><span class="grouping">(</span><span class="identifier">DisplayOptionalPage</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint: disable=too-many-ancestors</span>
    <span class="comment">""" The Graph Tab of the Display section """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">parent</span><span class="punctuation">,</span> <span class="identifier">tab_name</span><span class="punctuation">,</span> <span class="identifier">helptext</span><span class="punctuation">,</span> <span class="identifier">wait_time</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_trace_vars</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">parent</span><span class="punctuation">,</span> <span class="identifier">tab_name</span><span class="punctuation">,</span> <span class="identifier">helptext</span><span class="punctuation">,</span> <span class="identifier">wait_time</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">set_vars</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add graphing specific variables to the default variables.

        Overrides original method.

        Returns
        -------
        dict
            The variable names with their corresponding tkinter variable
        """</span>
        <span class="identifier">tk_vars</span> <span class="arithmetic-assignment">=</span> <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">set_vars</span><span class="grouping">(</span><span class="grouping">)</span>

        <span class="identifier">smoothgraph</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">DoubleVar</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">smoothgraph</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="float-literal">0.900</span><span class="grouping">)</span>
        <span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"smoothgraph"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">smoothgraph</span>

        <span class="identifier">raw_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BooleanVar</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">raw_var</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"raw_data"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">raw_var</span>

        <span class="identifier">smooth_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BooleanVar</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">smooth_var</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"smooth_data"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">smooth_var</span>

        <span class="identifier">iterations_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">IntVar</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">iterations_var</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="int-literal">10000</span><span class="grouping">)</span>
        <span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"display_iterations"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">iterations_var</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="identifier">tk_vars</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">tk_vars</span>

    <span class="keyword">def</span> <span class="identifier">on_tab_select</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Callback for when the graph tab is selected.

        Pull latest data and run the tab's update code when the tab is selected.
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Callback received for '%s' tab"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">tabname</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">get_config</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"refreshgraph"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_update_page</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">add_options</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the additional options """</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_option_refresh</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">add_options</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_option_raw</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_option_smoothed</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_option_smoothing</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_option_iterations</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_option_refresh</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add refresh button to refresh graph immediately """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding refresh option"</span><span class="grouping">)</span>
        <span class="identifier">tk_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_config</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"refreshgraph"</span><span class="grouping">]</span>
        <span class="identifier">btnrefresh</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Button</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">optsframe</span><span class="punctuation">,</span>
                                <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span><span class="grouping">[</span><span class="string-literal">"reload"</span><span class="grouping">]</span><span class="punctuation">,</span>
                                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span><span class="punctuation">:</span> <span class="identifier">tk_var</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">btnrefresh</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">btnrefresh</span><span class="punctuation">,</span>
                <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Graph updates at every model save. Click to refresh now."</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Added refresh option"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_option_raw</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add check-button to hide/display raw data """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding display raw option"</span><span class="grouping">)</span>
        <span class="identifier">tk_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"raw_data"</span><span class="grouping">]</span>
        <span class="identifier">chkbtn</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Checkbutton</span><span class="grouping">(</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">optsframe</span><span class="punctuation">,</span>
            <span class="identifier">variable</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span>
            <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Raw"</span><span class="punctuation">,</span>
            <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">v</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data_callback</span><span class="grouping">(</span><span class="string-literal">"raw"</span><span class="punctuation">,</span> <span class="identifier">v</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">chkbtn</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">chkbtn</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Display the raw loss data"</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_option_smoothed</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add check-button to hide/display smoothed data """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding display smoothed option"</span><span class="grouping">)</span>
        <span class="identifier">tk_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"smooth_data"</span><span class="grouping">]</span>
        <span class="identifier">chkbtn</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Checkbutton</span><span class="grouping">(</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">optsframe</span><span class="punctuation">,</span>
            <span class="identifier">variable</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span>
            <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Smoothed"</span><span class="punctuation">,</span>
            <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">v</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_display_data_callback</span><span class="grouping">(</span><span class="string-literal">"smoothed"</span><span class="punctuation">,</span> <span class="identifier">v</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">chkbtn</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">chkbtn</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Display the smoothed loss data"</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_option_smoothing</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add a slider to adjust the smoothing amount """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding Smoothing Slider"</span><span class="grouping">)</span>
        <span class="identifier">tk_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"smoothgraph"</span><span class="grouping">]</span>
        <span class="identifier">min_max</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="float-literal">0.999</span><span class="grouping">)</span>
        <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Set the smoothing amount. 0 is no smoothing, 0.99 is maximum smoothing."</span><span class="grouping">)</span>

        <span class="identifier">ctl_frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">optsframe</span><span class="grouping">)</span>
        <span class="identifier">ctl_frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>

        <span class="identifier">lbl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Label</span><span class="grouping">(</span><span class="identifier">ctl_frame</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Smoothing:"</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
        <span class="identifier">lbl</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">N</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>

        <span class="identifier">tbox</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Entry</span><span class="grouping">(</span><span class="identifier">ctl_frame</span><span class="punctuation">,</span> <span class="identifier">width</span><span class="arithmetic-assignment">=</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="identifier">textvariable</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span> <span class="identifier">justify</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>
        <span class="identifier">tbox</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>

        <span class="identifier">ctl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Scale</span><span class="grouping">(</span>
            <span class="identifier">ctl_frame</span><span class="punctuation">,</span>
            <span class="identifier">variable</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span>
            <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">val</span><span class="punctuation">,</span> <span class="identifier">var</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span> <span class="identifier">dt</span><span class="arithmetic-assignment">=</span><span class="identifier">float</span><span class="punctuation">,</span> <span class="identifier">rn</span><span class="arithmetic-assignment">=</span><span class="int-literal">3</span><span class="punctuation">,</span> <span class="identifier">mm</span><span class="arithmetic-assignment">=</span><span class="identifier">min_max</span><span class="punctuation">:</span>
            <span class="identifier">set_slider_rounding</span><span class="grouping">(</span><span class="identifier">val</span><span class="punctuation">,</span> <span class="identifier">var</span><span class="punctuation">,</span> <span class="identifier">dt</span><span class="punctuation">,</span> <span class="identifier">rn</span><span class="punctuation">,</span> <span class="identifier">mm</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">ctl</span><span class="grouping">[</span><span class="string-literal">"from_"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">min_max</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
        <span class="identifier">ctl</span><span class="grouping">[</span><span class="string-literal">"to"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">min_max</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span>
        <span class="identifier">ctl</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">item</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="identifier">tbox</span><span class="punctuation">,</span> <span class="identifier">ctl</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">item</span><span class="punctuation">,</span>
                    <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span>
                    <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Added Smoothing Slider"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_option_iterations</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add a slider to adjust the amount if iterations to display """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding Iterations Slider"</span><span class="grouping">)</span>
        <span class="identifier">tk_var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"display_iterations"</span><span class="grouping">]</span>
        <span class="identifier">min_max</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">100000</span><span class="grouping">)</span>
        <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Set the number of iterations to display. 0 displays the full session."</span><span class="grouping">)</span>

        <span class="identifier">ctl_frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">optsframe</span><span class="grouping">)</span>
        <span class="identifier">ctl_frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>

        <span class="identifier">lbl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Label</span><span class="grouping">(</span><span class="identifier">ctl_frame</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Iterations:"</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
        <span class="identifier">lbl</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">N</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>

        <span class="identifier">tbox</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Entry</span><span class="grouping">(</span><span class="identifier">ctl_frame</span><span class="punctuation">,</span> <span class="identifier">width</span><span class="arithmetic-assignment">=</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="identifier">textvariable</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span> <span class="identifier">justify</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>
        <span class="identifier">tbox</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">RIGHT</span><span class="grouping">)</span>

        <span class="identifier">ctl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Scale</span><span class="grouping">(</span>
            <span class="identifier">ctl_frame</span><span class="punctuation">,</span>
            <span class="identifier">variable</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span>
            <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">val</span><span class="punctuation">,</span> <span class="identifier">var</span><span class="arithmetic-assignment">=</span><span class="identifier">tk_var</span><span class="punctuation">,</span> <span class="identifier">dt</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">rn</span><span class="arithmetic-assignment">=</span><span class="int-literal">1000</span><span class="punctuation">,</span> <span class="identifier">mm</span><span class="arithmetic-assignment">=</span><span class="identifier">min_max</span><span class="punctuation">:</span>
            <span class="identifier">set_slider_rounding</span><span class="grouping">(</span><span class="identifier">val</span><span class="punctuation">,</span> <span class="identifier">var</span><span class="punctuation">,</span> <span class="identifier">dt</span><span class="punctuation">,</span> <span class="identifier">rn</span><span class="punctuation">,</span> <span class="identifier">mm</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">ctl</span><span class="grouping">[</span><span class="string-literal">"from_"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">min_max</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
        <span class="identifier">ctl</span><span class="grouping">[</span><span class="string-literal">"to"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">min_max</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span>
        <span class="identifier">ctl</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">item</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="identifier">tbox</span><span class="punctuation">,</span> <span class="identifier">ctl</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">item</span><span class="punctuation">,</span>
                    <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span>
                    <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Added Iterations Slider"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">display_item_set</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Load the graph(s) if available """</span>
        <span class="keyword">if</span> <span class="identifier">Session</span><span class="punctuation">.</span><span class="identifier">is_training</span> <span class="logical-operator">and</span> <span class="identifier">Session</span><span class="punctuation">.</span><span class="identifier">logging_disabled</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Logs disabled. Hiding graph"</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">set_info</span><span class="grouping">(</span><span class="string-literal">"Graph is disabled as 'no-logs' has been selected"</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_clear_trace_variables</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">Session</span><span class="punctuation">.</span><span class="identifier">is_training</span> <span class="logical-operator">and</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Loading graph"</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Session</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_add_trace_variables</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Clearing graph"</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_clear_trace_variables</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">display_item_process</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add a single graph to the graph window """</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">Session</span><span class="punctuation">.</span><span class="identifier">is_training</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Waiting for Session Data to become available to graph"</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">after</span><span class="grouping">(</span><span class="int-literal">1000</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item_process</span><span class="grouping">)</span>
            <span class="keyword">return</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding graph"</span><span class="grouping">)</span>
        <span class="identifier">existing</span> <span class="arithmetic-assignment">=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook_get_titles_ids</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">keys</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">loss_keys</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">key</span>
                     <span class="keyword">for</span> <span class="identifier">key</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_item</span><span class="punctuation">.</span><span class="identifier">get_loss_keys</span><span class="grouping">(</span><span class="identifier">Session</span><span class="punctuation">.</span><span class="identifier">session_ids</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
                     <span class="keyword">if</span> <span class="identifier">key</span> <span class="relational-operator">!=</span> <span class="string-literal">"total"</span><span class="grouping">]</span>
        <span class="identifier">display_tabs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">key</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">rstrip</span><span class="grouping">(</span><span class="string-literal">"_"</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">key</span> <span class="relational-operator">in</span> <span class="identifier">loss_keys</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">loss_key</span> <span class="relational-operator">in</span> <span class="identifier">display_tabs</span><span class="punctuation">:</span>
            <span class="identifier">tabname</span> <span class="arithmetic-assignment">=</span> <span class="identifier">loss_key</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">"_", " "</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">tabname</span> <span class="relational-operator">in</span> <span class="identifier">existing</span><span class="punctuation">:</span>
                <span class="keyword">continue</span>

            <span class="identifier">display_keys</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">key</span> <span class="keyword">for</span> <span class="identifier">key</span> <span class="relational-operator">in</span> <span class="identifier">loss_keys</span> <span class="keyword">if</span> <span class="identifier">key</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="identifier">loss_key</span><span class="grouping">)</span><span class="grouping">]</span>
            <span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Calculations</span><span class="grouping">(</span><span class="identifier">session_id</span><span class="arithmetic-assignment">=</span><span class="identifier">Session</span><span class="punctuation">.</span><span class="identifier">session_ids</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span>
                                <span class="identifier">display</span><span class="arithmetic-assignment">=</span><span class="string-literal">"loss"</span><span class="punctuation">,</span>
                                <span class="identifier">loss_keys</span><span class="arithmetic-assignment">=</span><span class="identifier">display_keys</span><span class="punctuation">,</span>
                                <span class="identifier">selections</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="string-literal">"raw", "smoothed"</span><span class="grouping">]</span><span class="punctuation">,</span>
                                <span class="identifier">smooth_amount</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"smoothgraph"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_child</span><span class="grouping">(</span><span class="identifier">tabname</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_smooth_amount_callback</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Update each graph's smooth amount on variable change """</span>
        <span class="keyword">try</span><span class="punctuation">:</span>
            <span class="identifier">smooth_amount</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"smoothgraph"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">except</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TclError</span><span class="punctuation">:</span>
            <span class="comment"># Don't update when there is no value in the variable</span>
            <span class="keyword">return</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Updating graph smooth_amount: (new_value: %s, args: %s)"</span><span class="punctuation">,</span>
                     <span class="identifier">smooth_amount</span><span class="punctuation">,</span> <span class="identifier">args</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">graph</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">.</span><span class="identifier">children</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">calcs</span><span class="punctuation">.</span><span class="identifier">set_smooth_amount</span><span class="grouping">(</span><span class="identifier">smooth_amount</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_iteration_limit_callback</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Limit the amount of data displayed in the live graph on a iteration slider
        variable change. """</span>
        <span class="keyword">try</span><span class="punctuation">:</span>
            <span class="identifier">limit</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="string-literal">"display_iterations"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">except</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TclError</span><span class="punctuation">:</span>
            <span class="comment"># Don't update when there is no value in the variable</span>
            <span class="keyword">return</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Updating graph iteration limit: (new_value: %s, args: %s)"</span><span class="punctuation">,</span>
                     <span class="identifier">limit</span><span class="punctuation">,</span> <span class="identifier">args</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">graph</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">.</span><span class="identifier">children</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">calcs</span><span class="punctuation">.</span><span class="identifier">set_iterations_limit</span><span class="grouping">(</span><span class="identifier">limit</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_display_data_callback</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">line</span><span class="punctuation">,</span> <span class="identifier">variable</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Update the displayed graph lines based on option check button selection.

        Parameters
        ----------
        line: str
            The line to hide or display
        variable: :class:`tkinter.BooleanVar`
            The tkinter variable containing the ``True`` or ``False`` data for this display item
        """</span>
        <span class="identifier">var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">variable</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Updating display %s to %s"</span><span class="punctuation">,</span> <span class="identifier">line</span><span class="punctuation">,</span> <span class="identifier">var</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">graph</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">.</span><span class="identifier">children</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">calcs</span><span class="punctuation">.</span><span class="identifier">update_selections</span><span class="grouping">(</span><span class="identifier">line</span><span class="punctuation">,</span> <span class="identifier">var</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">add_child</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the graph for the selected keys """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding child: %s"</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span>
        <span class="identifier">graph</span> <span class="arithmetic-assignment">=</span> <span class="identifier">TrainingGraph</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="string-literal">"Loss"</span><span class="grouping">)</span>
        <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">build</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">graph</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook_add_page</span><span class="grouping">(</span><span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">widget</span><span class="arithmetic-assignment">=</span><span class="identifier">graph</span><span class="grouping">)</span>
        <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">graph</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">helptext</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">save_items</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Open save dialogue and save graphs """</span>
        <span class="identifier">graphlocation</span> <span class="arithmetic-assignment">=</span> <span class="identifier">FileHandler</span><span class="grouping">(</span><span class="string-literal">"dir"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">i</span><span class="invalid">l</span><span class="invalid">e</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">graphlocation</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="keyword">for</span> <span class="identifier">graph</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">.</span><span class="identifier">children</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">save_fig</span><span class="grouping">(</span><span class="identifier">graphlocation</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_add_trace_variables</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add tracing for when the option sliders are updated, for updating the graph. """</span>
        <span class="keyword">for</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">action</span> <span class="relational-operator">in</span> <span class="identifier">zip</span><span class="grouping">(</span><span class="grouping">(</span><span class="string-literal">"smoothgraph", "display_iterations"</span><span class="grouping">)</span><span class="punctuation">,</span>
                                <span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_smooth_amount_callback</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_iteration_limit_callback</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">var</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">vars</span><span class="grouping">[</span><span class="identifier">name</span><span class="grouping">]</span>
            <span class="keyword">if</span> <span class="identifier">name</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_trace_vars</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_trace_vars</span><span class="grouping">[</span><span class="identifier">name</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">var</span><span class="punctuation">,</span> <span class="identifier">var</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"w"</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="grouping">)</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_clear_trace_variables</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Clear all of the trace variables from :attr:`_trace_vars` and reset the dictionary. """</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_trace_vars</span><span class="punctuation">:</span>
            <span class="keyword">for</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="identifier">var</span><span class="punctuation">,</span> <span class="identifier">trace</span><span class="grouping">)</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_trace_vars</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Clearing trace from variable: %s"</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span>
                <span class="identifier">var</span><span class="punctuation">.</span><span class="identifier">trace_vdelete</span><span class="grouping">(</span><span class="string-literal">"w"</span><span class="punctuation">,</span> <span class="identifier">trace</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_trace_vars</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">close</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Clear the plots from RAM """</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_clear_trace_variables</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"No graphs to clear. Returning"</span><span class="grouping">)</span>
            <span class="keyword">return</span>

        <span class="keyword">for</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">graph</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">subnotebook</span><span class="punctuation">.</span><span class="identifier">children</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Clearing: %s"</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span>
            <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">clear</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">close</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>