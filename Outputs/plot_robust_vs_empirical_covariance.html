<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="identifier">r</span><span class="comment">"""
=======================================
Robust vs Empirical covariance estimate
=======================================

The usual covariance maximum likelihood estimate is very sensitive to the
presence of outliers in the data set. In such a case, it would be better to
use a robust estimator of covariance to guarantee that the estimation is
resistant to "erroneous" observations in the data set. [1]_, [2]_

Minimum Covariance Determinant Estimator
----------------------------------------
The Minimum Covariance Determinant estimator is a robust, high-breakdown point
(i.e. it can be used to estimate the covariance matrix of highly contaminated
datasets, up to
:math:`\frac{n_\text{samples} - n_\text{features}-1}{2}` outliers) estimator of
covariance. The idea is to find
:math:`\frac{n_\text{samples} + n_\text{features}+1}{2}`
observations whose empirical covariance has the smallest determinant, yielding
a "pure" subset of observations from which to compute standards estimates of
location and covariance. After a correction step aiming at compensating the
fact that the estimates were learned from only a portion of the initial data,
we end up with robust estimates of the data set location and covariance.

The Minimum Covariance Determinant estimator (MCD) has been introduced by
P.J.Rousseuw in [3]_.

Evaluation
----------
In this example, we compare the estimation errors that are made when using
various types of location and covariance estimates on contaminated Gaussian
distributed data sets:

- The mean and the empirical covariance of the full dataset, which break
  down as soon as there are outliers in the data set
- The robust MCD, that has a low error provided
  :math:`n_\text{samples} &gt; 5n_\text{features}`
- The mean and the empirical covariance of the observations that are known
  to be good ones. This can be considered as a "perfect" MCD estimation,
  so one can trust our implementation by comparing to this case.


References
----------
.. [1] Johanna Hardin, David M Rocke. The distribution of robust distances.
    Journal of Computational and Graphical Statistics. December 1, 2005,
    14(4): 928-946.
.. [2] Zoubir A., Koivunen V., Chakhchoukh Y. and Muma M. (2012). Robust
    estimation in signal processing: A tutorial-style treatment of
    fundamental concepts. IEEE Signal Processing Magazine 29(4), 61-80.
.. [3] P. J. Rousseeuw. Least median of squares regression. Journal of American
    Statistical Ass., 79:871, 1984.

"""</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">__doc__</span><span class="grouping">)</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">font_manager</span>

<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">covariance</span> <span class="keyword">import</span> <span class="identifier">EmpiricalCovariance</span><span class="punctuation">,</span> <span class="identifier">MinCovDet</span>

<span class="comment"># example settings</span>
<span class="identifier">n_samples</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">80</span>
<span class="identifier">n_features</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">5</span>
<span class="identifier">repeat</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">10</span>

<span class="identifier">range_n_outliers</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">concatenate</span><span class="grouping">(</span>
    <span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">n_samples</span> <span class="arithmetic-operator">/</span> <span class="int-literal">8</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="grouping">)</span><span class="punctuation">,</span>
     <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="identifier">n_samples</span> <span class="arithmetic-operator">/</span> <span class="int-literal">8</span><span class="punctuation">,</span> <span class="identifier">n_samples</span> <span class="arithmetic-operator">/</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="grouping">)</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">int</span><span class="grouping">)</span>

<span class="comment"># definition of arrays to store results</span>
<span class="identifier">err_loc_mcd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">.</span><span class="identifier">size</span><span class="punctuation">,</span> <span class="identifier">repeat</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">err_cov_mcd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">.</span><span class="identifier">size</span><span class="punctuation">,</span> <span class="identifier">repeat</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">err_loc_emp_full</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">.</span><span class="identifier">size</span><span class="punctuation">,</span> <span class="identifier">repeat</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">err_cov_emp_full</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">.</span><span class="identifier">size</span><span class="punctuation">,</span> <span class="identifier">repeat</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">err_loc_emp_pure</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">.</span><span class="identifier">size</span><span class="punctuation">,</span> <span class="identifier">repeat</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">err_cov_emp_pure</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">.</span><span class="identifier">size</span><span class="punctuation">,</span> <span class="identifier">repeat</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="comment"># computation</span>
<span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">n_outliers</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="keyword">for</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">repeat</span><span class="grouping">)</span><span class="punctuation">:</span>

        <span class="identifier">rng</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">RandomState</span><span class="grouping">(</span><span class="identifier">i</span> <span class="arithmetic-operator">*</span> <span class="identifier">j</span><span class="grouping">)</span>

        <span class="comment"># generate data</span>
        <span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rng</span><span class="punctuation">.</span><span class="identifier">randn</span><span class="grouping">(</span><span class="identifier">n_samples</span><span class="punctuation">,</span> <span class="identifier">n_features</span><span class="grouping">)</span>
        <span class="comment"># add some outliers</span>
        <span class="identifier">outliers_index</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rng</span><span class="punctuation">.</span><span class="identifier">permutation</span><span class="grouping">(</span><span class="identifier">n_samples</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="identifier">n_outliers</span><span class="grouping">]</span>
        <span class="identifier">outliers_offset</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">10</span><span class="punctuation">.</span> <span class="arithmetic-operator">*</span> <span class="invalid">\</span>
            <span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randint</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">size</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="identifier">n_outliers</span><span class="punctuation">,</span> <span class="identifier">n_features</span><span class="grouping">)</span><span class="grouping">)</span> <span class="arithmetic-operator">-</span> <span class="float-literal">0.5</span><span class="grouping">)</span>
        <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">outliers_index</span><span class="grouping">]</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">outliers_offset</span>
        <span class="identifier">inliers_mask</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">ones</span><span class="grouping">(</span><span class="identifier">n_samples</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">bool</span><span class="grouping">)</span>
        <span class="identifier">inliers_mask</span><span class="grouping">[</span><span class="identifier">outliers_index</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">False</span>

        <span class="comment"># fit a Minimum Covariance Determinant (MCD) robust estimator to data</span>
        <span class="identifier">mcd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">MinCovDet</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
        <span class="comment"># compare raw robust estimates with the true location and covariance</span>
        <span class="identifier">err_loc_mcd</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">mcd</span><span class="punctuation">.</span><span class="identifier">location_</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span><span class="grouping">)</span>
        <span class="identifier">err_cov_mcd</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">mcd</span><span class="punctuation">.</span><span class="identifier">error_norm</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">eye</span><span class="grouping">(</span><span class="identifier">n_features</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="comment"># compare estimators learned from the full data set with true</span>
        <span class="comment"># parameters</span>
        <span class="identifier">err_loc_emp_full</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span><span class="grouping">)</span>
        <span class="identifier">err_cov_emp_full</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">EmpiricalCovariance</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">error_norm</span><span class="grouping">(</span>
            <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">eye</span><span class="grouping">(</span><span class="identifier">n_features</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="comment"># compare with an empirical covariance learned from a pure data set</span>
        <span class="comment"># (i.e. "perfect" mcd)</span>
        <span class="identifier">pure_X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">inliers_mask</span><span class="grouping">]</span>
        <span class="identifier">pure_location</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pure_X</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">pure_emp_cov</span> <span class="arithmetic-assignment">=</span> <span class="identifier">EmpiricalCovariance</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">pure_X</span><span class="grouping">)</span>
        <span class="identifier">err_loc_emp_pure</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">pure_location</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span><span class="grouping">)</span>
        <span class="identifier">err_cov_emp_pure</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pure_emp_cov</span><span class="punctuation">.</span><span class="identifier">error_norm</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">eye</span><span class="grouping">(</span><span class="identifier">n_features</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="comment"># Display results</span>
<span class="identifier">font_prop</span> <span class="arithmetic-assignment">=</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">font_manager</span><span class="punctuation">.</span><span class="identifier">FontProperties</span><span class="grouping">(</span><span class="identifier">size</span><span class="arithmetic-assignment">=</span><span class="int-literal">11</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span>
<span class="identifier">lw</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">2</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">errorbar</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">,</span> <span class="identifier">err_loc_mcd</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">yerr</span><span class="arithmetic-assignment">=</span><span class="identifier">err_loc_mcd</span><span class="punctuation">.</span><span class="identifier">std</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sqrt</span><span class="grouping">(</span><span class="identifier">repeat</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Robust location"</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="identifier">lw</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'m'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">errorbar</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">,</span> <span class="identifier">err_loc_emp_full</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">yerr</span><span class="arithmetic-assignment">=</span><span class="identifier">err_loc_emp_full</span><span class="punctuation">.</span><span class="identifier">std</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sqrt</span><span class="grouping">(</span><span class="identifier">repeat</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Full data set mean"</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="identifier">lw</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'green'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">errorbar</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">,</span> <span class="identifier">err_loc_emp_pure</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">yerr</span><span class="arithmetic-assignment">=</span><span class="identifier">err_loc_emp_pure</span><span class="punctuation">.</span><span class="identifier">std</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sqrt</span><span class="grouping">(</span><span class="identifier">repeat</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Pure data set mean"</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="identifier">lw</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'black'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="string-literal">"Influence of outliers on the location estimation"</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">ylabel</span><span class="grouping">(</span><span class="identifier">r</span><span class="string-literal">"Error ($||\mu - \hat{\mu}||_2^2$)"</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">legend</span><span class="grouping">(</span><span class="identifier">loc</span><span class="arithmetic-assignment">=</span><span class="string-literal">"upper left"</span><span class="punctuation">,</span> <span class="identifier">prop</span><span class="arithmetic-assignment">=</span><span class="identifier">font_prop</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">)</span>
<span class="identifier">x_size</span> <span class="arithmetic-assignment">=</span> <span class="identifier">range_n_outliers</span><span class="punctuation">.</span><span class="identifier">size</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">errorbar</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">,</span> <span class="identifier">err_cov_mcd</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">yerr</span><span class="arithmetic-assignment">=</span><span class="identifier">err_cov_mcd</span><span class="punctuation">.</span><span class="identifier">std</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Robust covariance (mcd)"</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'m'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">errorbar</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="grouping">[</span><span class="punctuation">:</span><span class="grouping">(</span><span class="identifier">x_size</span> <span class="arithmetic-operator">//</span> <span class="int-literal">5</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
             <span class="identifier">err_cov_emp_full</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="grouping">(</span><span class="identifier">x_size</span> <span class="arithmetic-operator">//</span> <span class="int-literal">5</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
             <span class="identifier">yerr</span><span class="arithmetic-assignment">=</span><span class="identifier">err_cov_emp_full</span><span class="punctuation">.</span><span class="identifier">std</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="grouping">(</span><span class="identifier">x_size</span> <span class="arithmetic-operator">//</span> <span class="int-literal">5</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
             <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Full data set empirical covariance"</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'green'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="grouping">[</span><span class="grouping">(</span><span class="identifier">x_size</span> <span class="arithmetic-operator">//</span> <span class="int-literal">5</span><span class="grouping">)</span><span class="punctuation">:</span><span class="grouping">(</span><span class="identifier">x_size</span> <span class="arithmetic-operator">//</span> <span class="int-literal">2</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
         <span class="identifier">err_cov_emp_full</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">[</span><span class="grouping">(</span><span class="identifier">x_size</span> <span class="arithmetic-operator">//</span> <span class="int-literal">5</span><span class="grouping">)</span><span class="punctuation">:</span><span class="grouping">(</span><span class="identifier">x_size</span> <span class="arithmetic-operator">//</span> <span class="int-literal">2</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
         <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'green', ls='--'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">errorbar</span><span class="grouping">(</span><span class="identifier">range_n_outliers</span><span class="punctuation">,</span> <span class="identifier">err_cov_emp_pure</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">yerr</span><span class="arithmetic-assignment">=</span><span class="identifier">err_cov_emp_pure</span><span class="punctuation">.</span><span class="identifier">std</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
             <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Pure data set empirical covariance"</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'black'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="string-literal">"Influence of outliers on the covariance estimation"</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">xlabel</span><span class="grouping">(</span><span class="string-literal">"Amount of contamination (%)"</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">ylabel</span><span class="grouping">(</span><span class="string-literal">"RMSE"</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">legend</span><span class="grouping">(</span><span class="identifier">loc</span><span class="arithmetic-assignment">=</span><span class="string-literal">"upper center"</span><span class="punctuation">,</span> <span class="identifier">prop</span><span class="arithmetic-assignment">=</span><span class="identifier">font_prop</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>