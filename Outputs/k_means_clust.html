<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""README, Author - Anurag Kumar(mailto:anuragkumarak95@gmail.com)
Requirements:
  - sklearn
  - numpy
  - matplotlib
Python:
  - 3.5
Inputs:
  - X , a 2D numpy array of features.
  - k , number of clusters to create.
  - initial_centroids , initial centroid values generated by utility function(mentioned
    in usage).
  - maxiter , maximum number of iterations to process.
  - heterogeneity , empty list that will be filled with hetrogeneity values if passed
    to kmeans func.
Usage:
  1. define 'k' value, 'X' features array and 'hetrogeneity' empty list
  2. create initial_centroids,
        initial_centroids = get_initial_centroids(
            X,
            k,
            seed=0 # seed value for initial centroid generation,
                   # None for randomness(default=None)
            )
  3. find centroids and clusters using kmeans function.
        centroids, cluster_assignment = kmeans(
            X,
            k,
            initial_centroids,
            maxiter=400,
            record_heterogeneity=heterogeneity,
            verbose=True # whether to print logs in console or not.(default=False)
            )
  4. Plot the loss function, hetrogeneity values for every iteration saved in
     hetrogeneity list.
        plot_heterogeneity(
            heterogeneity,
            k
        )
  5. Transfers Dataframe into excel format it must have feature called
      'Clust' with k means clustering numbers in it.
"""</span>
<span class="keyword">import</span> <span class="identifier">warnings</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">pandas</span> <span class="keyword">as</span> <span class="identifier">pd</span>
<span class="keyword">from</span> <span class="identifier">matplotlib</span> <span class="keyword">import</span> <span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">metrics</span> <span class="keyword">import</span> <span class="identifier">pairwise_distances</span>

<span class="identifier">warnings</span><span class="punctuation">.</span><span class="identifier">filterwarnings</span><span class="grouping">(</span><span class="string-literal">"ignore"</span><span class="grouping">)</span>

<span class="identifier">TAG</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"K-MEANS-CLUST/ "</span>


<span class="keyword">def</span> <span class="identifier">get_initial_centroids</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">seed</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Randomly choose k data points as initial centroids"""</span>
    <span class="keyword">if</span> <span class="identifier">seed</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>  <span class="comment"># useful for obtaining consistent results</span>
        <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">seed</span><span class="grouping">(</span><span class="identifier">seed</span><span class="grouping">)</span>
    <span class="identifier">n</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>  <span class="comment"># number of data points</span>

    <span class="comment"># Pick K indices from range [0, N).</span>
    <span class="identifier">rand_indices</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randint</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">n</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="grouping">)</span>

    <span class="comment"># Keep centroids as dense format, as many entries will be nonzero due to averaging.</span>
    <span class="comment"># As long as at least one document in a cluster contains a word,</span>
    <span class="comment"># it will carry a nonzero weight in the TF-IDF vector of the centroid.</span>
    <span class="identifier">centroids</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data</span><span class="grouping">[</span><span class="identifier">rand_indices</span><span class="punctuation">,</span> <span class="punctuation">:</span><span class="grouping">]</span>

    <span class="keyword">return</span> <span class="identifier">centroids</span>


<span class="keyword">def</span> <span class="identifier">centroid_pairwise_dist</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">centroids</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="keyword">return</span> <span class="identifier">pairwise_distances</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">centroids</span><span class="punctuation">,</span> <span class="identifier">metric</span><span class="arithmetic-assignment">=</span><span class="string-literal">"euclidean"</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">i</span><span class="invalid">g</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">u</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">e</span><span class="invalid">r</span><span class="invalid">s</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">centroids</span><span class="grouping">)</span><span class="punctuation">:</span>

    <span class="comment"># Compute distances between each data point and the set of centroids:</span>
    <span class="comment"># Fill in the blank (RHS only)</span>
    <span class="identifier">distances_from_centroids</span> <span class="arithmetic-assignment">=</span> <span class="identifier">centroid_pairwise_dist</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">centroids</span><span class="grouping">)</span>

    <span class="comment"># Compute cluster assignments for each data point:</span>
    <span class="comment"># Fill in the blank (RHS only)</span>
    <span class="identifier">cluster_assignment</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">argmin</span><span class="grouping">(</span><span class="identifier">distances_from_centroids</span><span class="punctuation">,</span> <span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">cluster_assignment</span>


<span class="keyword">def</span> <span class="identifier">revise_centroids</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">cluster_assignment</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">new_centroids</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">k</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment"># Select all data points that belong to cluster i. Fill in the blank (RHS only)</span>
        <span class="identifier">member_data_points</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data</span><span class="grouping">[</span><span class="identifier">cluster_assignment</span> <span class="relational-operator">==</span> <span class="identifier">i</span><span class="grouping">]</span>
        <span class="comment"># Compute the mean of the data points. Fill in the blank (RHS only)</span>
        <span class="identifier">centroid</span> <span class="arithmetic-assignment">=</span> <span class="identifier">member_data_points</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">new_centroids</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">centroid</span><span class="grouping">)</span>
    <span class="identifier">new_centroids</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">new_centroids</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">new_centroids</span>


<span class="keyword">def</span> <span class="identifier">compute_heterogeneity</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">centroids</span><span class="punctuation">,</span> <span class="identifier">cluster_assignment</span><span class="grouping">)</span><span class="punctuation">:</span>

    <span class="identifier">heterogeneity</span> <span class="arithmetic-assignment">=</span> <span class="float-literal">0.0</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">k</span><span class="grouping">)</span><span class="punctuation">:</span>

        <span class="comment"># Select all data points that belong to cluster i. Fill in the blank (RHS only)</span>
        <span class="identifier">member_data_points</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data</span><span class="grouping">[</span><span class="identifier">cluster_assignment</span> <span class="relational-operator">==</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="punctuation">:</span><span class="grouping">]</span>

        <span class="keyword">if</span> <span class="identifier">member_data_points</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">:</span>  <span class="comment"># check if i-th cluster is non-empty</span>
            <span class="comment"># Compute distances from centroid to data points (RHS only)</span>
            <span class="identifier">distances</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pairwise_distances</span><span class="grouping">(</span>
                <span class="identifier">member_data_points</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="identifier">centroids</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">metric</span><span class="arithmetic-assignment">=</span><span class="string-literal">"euclidean"</span>
            <span class="grouping">)</span>
            <span class="identifier">squared_distances</span> <span class="arithmetic-assignment">=</span> <span class="identifier">distances</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span>
            <span class="identifier">heterogeneity</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">squared_distances</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">heterogeneity</span>


<span class="keyword">def</span> <span class="identifier">plot_heterogeneity</span><span class="grouping">(</span><span class="identifier">heterogeneity</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">figure</span><span class="grouping">(</span><span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">7</span><span class="punctuation">,</span> <span class="int-literal">4</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">heterogeneity</span><span class="punctuation">,</span> <span class="identifier">linewidth</span><span class="arithmetic-assignment">=</span><span class="int-literal">4</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">xlabel</span><span class="grouping">(</span><span class="string-literal">"# Iterations"</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">ylabel</span><span class="grouping">(</span><span class="string-literal">"Heterogeneity"</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Heterogeneity of clustering over time, K={k:d}"</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">rcParams</span><span class="punctuation">.</span><span class="identifier">update</span><span class="grouping">(</span><span class="grouping">{</span><span class="string-literal">"font.size"</span><span class="punctuation">:</span> <span class="int-literal">16</span><span class="grouping">}</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">kmeans</span><span class="grouping">(</span>
    <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">initial_centroids</span><span class="punctuation">,</span> <span class="identifier">maxiter</span><span class="arithmetic-assignment">=</span><span class="int-literal">500</span><span class="punctuation">,</span> <span class="identifier">record_heterogeneity</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">verbose</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span>
<span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""This function runs k-means on given data and initial set of centroids.
    maxiter: maximum number of iterations to run.(default=500)
    record_heterogeneity: (optional) a list, to store the history of heterogeneity
                          as function of iterations
                          if None, do not store the history.
    verbose: if True, print how many data points changed their cluster labels in
                          each iteration"""</span>
    <span class="identifier">centroids</span> <span class="arithmetic-assignment">=</span> <span class="identifier">initial_centroids</span><span class="grouping">[</span><span class="punctuation">:</span><span class="grouping">]</span>
    <span class="identifier">prev_cluster_assignment</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>

    <span class="keyword">for</span> <span class="identifier">itr</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">maxiter</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="identifier">verbose</span><span class="punctuation">:</span>
            <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">itr</span><span class="punctuation">,</span> <span class="identifier">end</span><span class="arithmetic-assignment">=</span><span class="string-literal">""</span><span class="grouping">)</span>

        <span class="comment"># 1. Make cluster assignments using nearest centroids</span>
        <span class="identifier">cluster_assignment</span> <span class="arithmetic-assignment">=</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">i</span><span class="invalid">g</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">u</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">e</span><span class="invalid">r</span><span class="invalid">s</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">centroids</span><span class="grouping">)</span>

        <span class="comment"># 2. Compute a new centroid for each of the k clusters, averaging all data</span>
        <span class="comment">#    points assigned to that cluster.</span>
        <span class="identifier">centroids</span> <span class="arithmetic-assignment">=</span> <span class="identifier">revise_centroids</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">cluster_assignment</span><span class="grouping">)</span>

        <span class="comment"># Check for convergence: if none of the assignments changed, stop</span>
        <span class="keyword">if</span> <span class="grouping">(</span>
            <span class="identifier">prev_cluster_assignment</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span>
            <span class="logical-operator">and</span> <span class="grouping">(</span><span class="identifier">prev_cluster_assignment</span> <span class="relational-operator">==</span> <span class="identifier">cluster_assignment</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">all</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">break</span>

        <span class="comment"># Print number of new assignments</span>
        <span class="keyword">if</span> <span class="identifier">prev_cluster_assignment</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">num_changed</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">prev_cluster_assignment</span> <span class="relational-operator">!=</span> <span class="identifier">cluster_assignment</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">verbose</span><span class="punctuation">:</span>
                <span class="identifier">print</span><span class="grouping">(</span>
                    <span class="string-literal">"    {:5d} elements changed their cluster assignment."</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span>
                        <span class="identifier">num_changed</span>
                    <span class="grouping">)</span>
                <span class="grouping">)</span>

        <span class="comment"># Record heterogeneity convergence metric</span>
        <span class="keyword">if</span> <span class="identifier">record_heterogeneity</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="comment"># YOUR CODE HERE</span>
            <span class="identifier">score</span> <span class="arithmetic-assignment">=</span> <span class="identifier">compute_heterogeneity</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">centroids</span><span class="punctuation">,</span> <span class="identifier">cluster_assignment</span><span class="grouping">)</span>
            <span class="identifier">record_heterogeneity</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">score</span><span class="grouping">)</span>

        <span class="identifier">prev_cluster_assignment</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cluster_assignment</span><span class="grouping">[</span><span class="punctuation">:</span><span class="grouping">]</span>

    <span class="keyword">return</span> <span class="identifier">centroids</span><span class="punctuation">,</span> <span class="identifier">cluster_assignment</span>


<span class="comment"># Mock test below</span>
<span class="keyword">if</span> <span class="bool-literal">False</span><span class="punctuation">:</span>  <span class="comment"># change to true to run this test case.</span>
    <span class="keyword">from</span> <span class="identifier">sklearn</span> <span class="keyword">import</span> <span class="identifier">datasets</span> <span class="keyword">as</span> <span class="identifier">ds</span>

    <span class="identifier">dataset</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ds</span><span class="punctuation">.</span><span class="identifier">load_iris</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">k</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">3</span>
    <span class="identifier">heterogeneity</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
    <span class="identifier">initial_centroids</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_initial_centroids</span><span class="grouping">(</span><span class="identifier">dataset</span><span class="grouping">[</span><span class="string-literal">"data"</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">seed</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
    <span class="identifier">centroids</span><span class="punctuation">,</span> <span class="identifier">cluster_assignment</span> <span class="arithmetic-assignment">=</span> <span class="identifier">kmeans</span><span class="grouping">(</span>
        <span class="identifier">dataset</span><span class="grouping">[</span><span class="string-literal">"data"</span><span class="grouping">]</span><span class="punctuation">,</span>
        <span class="identifier">k</span><span class="punctuation">,</span>
        <span class="identifier">initial_centroids</span><span class="punctuation">,</span>
        <span class="identifier">maxiter</span><span class="arithmetic-assignment">=</span><span class="int-literal">400</span><span class="punctuation">,</span>
        <span class="identifier">record_heterogeneity</span><span class="arithmetic-assignment">=</span><span class="identifier">heterogeneity</span><span class="punctuation">,</span>
        <span class="identifier">verbose</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span>
    <span class="grouping">)</span>
    <span class="identifier">plot_heterogeneity</span><span class="grouping">(</span><span class="identifier">heterogeneity</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">ReportGenerator</span><span class="grouping">(</span>
    <span class="identifier">df</span><span class="punctuation">:</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">DataFrame</span><span class="punctuation">,</span> <span class="identifier">ClusteringVariables</span><span class="punctuation">:</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">ndarray</span><span class="punctuation">,</span> <span class="identifier">FillMissingReport</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">DataFrame</span><span class="punctuation">:</span>
    <span class="comment">"""
    Function generates easy-erading clustering report. It takes 2 arguments as an input:
        DataFrame - dataframe with predicted cluester column;
        FillMissingReport - dictionary of rules how we are going to fill missing
        values of for final report generate (not included in modeling);
    in order to run the function following libraries must be imported:
        import pandas as pd
        import numpy as np
    &gt;&gt;&gt; data = pd.DataFrame()
    &gt;&gt;&gt; data['numbers'] = [1, 2, 3]
    &gt;&gt;&gt; data['col1'] = [0.5, 2.5, 4.5]
    &gt;&gt;&gt; data['col2'] = [100, 200, 300]
    &gt;&gt;&gt; data['col3'] = [10, 20, 30]
    &gt;&gt;&gt; data['Cluster'] = [1, 1, 2]
    &gt;&gt;&gt; ReportGenerator(data, ['col1', 'col2'], 0)
               Features               Type   Mark           1           2
    0    # of Customers        ClusterSize  False    2.000000    1.000000
    1    % of Customers  ClusterProportion  False    0.666667    0.333333
    2              col1    mean_with_zeros   True    1.500000    4.500000
    3              col2    mean_with_zeros   True  150.000000  300.000000
    4           numbers    mean_with_zeros  False    1.500000    3.000000
    ..              ...                ...    ...         ...         ...
    99            dummy                 5%  False    1.000000    1.000000
    100           dummy                95%  False    1.000000    1.000000
    101           dummy              stdev  False    0.000000         NaN
    102           dummy               mode  False    1.000000    1.000000
    103           dummy             median  False    1.000000    1.000000
    &lt;BLANKLINE&gt;
    [104 rows x 5 columns]
    """</span>
    <span class="comment"># Fill missing values with given rules</span>
    <span class="keyword">if</span> <span class="identifier">FillMissingReport</span><span class="punctuation">:</span>
        <span class="identifier">df</span><span class="punctuation">.</span><span class="identifier">fillna</span><span class="grouping">(</span><span class="identifier">value</span><span class="arithmetic-assignment">=</span><span class="identifier">FillMissingReport</span><span class="punctuation">,</span> <span class="identifier">inplace</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
    <span class="identifier">df</span><span class="grouping">[</span><span class="string-literal">"dummy"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">1</span>
    <span class="identifier">numeric_cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">df</span><span class="punctuation">.</span><span class="identifier">select_dtypes</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">number</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">columns</span>
    <span class="identifier">report</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span>
        <span class="identifier">df</span><span class="punctuation">.</span><span class="identifier">groupby</span><span class="grouping">(</span><span class="grouping">[</span><span class="string-literal">"Cluster"</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">[</span>  <span class="comment"># construct report dataframe</span>
            <span class="identifier">numeric_cols</span>
        <span class="grouping">]</span>  <span class="comment"># group by cluster number</span>
        <span class="punctuation">.</span><span class="identifier">agg</span><span class="grouping">(</span>
            <span class="grouping">[</span>
                <span class="grouping">(</span><span class="string-literal">"sum"</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"mean_with_zeros"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">nan_to_num</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"mean_without_zeros"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">NaN</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span>
                    <span class="string-literal">"mean_25-75"</span><span class="punctuation">,</span>
                    <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span>
                        <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">nan_to_num</span><span class="grouping">(</span>
                            <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span><span class="grouping">[</span>
                                <span class="identifier">round</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="int-literal">25</span> <span class="arithmetic-operator">/</span> <span class="int-literal">100</span><span class="grouping">)</span> <span class="punctuation">:</span> <span class="identifier">round</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="int-literal">75</span> <span class="arithmetic-operator">/</span> <span class="int-literal">100</span><span class="grouping">)</span>
                            <span class="grouping">]</span>
                        <span class="grouping">)</span>
                    <span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"mean_with_na"</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"min"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">min</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"5%"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">quantile</span><span class="grouping">(</span><span class="float-literal">0.05</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"25%"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">quantile</span><span class="grouping">(</span><span class="float-literal">0.25</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"50%"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">quantile</span><span class="grouping">(</span><span class="float-literal">0.50</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"75%"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">quantile</span><span class="grouping">(</span><span class="float-literal">0.75</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"95%"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">quantile</span><span class="grouping">(</span><span class="float-literal">0.95</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"max"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">max</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"count"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">count</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"stdev"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">std</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"mode"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">mode</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"median"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">median</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="grouping">(</span><span class="string-literal">"# &gt; 0"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="grouping">(</span><span class="identifier">x</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
            <span class="grouping">]</span>
        <span class="grouping">)</span>
        <span class="punctuation">.</span><span class="identifier">T</span><span class="punctuation">.</span><span class="identifier">reset_index</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="punctuation">.</span><span class="identifier">rename</span><span class="grouping">(</span><span class="identifier">index</span><span class="arithmetic-assignment">=</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">columns</span><span class="arithmetic-assignment">=</span><span class="grouping">{</span><span class="string-literal">"level_0": "Features", "level_1": "Type"</span><span class="grouping">}</span><span class="grouping">)</span>
    <span class="grouping">)</span>  <span class="comment"># rename columns</span>
    <span class="comment"># calculate the size of cluster(count of clientID's)</span>
    <span class="identifier">clustersize</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="grouping">[</span>
        <span class="grouping">(</span><span class="identifier">report</span><span class="grouping">[</span><span class="string-literal">"Features"] == "dummy") & (report["Type"] == "count"</span><span class="grouping">)</span>
    <span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">copy</span><span class="grouping">(</span><span class="grouping">)</span>  <span class="comment"># avoid SettingWithCopyWarning</span>
    <span class="identifier">clustersize</span><span class="punctuation">.</span><span class="identifier">Type</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span>
        <span class="string-literal">"ClusterSize"</span>  <span class="comment"># rename created cluster df to match report column names</span>
    <span class="grouping">)</span>
    <span class="identifier">clustersize</span><span class="punctuation">.</span><span class="identifier">Features</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"# of Customers"</span>
    <span class="identifier">clusterproportion</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">DataFrame</span><span class="grouping">(</span>
        <span class="identifier">clustersize</span><span class="punctuation">.</span><span class="identifier">iloc</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">values</span>
        <span class="arithmetic-operator">/</span> <span class="identifier">clustersize</span><span class="punctuation">.</span><span class="identifier">iloc</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">values</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="grouping">)</span>  <span class="comment"># calculating the proportion of cluster</span>
    <span class="grouping">)</span>
    <span class="identifier">clusterproportion</span><span class="grouping">[</span>
        <span class="string-literal">"Type"</span>
    <span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"% of Customers"</span>  <span class="comment"># rename created cluster df to match report column names</span>
    <span class="identifier">clusterproportion</span><span class="grouping">[</span><span class="string-literal">"Features"] = "ClusterProportion"</span>
    <span class="identifier">cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">clusterproportion</span><span class="punctuation">.</span><span class="identifier">columns</span><span class="punctuation">.</span><span class="identifier">tolist</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cols</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">cols</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">2</span><span class="grouping">]</span>
    <span class="identifier">clusterproportion</span> <span class="arithmetic-assignment">=</span> <span class="identifier">clusterproportion</span><span class="grouping">[</span><span class="identifier">cols</span><span class="grouping">]</span>  <span class="comment"># rearrange columns to match report</span>
    <span class="identifier">clusterproportion</span><span class="punctuation">.</span><span class="identifier">columns</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">columns</span>
    <span class="identifier">a</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">DataFrame</span><span class="grouping">(</span>
        <span class="identifier">abs</span><span class="grouping">(</span>
            <span class="identifier">report</span><span class="grouping">[</span><span class="identifier">report</span><span class="grouping">[</span><span class="string-literal">"Type"] == "count"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">iloc</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">values</span>
            <span class="arithmetic-operator">-</span> <span class="identifier">clustersize</span><span class="punctuation">.</span><span class="identifier">iloc</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">values</span>
        <span class="grouping">)</span>
    <span class="grouping">)</span>  <span class="comment"># generating df with count of nan values</span>
    <span class="identifier">a</span><span class="grouping">[</span><span class="string-literal">"Features"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">0</span>
    <span class="identifier">a</span><span class="grouping">[</span><span class="string-literal">"Type"] = "# of nan"</span>
    <span class="identifier">a</span><span class="punctuation">.</span><span class="identifier">Features</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="grouping">[</span>
        <span class="identifier">report</span><span class="grouping">[</span><span class="string-literal">"Type"] == "count"</span>
    <span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">Features</span><span class="punctuation">.</span><span class="identifier">tolist</span><span class="grouping">(</span><span class="grouping">)</span>  <span class="comment"># filling values in order to match report</span>
    <span class="identifier">cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">a</span><span class="punctuation">.</span><span class="identifier">columns</span><span class="punctuation">.</span><span class="identifier">tolist</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cols</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">cols</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">2</span><span class="grouping">]</span>
    <span class="identifier">a</span> <span class="arithmetic-assignment">=</span> <span class="identifier">a</span><span class="grouping">[</span><span class="identifier">cols</span><span class="grouping">]</span>  <span class="comment"># rearrange columns to match report</span>
    <span class="identifier">a</span><span class="punctuation">.</span><span class="identifier">columns</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">columns</span>  <span class="comment"># rename columns to match report</span>
    <span class="identifier">report</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">drop</span><span class="grouping">(</span>
        <span class="identifier">report</span><span class="grouping">[</span><span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">Type</span> <span class="relational-operator">==</span> <span class="string-literal">"count"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">index</span>
    <span class="grouping">)</span>  <span class="comment"># drop count values except cluster size</span>
    <span class="identifier">report</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">concat</span><span class="grouping">(</span>
        <span class="grouping">[</span><span class="identifier">report</span><span class="punctuation">,</span> <span class="identifier">a</span><span class="punctuation">,</span> <span class="identifier">clustersize</span><span class="punctuation">,</span> <span class="identifier">clusterproportion</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span>
    <span class="grouping">)</span>  <span class="comment"># concat report with clustert size and nan values</span>
    <span class="identifier">report</span><span class="grouping">[</span><span class="string-literal">"Mark"] = report["Features"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">isin</span><span class="grouping">(</span><span class="identifier">ClusteringVariables</span><span class="grouping">)</span>
    <span class="identifier">cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">columns</span><span class="punctuation">.</span><span class="identifier">tolist</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cols</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">:</span><span class="int-literal">2</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">cols</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="punctuation">:</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">cols</span><span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span>
    <span class="identifier">report</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="grouping">[</span><span class="identifier">cols</span><span class="grouping">]</span>
    <span class="identifier">sorter1</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span>
        <span class="string-literal">"ClusterSize"</span><span class="punctuation">:</span> <span class="int-literal">9</span><span class="punctuation">,</span>
        <span class="string-literal">"ClusterProportion"</span><span class="punctuation">:</span> <span class="int-literal">8</span><span class="punctuation">,</span>
        <span class="string-literal">"mean_with_zeros"</span><span class="punctuation">:</span> <span class="int-literal">7</span><span class="punctuation">,</span>
        <span class="string-literal">"mean_with_na"</span><span class="punctuation">:</span> <span class="int-literal">6</span><span class="punctuation">,</span>
        <span class="string-literal">"max"</span><span class="punctuation">:</span> <span class="int-literal">5</span><span class="punctuation">,</span>
        <span class="string-literal">"50%"</span><span class="punctuation">:</span> <span class="int-literal">4</span><span class="punctuation">,</span>
        <span class="string-literal">"min"</span><span class="punctuation">:</span> <span class="int-literal">3</span><span class="punctuation">,</span>
        <span class="string-literal">"25%"</span><span class="punctuation">:</span> <span class="int-literal">2</span><span class="punctuation">,</span>
        <span class="string-literal">"75%"</span><span class="punctuation">:</span> <span class="int-literal">1</span><span class="punctuation">,</span>
        <span class="string-literal">"# of nan"</span><span class="punctuation">:</span> <span class="int-literal">0</span><span class="punctuation">,</span>
        <span class="string-literal">"# &gt; 0"</span><span class="punctuation">:</span> <span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="punctuation">,</span>
        <span class="string-literal">"sum_with_na"</span><span class="punctuation">:</span> <span class="arithmetic-operator">-</span><span class="int-literal">2</span><span class="punctuation">,</span>
    <span class="grouping">}</span>
    <span class="identifier">report</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span>
        <span class="identifier">report</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">i</span><span class="invalid">g</span><span class="invalid">n</span><span class="grouping">(</span>
            <span class="identifier">Sorter1</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span><span class="punctuation">.</span><span class="identifier">Type</span><span class="punctuation">.</span><span class="identifier">map</span><span class="grouping">(</span><span class="identifier">sorter1</span><span class="grouping">)</span><span class="punctuation">,</span>
            <span class="identifier">Sorter2</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">reversed</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">x</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
        <span class="grouping">)</span>
        <span class="punctuation">.</span><span class="identifier">sort_values</span><span class="grouping">(</span><span class="grouping">[</span><span class="string-literal">"Sorter1", "Mark", "Sorter2"</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">c</span><span class="invalid">e</span><span class="invalid">n</span><span class="invalid">d</span><span class="invalid">i</span><span class="invalid">n</span><span class="invalid">g</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
        <span class="punctuation">.</span><span class="identifier">drop</span><span class="grouping">(</span><span class="grouping">[</span><span class="string-literal">"Sorter1", "Sorter2"</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>
    <span class="grouping">)</span>
    <span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">columns</span><span class="punctuation">.</span><span class="identifier">name</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>
    <span class="identifier">report</span> <span class="arithmetic-assignment">=</span> <span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">reset_index</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">report</span><span class="punctuation">.</span><span class="identifier">drop</span><span class="grouping">(</span><span class="identifier">columns</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="string-literal">"index"</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">inplace</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">report</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="relational-operator">==</span> <span class="string-literal">"__main__"</span><span class="punctuation">:</span>
    <span class="keyword">import</span> <span class="identifier">doctest</span>

    <span class="identifier">doctest</span><span class="punctuation">.</span><span class="identifier">testmod</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>