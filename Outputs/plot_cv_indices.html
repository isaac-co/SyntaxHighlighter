<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
Visualizing cross-validation behavior in scikit-learn
=====================================================

Choosing the right cross-validation object is a crucial part of fitting a
model properly. There are many ways to split data into training and test
sets in order to avoid model overfitting, to standardize the number of
groups in test sets, etc.

This example visualizes the behavior of several common scikit-learn objects
for comparison.
"""</span>

<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">model_selection</span> <span class="keyword">import</span> <span class="grouping">(</span><span class="identifier">TimeSeriesSplit</span><span class="punctuation">,</span> <span class="identifier">KFold</span><span class="punctuation">,</span> <span class="identifier">ShuffleSplit</span><span class="punctuation">,</span>
                                     <span class="identifier">StratifiedKFold</span><span class="punctuation">,</span> <span class="identifier">GroupShuffleSplit</span><span class="punctuation">,</span>
                                     <span class="identifier">GroupKFold</span><span class="punctuation">,</span> <span class="identifier">StratifiedShuffleSplit</span><span class="punctuation">,</span>
                                     <span class="identifier">StratifiedGroupKFold</span><span class="grouping">)</span>
<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="keyword">from</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">patches</span> <span class="keyword">import</span> <span class="identifier">Patch</span>
<span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">seed</span><span class="grouping">(</span><span class="int-literal">1338</span><span class="grouping">)</span>
<span class="identifier">cmap_data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">Paired</span>
<span class="identifier">cmap_cv</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">coolwarm</span>
<span class="identifier">n_splits</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">4</span>

<span class="comment"># %%</span>
<span class="comment"># Visualize our data</span>
<span class="comment"># ------------------</span>
<span class="comment">#</span>
<span class="comment"># First, we must understand the structure of our data. It has 100 randomly</span>
<span class="comment"># generated input datapoints, 3 classes split unevenly across datapoints,</span>
<span class="comment"># and 10 "groups" split evenly across datapoints.</span>
<span class="comment">#</span>
<span class="comment"># As we'll see, some cross-validation objects do specific things with</span>
<span class="comment"># labeled data, others behave differently with grouped data, and others</span>
<span class="comment"># do not use this information.</span>
<span class="comment">#</span>
<span class="comment"># To begin, we'll visualize our data.</span>

<span class="comment"># Generate the class/group data</span>
<span class="identifier">n_points</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">100</span>
<span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randn</span><span class="grouping">(</span><span class="int-literal">100</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="grouping">)</span>

<span class="identifier">percentiles_classes</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="float-literal">.1</span><span class="punctuation">,</span> <span class="float-literal">.3</span><span class="punctuation">,</span> <span class="float-literal">.6</span><span class="grouping">]</span>
<span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">hstack</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">[</span><span class="identifier">ii</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="identifier">int</span><span class="grouping">(</span><span class="int-literal">100</span> <span class="arithmetic-operator">*</span> <span class="identifier">perc</span><span class="grouping">)</span>
               <span class="keyword">for</span> <span class="identifier">ii</span><span class="punctuation">,</span> <span class="identifier">perc</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">percentiles_classes</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">)</span>

<span class="comment"># Evenly spaced groups repeated once</span>
<span class="identifier">groups</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">hstack</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">[</span><span class="identifier">ii</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="int-literal">10</span> <span class="keyword">for</span> <span class="identifier">ii</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">10</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">visualize_groups</span><span class="grouping">(</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">e</span><span class="invalid">s</span><span class="punctuation">,</span> <span class="identifier">groups</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment"># Visualize dataset groups</span>
    <span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">groups</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>  <span class="grouping">[</span><span class="float-literal">.5</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">groups</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">c</span><span class="arithmetic-assignment">=</span><span class="identifier">groups</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'_'</span><span class="punctuation">,</span>
               <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="int-literal">50</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_data</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">groups</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>  <span class="grouping">[</span><span class="float-literal">3.5</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">groups</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">c</span><span class="arithmetic-assignment">=</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">e</span><span class="invalid">s</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'_'</span><span class="punctuation">,</span>
               <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="int-literal">50</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_data</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">ylim</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">yticks</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="float-literal">.5</span><span class="punctuation">,</span> <span class="float-literal">3.5</span><span class="grouping">]</span><span class="punctuation">,</span>
           <span class="identifier">yticklabels</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="string-literal">'Data\ngroup', 'Data\nclass'</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">xlabel</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Sample index"</span><span class="grouping">)</span>


<span class="identifier">visualize_groups</span><span class="grouping">(</span><span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">groups</span><span class="punctuation">,</span> <span class="string-literal">'no groups'</span><span class="grouping">)</span>

<span class="comment"># %%</span>
<span class="comment"># Define a function to visualize cross-validation behavior</span>
<span class="comment"># --------------------------------------------------------</span>
<span class="comment">#</span>
<span class="comment"># We'll define a function that lets us visualize the behavior of each</span>
<span class="comment"># cross-validation object. We'll perform 4 splits of the data. On each</span>
<span class="comment"># split, we'll visualize the indices chosen for the training set</span>
<span class="comment"># (in blue) and the test set (in red).</span>


<span class="keyword">def</span> <span class="identifier">plot_cv_indices</span><span class="grouping">(</span><span class="identifier">cv</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">group</span><span class="punctuation">,</span> <span class="identifier">ax</span><span class="punctuation">,</span> <span class="identifier">n_splits</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="int-literal">10</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Create a sample plot for indices of a cross-validation object."""</span>

    <span class="comment"># Generate the training/testing visualizations for each CV split</span>
    <span class="keyword">for</span> <span class="identifier">ii</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="identifier">tr</span><span class="punctuation">,</span> <span class="identifier">tt</span><span class="grouping">)</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">cv</span><span class="punctuation">.</span><span class="identifier">split</span><span class="grouping">(</span><span class="identifier">X</span><span class="arithmetic-assignment">=</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="arithmetic-assignment">=</span><span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">groups</span><span class="arithmetic-assignment">=</span><span class="identifier">group</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment"># Fill in indices with the training/test groups</span>
        <span class="identifier">indices</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">nan</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">indices</span><span class="grouping">[</span><span class="identifier">tt</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">1</span>
        <span class="identifier">indices</span><span class="grouping">[</span><span class="identifier">tr</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">0</span>

        <span class="comment"># Visualize the results</span>
        <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">indices</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="identifier">ii</span> <span class="arithmetic-operator">+</span> <span class="float-literal">.5</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">indices</span><span class="grouping">)</span><span class="punctuation">,</span>
                   <span class="identifier">c</span><span class="arithmetic-assignment">=</span><span class="identifier">indices</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'_'</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="identifier">lw</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_cv</span><span class="punctuation">,</span>
                   <span class="identifier">vmin</span><span class="arithmetic-assignment">=</span><span class="float-literal">-.2</span><span class="punctuation">,</span> <span class="identifier">vmax</span><span class="arithmetic-assignment">=</span><span class="float-literal">1.2</span><span class="grouping">)</span>

    <span class="comment"># Plot the data classes and groups at the end</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="identifier">ii</span> <span class="arithmetic-operator">+</span> <span class="float-literal">1.5</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span><span class="punctuation">,</span>
               <span class="identifier">c</span><span class="arithmetic-assignment">=</span><span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'_'</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="identifier">lw</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_data</span><span class="grouping">)</span>

    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="identifier">ii</span> <span class="arithmetic-operator">+</span> <span class="float-literal">2.5</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span><span class="punctuation">,</span>
               <span class="identifier">c</span><span class="arithmetic-assignment">=</span><span class="identifier">group</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'_'</span><span class="punctuation">,</span> <span class="identifier">lw</span><span class="arithmetic-assignment">=</span><span class="identifier">lw</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_data</span><span class="grouping">)</span>

    <span class="comment"># Formatting</span>
    <span class="identifier">yticklabels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_splits</span><span class="grouping">)</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="grouping">[</span><span class="string-literal">'class', 'group'</span><span class="grouping">]</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">yticks</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arange</span><span class="grouping">(</span><span class="identifier">n_splits</span><span class="arithmetic-operator">+</span><span class="int-literal">2</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="float-literal">.5</span><span class="punctuation">,</span> <span class="identifier">yticklabels</span><span class="arithmetic-assignment">=</span><span class="identifier">yticklabels</span><span class="punctuation">,</span>
           <span class="identifier">xlabel</span><span class="arithmetic-assignment">=</span><span class="string-literal">'Sample index'</span><span class="punctuation">,</span> <span class="identifier">ylabel</span><span class="arithmetic-assignment">=</span><span class="string-literal">"CV iteration"</span><span class="punctuation">,</span>
           <span class="identifier">ylim</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="identifier">n_splits</span><span class="float-literal">+2.2</span><span class="punctuation">,</span> <span class="float-literal">-.2</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">xlim</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">100</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_title</span><span class="grouping">(</span><span class="string-literal">'{}'</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">type</span><span class="grouping">(</span><span class="identifier">cv</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">fontsize</span><span class="arithmetic-assignment">=</span><span class="int-literal">15</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">ax</span>


<span class="comment"># %%</span>
<span class="comment"># Let's see how it looks for the :class:`~sklearn.model_selection.KFold`</span>
<span class="comment"># cross-validation object:</span>

<span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">cv</span> <span class="arithmetic-assignment">=</span> <span class="identifier">KFold</span><span class="grouping">(</span><span class="identifier">n_splits</span><span class="grouping">)</span>
<span class="identifier">plot_cv_indices</span><span class="grouping">(</span><span class="identifier">cv</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">groups</span><span class="punctuation">,</span> <span class="identifier">ax</span><span class="punctuation">,</span> <span class="identifier">n_splits</span><span class="grouping">)</span>

<span class="comment"># %%</span>
<span class="comment"># As you can see, by default the KFold cross-validation iterator does not</span>
<span class="comment"># take either datapoint class or group into consideration. We can change this</span>
<span class="comment"># by using either:</span>
<span class="comment">#</span>
<span class="comment"># - ``StratifiedKFold`` to preserve the percentage of samples for each class.</span>
<span class="comment"># - ``GroupKFold`` to ensure that the same group will not appear in two</span>
<span class="comment">#   different folds.</span>
<span class="comment"># - ``StratifiedGroupKFold`` to keep the constraint of ``GroupKFold`` while</span>
<span class="comment">#   attempting to return stratified folds.</span>

<span class="comment"># To better demonstrate the difference, we will assign samples to groups</span>
<span class="comment"># unevenly:</span>

<span class="identifier">uneven_groups</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sort</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randint</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="punctuation">,</span> <span class="identifier">n_points</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">cvs</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">StratifiedKFold</span><span class="punctuation">,</span> <span class="identifier">GroupKFold</span><span class="punctuation">,</span> <span class="identifier">StratifiedGroupKFold</span><span class="grouping">]</span>

<span class="keyword">for</span> <span class="identifier">cv</span> <span class="relational-operator">in</span> <span class="identifier">cvs</span><span class="punctuation">:</span>
    <span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">plot_cv_indices</span><span class="grouping">(</span><span class="identifier">cv</span><span class="grouping">(</span><span class="identifier">n_splits</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">uneven_groups</span><span class="punctuation">,</span> <span class="identifier">ax</span><span class="punctuation">,</span> <span class="identifier">n_splits</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">legend</span><span class="grouping">(</span><span class="grouping">[</span><span class="identifier">Patch</span><span class="grouping">(</span><span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_cv</span><span class="grouping">(</span><span class="float-literal">.8</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">Patch</span><span class="grouping">(</span><span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_cv</span><span class="grouping">(</span><span class="float-literal">.02</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="string-literal">'Testing set', 'Training set'</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">loc</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="float-literal">1.02</span><span class="punctuation">,</span> <span class="float-literal">.8</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="comment"># Make the legend fit</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">tight_layout</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">fig</span><span class="punctuation">.</span><span class="identifier">subplots_adjust</span><span class="grouping">(</span><span class="identifier">right</span><span class="arithmetic-assignment">=</span><span class="float-literal">.7</span><span class="grouping">)</span>

<span class="comment"># %%</span>
<span class="comment"># Next we'll visualize this behavior for a number of CV iterators.</span>
<span class="comment">#</span>
<span class="comment"># Visualize cross-validation indices for many CV objects</span>
<span class="comment"># ------------------------------------------------------</span>
<span class="comment">#</span>
<span class="comment"># Let's visually compare the cross validation behavior for many</span>
<span class="comment"># scikit-learn cross-validation objects. Below we will loop through several</span>
<span class="comment"># common cross-validation objects, visualizing the behavior of each.</span>
<span class="comment">#</span>
<span class="comment"># Note how some use the group/class information while others do not.</span>

<span class="identifier">cvs</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">KFold</span><span class="punctuation">,</span> <span class="identifier">GroupKFold</span><span class="punctuation">,</span> <span class="identifier">ShuffleSplit</span><span class="punctuation">,</span> <span class="identifier">StratifiedKFold</span><span class="punctuation">,</span> <span class="identifier">StratifiedGroupKFold</span><span class="punctuation">,</span>
       <span class="identifier">GroupShuffleSplit</span><span class="punctuation">,</span> <span class="identifier">StratifiedShuffleSplit</span><span class="punctuation">,</span> <span class="identifier">TimeSeriesSplit</span><span class="grouping">]</span>


<span class="keyword">for</span> <span class="identifier">cv</span> <span class="relational-operator">in</span> <span class="identifier">cvs</span><span class="punctuation">:</span>
    <span class="identifier">this_cv</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cv</span><span class="grouping">(</span><span class="identifier">n_splits</span><span class="arithmetic-assignment">=</span><span class="identifier">n_splits</span><span class="grouping">)</span>
    <span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">plot_cv_indices</span><span class="grouping">(</span><span class="identifier">this_cv</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">groups</span><span class="punctuation">,</span> <span class="identifier">ax</span><span class="punctuation">,</span> <span class="identifier">n_splits</span><span class="grouping">)</span>

    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">legend</span><span class="grouping">(</span><span class="grouping">[</span><span class="identifier">Patch</span><span class="grouping">(</span><span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_cv</span><span class="grouping">(</span><span class="float-literal">.8</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">Patch</span><span class="grouping">(</span><span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap_cv</span><span class="grouping">(</span><span class="float-literal">.02</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
              <span class="grouping">[</span><span class="string-literal">'Testing set', 'Training set'</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">loc</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="float-literal">1.02</span><span class="punctuation">,</span> <span class="float-literal">.8</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="comment"># Make the legend fit</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">tight_layout</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">fig</span><span class="punctuation">.</span><span class="identifier">subplots_adjust</span><span class="grouping">(</span><span class="identifier">right</span><span class="arithmetic-assignment">=</span><span class="float-literal">.7</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>