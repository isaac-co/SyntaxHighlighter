<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
========================================================================
Concentration Prior Type Analysis of Variation Bayesian Gaussian Mixture
========================================================================

This example plots the ellipsoids obtained from a toy dataset (mixture of three
Gaussians) fitted by the ``BayesianGaussianMixture`` class models with a
Dirichlet distribution prior
(``weight_concentration_prior_type='dirichlet_distribution'``) and a Dirichlet
process prior (``weight_concentration_prior_type='dirichlet_process'``). On
each figure, we plot the results for three different values of the weight
concentration prior.

The ``BayesianGaussianMixture`` class can adapt its number of mixture
components automatically. The parameter ``weight_concentration_prior`` has a
direct link with the resulting number of components with non-zero weights.
Specifying a low value for the concentration prior will make the model put most
of the weight on few components set the remaining components weights very close
to zero. High values of the concentration prior will allow a larger number of
components to be active in the mixture.

The Dirichlet process prior allows to define an infinite number of components
and automatically selects the correct number of components: it activates a
component only if it is necessary.

On the contrary the classical finite mixture model with a Dirichlet
distribution prior will favor more uniformly weighted components and therefore
tends to divide natural clusters into unnecessary sub-components.
"""</span>
<span class="comment"># Author: Thierry Guillemot &lt;thierry.guillemot.work@gmail.com&gt;</span>
<span class="comment"># License: BSD 3 clause</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span> <span class="keyword">as</span> <span class="identifier">mpl</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">gridspec</span> <span class="keyword">as</span> <span class="identifier">gridspec</span>

<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">mixture</span> <span class="keyword">import</span> <span class="identifier">BayesianGaussianMixture</span>

<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">__doc__</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">plot_ellipses</span><span class="grouping">(</span><span class="identifier">ax</span><span class="punctuation">,</span> <span class="identifier">weights</span><span class="punctuation">,</span> <span class="identifier">means</span><span class="punctuation">,</span> <span class="identifier">covars</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="keyword">for</span> <span class="identifier">n</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">means</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">eig_vals</span><span class="punctuation">,</span> <span class="identifier">eig_vecs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linalg</span><span class="punctuation">.</span><span class="identifier">eigh</span><span class="grouping">(</span><span class="identifier">covars</span><span class="grouping">[</span><span class="identifier">n</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">unit_eig_vec</span> <span class="arithmetic-assignment">=</span> <span class="identifier">eig_vecs</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span> <span class="arithmetic-operator">/</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linalg</span><span class="punctuation">.</span><span class="identifier">norm</span><span class="grouping">(</span><span class="identifier">eig_vecs</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">angle</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arctan2</span><span class="grouping">(</span><span class="identifier">unit_eig_vec</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">unit_eig_vec</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="comment"># Ellipse needs degrees</span>
        <span class="identifier">angle</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">180</span> <span class="arithmetic-operator">*</span> <span class="identifier">angle</span> <span class="arithmetic-operator">/</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">pi</span>
        <span class="comment"># eigenvector normalization</span>
        <span class="identifier">eig_vals</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sqrt</span><span class="grouping">(</span><span class="int-literal">2</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sqrt</span><span class="grouping">(</span><span class="identifier">eig_vals</span><span class="grouping">)</span>
        <span class="identifier">ell</span> <span class="arithmetic-assignment">=</span> <span class="identifier">mpl</span><span class="punctuation">.</span><span class="identifier">patches</span><span class="punctuation">.</span><span class="identifier">Ellipse</span><span class="grouping">(</span><span class="identifier">means</span><span class="grouping">[</span><span class="identifier">n</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">eig_vals</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">eig_vals</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span>
                                  <span class="int-literal">180</span> <span class="arithmetic-operator">+</span> <span class="identifier">angle</span><span class="punctuation">,</span> <span class="identifier">edgecolor</span><span class="arithmetic-assignment">=</span><span class="string-literal">'black'</span><span class="grouping">)</span>
        <span class="identifier">ell</span><span class="punctuation">.</span><span class="identifier">set_clip_box</span><span class="grouping">(</span><span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">bbox</span><span class="grouping">)</span>
        <span class="identifier">ell</span><span class="punctuation">.</span><span class="identifier">set_alpha</span><span class="grouping">(</span><span class="identifier">weights</span><span class="grouping">[</span><span class="identifier">n</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">ell</span><span class="punctuation">.</span><span class="identifier">set_facecolor</span><span class="grouping">(</span><span class="string-literal">'#56B4E9'</span><span class="grouping">)</span>
        <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">add_artist</span><span class="grouping">(</span><span class="identifier">ell</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">plot_results</span><span class="grouping">(</span><span class="identifier">ax1</span><span class="punctuation">,</span> <span class="identifier">ax2</span><span class="punctuation">,</span> <span class="identifier">estimator</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">title</span><span class="punctuation">,</span> <span class="identifier">plot_title</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">ax1</span><span class="punctuation">.</span><span class="identifier">set_title</span><span class="grouping">(</span><span class="identifier">title</span><span class="grouping">)</span>
    <span class="identifier">ax1</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">s</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'o'</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="identifier">colors</span><span class="grouping">[</span><span class="identifier">y</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">alpha</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.8</span><span class="grouping">)</span>
    <span class="identifier">ax1</span><span class="punctuation">.</span><span class="identifier">set_xlim</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">2</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">.</span><span class="grouping">)</span>
    <span class="identifier">ax1</span><span class="punctuation">.</span><span class="identifier">set_ylim</span><span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">3</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">.</span><span class="grouping">)</span>
    <span class="identifier">ax1</span><span class="punctuation">.</span><span class="identifier">set_xticks</span><span class="grouping">(</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">ax1</span><span class="punctuation">.</span><span class="identifier">set_yticks</span><span class="grouping">(</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">plot_ellipses</span><span class="grouping">(</span><span class="identifier">ax1</span><span class="punctuation">,</span> <span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">weights_</span><span class="punctuation">,</span> <span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="punctuation">,</span>
                  <span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">covariances_</span><span class="grouping">)</span>

    <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">get_xaxis</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">set_tick_params</span><span class="grouping">(</span><span class="identifier">direction</span><span class="arithmetic-assignment">=</span><span class="string-literal">'out'</span><span class="grouping">)</span>
    <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">yaxis</span><span class="punctuation">.</span><span class="identifier">grid</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">alpha</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.7</span><span class="grouping">)</span>
    <span class="keyword">for</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">w</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">weights_</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">bar</span><span class="grouping">(</span><span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">w</span><span class="punctuation">,</span> <span class="identifier">width</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.9</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'#56B4E9'</span><span class="punctuation">,</span> <span class="identifier">zorder</span><span class="arithmetic-assignment">=</span><span class="int-literal">3</span><span class="punctuation">,</span>
                <span class="identifier">align</span><span class="arithmetic-assignment">=</span><span class="string-literal">'center', edgecolor='black'</span><span class="grouping">)</span>
        <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span><span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">w</span> <span class="arithmetic-operator">+</span> <span class="float-literal">0.007</span><span class="punctuation">,</span> <span class="string-literal">"%.1f%%"</span> <span class="arithmetic-operator">%</span> <span class="grouping">(</span><span class="identifier">w</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="punctuation">.</span><span class="grouping">)</span><span class="punctuation">,</span>
                 <span class="identifier">horizontalalignment</span><span class="arithmetic-assignment">=</span><span class="string-literal">'center'</span><span class="grouping">)</span>
    <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">set_xlim</span><span class="grouping">(</span><span class="float-literal">-.6</span><span class="punctuation">,</span> <span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">n_components</span> <span class="arithmetic-operator">-</span> <span class="float-literal">.4</span><span class="grouping">)</span>
    <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">set_ylim</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="float-literal">1.1</span><span class="grouping">)</span>
    <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">tick_params</span><span class="grouping">(</span><span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="string-literal">'y', which='both'</span><span class="punctuation">,</span> <span class="identifier">left</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span>
                    <span class="identifier">right</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="identifier">labelleft</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
    <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">tick_params</span><span class="grouping">(</span><span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="string-literal">'x', which='both'</span><span class="punctuation">,</span> <span class="identifier">top</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="identifier">plot_title</span><span class="punctuation">:</span>
        <span class="identifier">ax1</span><span class="punctuation">.</span><span class="identifier">set_ylabel</span><span class="grouping">(</span><span class="string-literal">'Estimated Mixtures'</span><span class="grouping">)</span>
        <span class="identifier">ax2</span><span class="punctuation">.</span><span class="identifier">set_ylabel</span><span class="grouping">(</span><span class="string-literal">'Weight of each component'</span><span class="grouping">)</span>

<span class="comment"># Parameters of the dataset</span>
<span class="identifier">random_state</span><span class="punctuation">,</span> <span class="identifier">n_components</span><span class="punctuation">,</span> <span class="identifier">n_features</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">2</span>
<span class="identifier">colors</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="string-literal">'#0072B2', '#F0E442', '#D55E00'</span><span class="grouping">]</span><span class="grouping">)</span>

<span class="identifier">covars</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">[</span><span class="grouping">[</span><span class="float-literal">.7</span><span class="punctuation">,</span> <span class="float-literal">.0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">.0</span><span class="punctuation">,</span> <span class="float-literal">.1</span><span class="grouping">]</span><span class="grouping">]</span><span class="punctuation">,</span>
                   <span class="grouping">[</span><span class="grouping">[</span><span class="float-literal">.5</span><span class="punctuation">,</span> <span class="float-literal">.0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">.0</span><span class="punctuation">,</span> <span class="float-literal">.1</span><span class="grouping">]</span><span class="grouping">]</span><span class="punctuation">,</span>
                   <span class="grouping">[</span><span class="grouping">[</span><span class="float-literal">.5</span><span class="punctuation">,</span> <span class="float-literal">.0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">.0</span><span class="punctuation">,</span> <span class="float-literal">.1</span><span class="grouping">]</span><span class="grouping">]</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">samples</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="int-literal">200</span><span class="punctuation">,</span> <span class="int-literal">500</span><span class="punctuation">,</span> <span class="int-literal">200</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">means</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">[</span><span class="float-literal">.0</span><span class="punctuation">,</span> <span class="float-literal">-.70</span><span class="grouping">]</span><span class="punctuation">,</span>
                  <span class="grouping">[</span><span class="float-literal">.0</span><span class="punctuation">,</span> <span class="float-literal">.0</span><span class="grouping">]</span><span class="punctuation">,</span>
                  <span class="grouping">[</span><span class="float-literal">.0</span><span class="punctuation">,</span> <span class="float-literal">.70</span><span class="grouping">]</span><span class="grouping">]</span><span class="grouping">)</span>

<span class="comment"># mean_precision_prior= 0.8 to minimize the influence of the prior</span>
<span class="identifier">estimators</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span>
    <span class="grouping">(</span><span class="string-literal">"Finite mixture with a Dirichlet distribution\nprior and "</span>
     <span class="identifier">r</span><span class="string-literal">"$\gamma_0=$"</span><span class="punctuation">,</span> <span class="identifier">BayesianGaussianMixture</span><span class="grouping">(</span>
        <span class="identifier">weight_concentration_prior_type</span><span class="arithmetic-assignment">=</span><span class="string-literal">"dirichlet_distribution"</span><span class="punctuation">,</span>
        <span class="identifier">n_components</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">n_components</span><span class="punctuation">,</span> <span class="identifier">reg_covar</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">init_params</span><span class="arithmetic-assignment">=</span><span class="string-literal">'random'</span><span class="punctuation">,</span>
        <span class="identifier">max_iter</span><span class="arithmetic-assignment">=</span><span class="int-literal">1500</span><span class="punctuation">,</span> <span class="identifier">mean_precision_prior</span><span class="arithmetic-assignment">=</span><span class="float-literal">.8</span><span class="punctuation">,</span>
        <span class="identifier">random_state</span><span class="arithmetic-assignment">=</span><span class="identifier">random_state</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">0.001</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1000</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">,</span>
    <span class="grouping">(</span><span class="string-literal">"Infinite mixture with a Dirichlet process\n prior and" r"$\gamma_0=$"</span><span class="punctuation">,</span>
     <span class="identifier">BayesianGaussianMixture</span><span class="grouping">(</span>
        <span class="identifier">weight_concentration_prior_type</span><span class="arithmetic-assignment">=</span><span class="string-literal">"dirichlet_process"</span><span class="punctuation">,</span>
        <span class="identifier">n_components</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">n_components</span><span class="punctuation">,</span> <span class="identifier">reg_covar</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">init_params</span><span class="arithmetic-assignment">=</span><span class="string-literal">'random'</span><span class="punctuation">,</span>
        <span class="identifier">max_iter</span><span class="arithmetic-assignment">=</span><span class="int-literal">1500</span><span class="punctuation">,</span> <span class="identifier">mean_precision_prior</span><span class="arithmetic-assignment">=</span><span class="float-literal">.8</span><span class="punctuation">,</span>
        <span class="identifier">random_state</span><span class="arithmetic-assignment">=</span><span class="identifier">random_state</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1000</span><span class="punctuation">,</span> <span class="int-literal">100000</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">]</span>

<span class="comment"># Generate data</span>
<span class="identifier">rng</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">RandomState</span><span class="grouping">(</span><span class="identifier">random_state</span><span class="grouping">)</span>
<span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">vstack</span><span class="grouping">(</span><span class="grouping">[</span>
    <span class="identifier">rng</span><span class="punctuation">.</span><span class="identifier">multivariate_normal</span><span class="grouping">(</span><span class="identifier">means</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">covars</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">samples</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="keyword">for</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_components</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">concatenate</span><span class="grouping">(</span><span class="grouping">[</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">full</span><span class="grouping">(</span><span class="identifier">samples</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="grouping">)</span>
                    <span class="keyword">for</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_components</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">)</span>

<span class="comment"># Plot results in two different figures</span>
<span class="keyword">for</span> <span class="grouping">(</span><span class="identifier">title</span><span class="punctuation">,</span> <span class="identifier">estimator</span><span class="punctuation">,</span> <span class="identifier">concentrations_prior</span><span class="grouping">)</span> <span class="relational-operator">in</span> <span class="identifier">estimators</span><span class="punctuation">:</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">figure</span><span class="grouping">(</span><span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="float-literal">4.7</span> <span class="arithmetic-operator">*</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots_adjust</span><span class="grouping">(</span><span class="identifier">bottom</span><span class="arithmetic-assignment">=</span><span class="float-literal">.04</span><span class="punctuation">,</span> <span class="identifier">top</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.90</span><span class="punctuation">,</span> <span class="identifier">hspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">.05</span><span class="punctuation">,</span> <span class="identifier">wspace</span><span class="arithmetic-assignment">=</span><span class="float-literal">.05</span><span class="punctuation">,</span>
                        <span class="identifier">left</span><span class="arithmetic-assignment">=</span><span class="float-literal">.03</span><span class="punctuation">,</span> <span class="identifier">right</span><span class="arithmetic-assignment">=</span><span class="float-literal">.99</span><span class="grouping">)</span>

    <span class="identifier">gs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">gridspec</span><span class="punctuation">.</span><span class="identifier">GridSpec</span><span class="grouping">(</span><span class="int-literal">3</span><span class="punctuation">,</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">concentrations_prior</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">for</span> <span class="identifier">k</span><span class="punctuation">,</span> <span class="identifier">concentration</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">concentrations_prior</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">weight_concentration_prior</span> <span class="arithmetic-assignment">=</span> <span class="identifier">concentration</span>
        <span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
        <span class="identifier">plot_results</span><span class="grouping">(</span><span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="identifier">gs</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">:</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="identifier">gs</span><span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">k</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">estimator</span><span class="punctuation">,</span>
                     <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">r</span><span class="string-literal">"%s$%.1e$"</span> <span class="arithmetic-operator">%</span> <span class="grouping">(</span><span class="identifier">title</span><span class="punctuation">,</span> <span class="identifier">concentration</span><span class="grouping">)</span><span class="punctuation">,</span>
                     <span class="identifier">plot_title</span><span class="arithmetic-assignment">=</span><span class="identifier">k</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="grouping">)</span>

<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>