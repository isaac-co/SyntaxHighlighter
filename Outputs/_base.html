<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
Base IO code for all datasets
"""</span>

<span class="comment"># Copyright (c) 2007 David Cournapeau &lt;cournape@gmail.com&gt;</span>
<span class="comment">#               2010 Fabian Pedregosa &lt;fabian.pedregosa@inria.fr&gt;</span>
<span class="comment">#               2010 Olivier Grisel &lt;olivier.grisel@ensta.org&gt;</span>
<span class="comment"># License: BSD 3 clause</span>
<span class="keyword">import</span> <span class="identifier">csv</span>
<span class="keyword">import</span> <span class="identifier">hashlib</span>
<span class="keyword">import</span> <span class="identifier">os</span>
<span class="keyword">import</span> <span class="identifier">shutil</span>
<span class="keyword">from</span> <span class="identifier">collections</span> <span class="keyword">import</span> <span class="identifier">namedtuple</span>
<span class="keyword">from</span> <span class="identifier">os</span> <span class="keyword">import</span> <span class="identifier">environ</span><span class="punctuation">,</span> <span class="identifier">listdir</span><span class="punctuation">,</span> <span class="identifier">makedirs</span>
<span class="keyword">from</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span> <span class="keyword">import</span> <span class="identifier">dirname</span><span class="punctuation">,</span> <span class="identifier">expanduser</span><span class="punctuation">,</span> <span class="identifier">isdir</span><span class="punctuation">,</span> <span class="identifier">join</span><span class="punctuation">,</span> <span class="identifier">splitext</span>

<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">Bunch</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">check_random_state</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">check_pandas_support</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>

<span class="keyword">from</span> <span class="identifier">urllib</span><span class="punctuation">.</span><span class="identifier">request</span> <span class="keyword">import</span> <span class="identifier">urlretrieve</span>

<span class="identifier">RemoteFileMetadata</span> <span class="arithmetic-assignment">=</span> <span class="identifier">namedtuple</span><span class="grouping">(</span><span class="string-literal">'RemoteFileMetadata'</span><span class="punctuation">,</span>
                                <span class="grouping">[</span><span class="string-literal">'filename', 'url', 'checksum'</span><span class="grouping">]</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">get_data_home</span><span class="grouping">(</span><span class="identifier">data_home</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">str</span><span class="punctuation">:</span>
    <span class="comment">"""Return the path of the scikit-learn data dir.

    This folder is used by some large dataset loaders to avoid downloading the
    data several times.

    By default the data dir is set to a folder named 'scikit_learn_data' in the
    user home folder.

    Alternatively, it can be set by the 'SCIKIT_LEARN_DATA' environment
    variable or programmatically by giving an explicit folder path. The '~'
    symbol is expanded to the user home folder.

    If the folder does not already exist, it is automatically created.

    Parameters
    ----------
    data_home : str, default=None
        The path to scikit-learn data directory. If `None`, the default path
        is `~/sklearn_learn_data`.
    """</span>
    <span class="keyword">if</span> <span class="identifier">data_home</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="identifier">data_home</span> <span class="arithmetic-assignment">=</span> <span class="identifier">environ</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">'SCIKIT_LEARN_DATA'</span><span class="punctuation">,</span>
                                <span class="identifier">join</span><span class="grouping">(</span><span class="string-literal">'~', 'scikit_learn_data'</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">data_home</span> <span class="arithmetic-assignment">=</span> <span class="identifier">expanduser</span><span class="grouping">(</span><span class="identifier">data_home</span><span class="grouping">)</span>
    <span class="identifier">makedirs</span><span class="grouping">(</span><span class="identifier">data_home</span><span class="punctuation">,</span> <span class="identifier">exist_ok</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">data_home</span>


<span class="keyword">def</span> <span class="identifier">clear_data_home</span><span class="grouping">(</span><span class="identifier">data_home</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Delete all the content of the data home cache.

    Parameters
    ----------
    data_home : str, default=None
        The path to scikit-learn data directory. If `None`, the default path
        is `~/sklearn_learn_data`.
    """</span>
    <span class="identifier">data_home</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_data_home</span><span class="grouping">(</span><span class="identifier">data_home</span><span class="grouping">)</span>
    <span class="identifier">shutil</span><span class="punctuation">.</span><span class="identifier">rmtree</span><span class="grouping">(</span><span class="identifier">data_home</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">_convert_data_dataframe</span><span class="grouping">(</span><span class="identifier">caller_name</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span><span class="punctuation">,</span>
                            <span class="identifier">feature_names</span><span class="punctuation">,</span> <span class="identifier">target_names</span><span class="punctuation">,</span> <span class="identifier">sparse_data</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">pd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">check_pandas_support</span><span class="grouping">(</span><span class="string-literal">'{} with as_frame=True'</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">caller_name</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">sparse_data</span><span class="punctuation">:</span>
        <span class="identifier">data_df</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">DataFrame</span><span class="grouping">(</span><span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">columns</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span><span class="grouping">)</span>
    <span class="keyword">else</span><span class="punctuation">:</span>
        <span class="identifier">data_df</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">DataFrame</span><span class="punctuation">.</span><span class="identifier">sparse</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">o</span><span class="invalid">m</span><span class="invalid">_</span><span class="invalid">s</span><span class="invalid">p</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="invalid">r</span><span class="invalid">i</span><span class="invalid">x</span><span class="grouping">(</span>
            <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">columns</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span>
        <span class="grouping">)</span>

    <span class="identifier">target_df</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">DataFrame</span><span class="grouping">(</span><span class="identifier">target</span><span class="punctuation">,</span> <span class="identifier">columns</span><span class="arithmetic-assignment">=</span><span class="identifier">target_names</span><span class="grouping">)</span>
    <span class="identifier">combined_df</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">concat</span><span class="grouping">(</span><span class="grouping">[</span><span class="identifier">data_df</span><span class="punctuation">,</span> <span class="identifier">target_df</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>
    <span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">combined_df</span><span class="grouping">[</span><span class="identifier">feature_names</span><span class="grouping">]</span>
    <span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">combined_df</span><span class="grouping">[</span><span class="identifier">target_names</span><span class="grouping">]</span>
    <span class="keyword">if</span> <span class="identifier">y</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span> <span class="relational-operator">==</span> <span class="int-literal">1</span><span class="punctuation">:</span>
        <span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">y</span><span class="punctuation">.</span><span class="identifier">iloc</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span>
    <span class="keyword">return</span> <span class="identifier">combined_df</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span>


<span class="keyword">def</span> <span class="identifier">load_files</span><span class="grouping">(</span><span class="identifier">container_path</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="identifier">description</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">categories</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
               <span class="identifier">load_content</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">shuffle</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">encoding</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
               <span class="identifier">decode_error</span><span class="arithmetic-assignment">=</span><span class="string-literal">'strict'</span><span class="punctuation">,</span> <span class="identifier">random_state</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load text files with categories as subfolder names.

    Individual samples are assumed to be files stored a two levels folder
    structure such as the following:

        container_folder/
            category_1_folder/
                file_1.txt
                file_2.txt
                ...
                file_42.txt
            category_2_folder/
                file_43.txt
                file_44.txt
                ...

    The folder names are used as supervised signal label names. The individual
    file names are not important.

    This function does not try to extract features into a numpy array or scipy
    sparse matrix. In addition, if load_content is false it does not try to
    load the files in memory.

    To use text files in a scikit-learn classification or clustering algorithm,
    you will need to use the :mod`~sklearn.feature_extraction.text` module to
    build a feature extraction transformer that suits your problem.

    If you set load_content=True, you should also specify the encoding of the
    text using the 'encoding' parameter. For many modern text files, 'utf-8'
    will be the correct encoding. If you leave encoding equal to None, then the
    content will be made of bytes instead of Unicode, and you will not be able
    to use most functions in :mod:`~sklearn.feature_extraction.text`.

    Similar feature extractors should be built for other kind of unstructured
    data input such as images, audio, video, ...

    Read more in the :ref:`User Guide &lt;datasets&gt;`.

    Parameters
    ----------
    container_path : str or unicode
        Path to the main folder holding one subfolder per category

    description : str or unicode, default=None
        A paragraph describing the characteristic of the dataset: its source,
        reference, etc.

    categories : list of str, default=None
        If None (default), load all the categories. If not None, list of
        category names to load (other categories ignored).

    load_content : bool, default=True
        Whether to load or not the content of the different files. If true a
        'data' attribute containing the text information is present in the data
        structure returned. If not, a filenames attribute gives the path to the
        files.

    shuffle : bool, default=True
        Whether or not to shuffle the data: might be important for models that
        make the assumption that the samples are independent and identically
        distributed (i.i.d.), such as stochastic gradient descent.

    encoding : str, default=None
        If None, do not try to decode the content of the files (e.g. for images
        or other non-text content). If not None, encoding to use to decode text
        files to Unicode if load_content is True.

    decode_error : {'strict', 'ignore', 'replace'}, default='strict'
        Instruction on what to do if a byte sequence is given to analyze that
        contains characters not of the given `encoding`. Passed as keyword
        argument 'errors' to bytes.decode.

    random_state : int, RandomState instance or None, default=0
        Determines random number generation for dataset shuffling. Pass an int
        for reproducible output across multiple function calls.
        See :term:`Glossary &lt;random_state&gt;`.

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : list of str
            Only present when `load_content=True`.
            The raw text data to learn.
        target : ndarray
            The target labels (integer index).
        target_names : list
            The names of target classes.
        DESCR : str
            The full description of the dataset.
        filenames: ndarray
            The filenames holding the dataset.
    """</span>
    <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
    <span class="identifier">target_names</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
    <span class="identifier">filenames</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>

    <span class="identifier">folders</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">f</span> <span class="keyword">for</span> <span class="identifier">f</span> <span class="relational-operator">in</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">listdir</span><span class="grouping">(</span><span class="identifier">container_path</span><span class="grouping">)</span><span class="grouping">)</span>
               <span class="keyword">if</span> <span class="identifier">isdir</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">container_path</span><span class="punctuation">,</span> <span class="identifier">f</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">]</span>

    <span class="keyword">if</span> <span class="identifier">categories</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="identifier">folders</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">f</span> <span class="keyword">for</span> <span class="identifier">f</span> <span class="relational-operator">in</span> <span class="identifier">folders</span> <span class="keyword">if</span> <span class="identifier">f</span> <span class="relational-operator">in</span> <span class="identifier">categories</span><span class="grouping">]</span>

    <span class="keyword">for</span> <span class="identifier">label</span><span class="punctuation">,</span> <span class="identifier">folder</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">folders</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">target_names</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">folder</span><span class="grouping">)</span>
        <span class="identifier">folder_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">container_path</span><span class="punctuation">,</span> <span class="identifier">folder</span><span class="grouping">)</span>
        <span class="identifier">documents</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">folder_path</span><span class="punctuation">,</span> <span class="identifier">d</span><span class="grouping">)</span>
                     <span class="keyword">for</span> <span class="identifier">d</span> <span class="relational-operator">in</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">listdir</span><span class="grouping">(</span><span class="identifier">folder_path</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">]</span>
        <span class="identifier">target</span><span class="punctuation">.</span><span class="identifier">extend</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">documents</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="grouping">[</span><span class="identifier">label</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">filenames</span><span class="punctuation">.</span><span class="identifier">extend</span><span class="grouping">(</span><span class="identifier">documents</span><span class="grouping">)</span>

    <span class="comment"># convert to array for fancy indexing</span>
    <span class="identifier">filenames</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">filenames</span><span class="grouping">)</span>
    <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">target</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="identifier">shuffle</span><span class="punctuation">:</span>
        <span class="identifier">random_state</span> <span class="arithmetic-assignment">=</span> <span class="identifier">check_random_state</span><span class="grouping">(</span><span class="identifier">random_state</span><span class="grouping">)</span>
        <span class="identifier">indices</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arange</span><span class="grouping">(</span><span class="identifier">filenames</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">random_state</span><span class="punctuation">.</span><span class="identifier">shuffle</span><span class="grouping">(</span><span class="identifier">indices</span><span class="grouping">)</span>
        <span class="identifier">filenames</span> <span class="arithmetic-assignment">=</span> <span class="identifier">filenames</span><span class="grouping">[</span><span class="identifier">indices</span><span class="grouping">]</span>
        <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">target</span><span class="grouping">[</span><span class="identifier">indices</span><span class="grouping">]</span>

    <span class="keyword">if</span> <span class="identifier">load_content</span><span class="punctuation">:</span>
        <span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
        <span class="keyword">for</span> <span class="identifier">filename</span> <span class="relational-operator">in</span> <span class="identifier">filenames</span><span class="punctuation">:</span>
            <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">filename</span><span class="punctuation">,</span> <span class="string-literal">'rb'</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
                <span class="identifier">data</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">encoding</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">d</span><span class="punctuation">.</span><span class="identifier">decode</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="punctuation">,</span> <span class="identifier">decode_error</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">d</span> <span class="relational-operator">in</span> <span class="identifier">data</span><span class="grouping">]</span>
        <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">data</span><span class="punctuation">,</span>
                     <span class="identifier">filenames</span><span class="arithmetic-assignment">=</span><span class="identifier">filenames</span><span class="punctuation">,</span>
                     <span class="identifier">target_names</span><span class="arithmetic-assignment">=</span><span class="identifier">target_names</span><span class="punctuation">,</span>
                     <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                     <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">description</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">filenames</span><span class="arithmetic-assignment">=</span><span class="identifier">filenames</span><span class="punctuation">,</span>
                 <span class="identifier">target_names</span><span class="arithmetic-assignment">=</span><span class="identifier">target_names</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">description</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_data</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="identifier">data_file_name</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Loads data from module_path/data/data_file_name.

    Parameters
    ----------
    module_path : string
        The module path.

    data_file_name : string
        Name of csv file to be loaded from
        module_path/data/data_file_name. For example 'wine_data.csv'.

    Returns
    -------
    data : Numpy array
        A 2D array with each row representing one sample and each column
        representing the features of a given sample.

    target : Numpy array
        A 1D array holding target variables for all the samples in `data.
        For example target[0] is the target varible for data[0].

    target_names : Numpy array
        A 1D array containing the names of the classifications. For example
        target_names[0] is the name of the target[0] class.
    """</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'data'</span><span class="punctuation">,</span> <span class="identifier">data_file_name</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">csv_file</span><span class="punctuation">:</span>
        <span class="identifier">data_file</span> <span class="arithmetic-assignment">=</span> <span class="identifier">csv</span><span class="punctuation">.</span><span class="identifier">reader</span><span class="grouping">(</span><span class="identifier">csv_file</span><span class="grouping">)</span>
        <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">next</span><span class="grouping">(</span><span class="identifier">data_file</span><span class="grouping">)</span>
        <span class="identifier">n_samples</span> <span class="arithmetic-assignment">=</span> <span class="identifier">int</span><span class="grouping">(</span><span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">n_features</span> <span class="arithmetic-assignment">=</span> <span class="identifier">int</span><span class="grouping">(</span><span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">target_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">empty</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">n_samples</span><span class="punctuation">,</span> <span class="identifier">n_features</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">empty</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">n_samples</span><span class="punctuation">,</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">ir</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">data_file</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">data</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">a</span><span class="invalid">r</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">y</span><span class="grouping">(</span><span class="identifier">ir</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">float64</span><span class="grouping">)</span>
            <span class="identifier">target</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">a</span><span class="invalid">r</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">y</span><span class="grouping">(</span><span class="identifier">ir</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span><span class="punctuation">,</span> <span class="identifier">target_names</span>


<span class="keyword">def</span> <span class="identifier">load_wine</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load and return the wine dataset (classification).

    .. versionadded:: 0.18

    The wine dataset is a classic and very easy multi-class classification
    dataset.

    =================   ==============
    Classes                          3
    Samples per class        [59,71,48]
    Samples total                  178
    Dimensionality                  13
    Features            real, positive
    =================   ==============

    Read more in the :ref:`User Guide &lt;wine_dataset&gt;`.

    Parameters
    ----------
    return_X_y : bool, default=False
        If True, returns ``(data, target)`` instead of a Bunch object.
        See below for more information about the `data` and `target` object.

    as_frame : bool, default=False
        If True, the data is a pandas DataFrame including columns with
        appropriate dtypes (numeric). The target is
        a pandas DataFrame or Series depending on the number of target columns.
        If `return_X_y` is True, then (`data`, `target`) will be pandas
        DataFrames or Series as described below.

        .. versionadded:: 0.23

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : {ndarray, dataframe} of shape (178, 13)
            The data matrix. If `as_frame=True`, `data` will be a pandas
            DataFrame.
        target: {ndarray, Series} of shape (178,)
            The classification target. If `as_frame=True`, `target` will be
            a pandas Series.
        feature_names: list
            The names of the dataset columns.
        target_names: list
            The names of target classes.
        frame: DataFrame of shape (178, 14)
            Only present when `as_frame=True`. DataFrame with `data` and
            `target`.

            .. versionadded:: 0.23
        DESCR: str
            The full description of the dataset.

    (data, target) : tuple if ``return_X_y`` is True

    The copy of UCI ML Wine Data Set dataset is downloaded and modified to fit
    standard format from:
    https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data

    Examples
    --------
    Let's say you are interested in the samples 10, 80, and 140, and want to
    know their class name.

    &gt;&gt;&gt; from sklearn.datasets import load_wine
    &gt;&gt;&gt; data = load_wine()
    &gt;&gt;&gt; data.target[[10, 80, 140]]
    array([0, 1, 2])
    &gt;&gt;&gt; list(data.target_names)
    ['class_0', 'class_1', 'class_2']
    """</span>
    <span class="identifier">module_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span>
    <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span><span class="punctuation">,</span> <span class="identifier">target_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">load_data</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'wine_data.csv'</span><span class="grouping">)</span>

    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'descr', 'wine_data.rst'</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">rst_file</span><span class="punctuation">:</span>
        <span class="identifier">fdescr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rst_file</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="identifier">feature_names</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'alcohol'</span><span class="punctuation">,</span>
                     <span class="string-literal">'malic_acid'</span><span class="punctuation">,</span>
                     <span class="string-literal">'ash'</span><span class="punctuation">,</span>
                     <span class="string-literal">'alcalinity_of_ash'</span><span class="punctuation">,</span>
                     <span class="string-literal">'magnesium'</span><span class="punctuation">,</span>
                     <span class="string-literal">'total_phenols'</span><span class="punctuation">,</span>
                     <span class="string-literal">'flavanoids'</span><span class="punctuation">,</span>
                     <span class="string-literal">'nonflavanoid_phenols'</span><span class="punctuation">,</span>
                     <span class="string-literal">'proanthocyanins'</span><span class="punctuation">,</span>
                     <span class="string-literal">'color_intensity'</span><span class="punctuation">,</span>
                     <span class="string-literal">'hue'</span><span class="punctuation">,</span>
                     <span class="string-literal">'od280/od315_of_diluted_wines'</span><span class="punctuation">,</span>
                     <span class="string-literal">'proline'</span><span class="grouping">]</span>

    <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
    <span class="identifier">target_columns</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'target'</span><span class="punctuation">,</span> <span class="grouping">]</span>
    <span class="keyword">if</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">:</span>
        <span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_convert_data_dataframe</span><span class="grouping">(</span><span class="string-literal">"load_wine"</span><span class="punctuation">,</span>
                                                      <span class="identifier">data</span><span class="punctuation">,</span>
                                                      <span class="identifier">target</span><span class="punctuation">,</span>
                                                      <span class="identifier">feature_names</span><span class="punctuation">,</span>
                                                      <span class="identifier">target_columns</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">data</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                 <span class="identifier">frame</span><span class="arithmetic-assignment">=</span><span class="identifier">frame</span><span class="punctuation">,</span>
                 <span class="identifier">target_names</span><span class="arithmetic-assignment">=</span><span class="identifier">target_names</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">fdescr</span><span class="punctuation">,</span>
                 <span class="identifier">feature_names</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_iris</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load and return the iris dataset (classification).

    The iris dataset is a classic and very easy multi-class classification
    dataset.

    =================   ==============
    Classes                          3
    Samples per class               50
    Samples total                  150
    Dimensionality                   4
    Features            real, positive
    =================   ==============

    Read more in the :ref:`User Guide &lt;iris_dataset&gt;`.

    Parameters
    ----------
    return_X_y : bool, default=False
        If True, returns ``(data, target)`` instead of a Bunch object. See
        below for more information about the `data` and `target` object.

        .. versionadded:: 0.18

    as_frame : bool, default=False
        If True, the data is a pandas DataFrame including columns with
        appropriate dtypes (numeric). The target is
        a pandas DataFrame or Series depending on the number of target columns.
        If `return_X_y` is True, then (`data`, `target`) will be pandas
        DataFrames or Series as described below.

        .. versionadded:: 0.23

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : {ndarray, dataframe} of shape (150, 4)
            The data matrix. If `as_frame=True`, `data` will be a pandas
            DataFrame.
        target: {ndarray, Series} of shape (150,)
            The classification target. If `as_frame=True`, `target` will be
            a pandas Series.
        feature_names: list
            The names of the dataset columns.
        target_names: list
            The names of target classes.
        frame: DataFrame of shape (150, 5)
            Only present when `as_frame=True`. DataFrame with `data` and
            `target`.

            .. versionadded:: 0.23
        DESCR: str
            The full description of the dataset.
        filename: str
            The path to the location of the data.

            .. versionadded:: 0.20

    (data, target) : tuple if ``return_X_y`` is True

        .. versionadded:: 0.18

    Notes
    -----
        .. versionchanged:: 0.20
            Fixed two wrong data points according to Fisher's paper.
            The new version is the same as in R, but not as in the UCI
            Machine Learning Repository.

    Examples
    --------
    Let's say you are interested in the samples 10, 25, and 50, and want to
    know their class name.

    &gt;&gt;&gt; from sklearn.datasets import load_iris
    &gt;&gt;&gt; data = load_iris()
    &gt;&gt;&gt; data.target[[10, 25, 50]]
    array([0, 0, 1])
    &gt;&gt;&gt; list(data.target_names)
    ['setosa', 'versicolor', 'virginica']
    """</span>
    <span class="identifier">module_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span>
    <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span><span class="punctuation">,</span> <span class="identifier">target_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">load_data</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'iris.csv'</span><span class="grouping">)</span>
    <span class="identifier">iris_csv_filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'data', 'iris.csv'</span><span class="grouping">)</span>

    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'descr', 'iris.rst'</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">rst_file</span><span class="punctuation">:</span>
        <span class="identifier">fdescr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rst_file</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="identifier">feature_names</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'sepal length (cm)', 'sepal width (cm)'</span><span class="punctuation">,</span>
                     <span class="string-literal">'petal length (cm)', 'petal width (cm)'</span><span class="grouping">]</span>

    <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
    <span class="identifier">target_columns</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'target'</span><span class="punctuation">,</span> <span class="grouping">]</span>
    <span class="keyword">if</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">:</span>
        <span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_convert_data_dataframe</span><span class="grouping">(</span><span class="string-literal">"load_iris"</span><span class="punctuation">,</span>
                                                      <span class="identifier">data</span><span class="punctuation">,</span>
                                                      <span class="identifier">target</span><span class="punctuation">,</span>
                                                      <span class="identifier">feature_names</span><span class="punctuation">,</span>
                                                      <span class="identifier">target_columns</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">data</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                 <span class="identifier">frame</span><span class="arithmetic-assignment">=</span><span class="identifier">frame</span><span class="punctuation">,</span>
                 <span class="identifier">target_names</span><span class="arithmetic-assignment">=</span><span class="identifier">target_names</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">fdescr</span><span class="punctuation">,</span>
                 <span class="identifier">feature_names</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span><span class="punctuation">,</span>
                 <span class="identifier">filename</span><span class="arithmetic-assignment">=</span><span class="identifier">iris_csv_filename</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_breast_cancer</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load and return the breast cancer wisconsin dataset (classification).

    The breast cancer dataset is a classic and very easy binary classification
    dataset.

    =================   ==============
    Classes                          2
    Samples per class    212(M),357(B)
    Samples total                  569
    Dimensionality                  30
    Features            real, positive
    =================   ==============

    Read more in the :ref:`User Guide &lt;breast_cancer_dataset&gt;`.

    Parameters
    ----------
    return_X_y : bool, default=False
        If True, returns ``(data, target)`` instead of a Bunch object.
        See below for more information about the `data` and `target` object.

        .. versionadded:: 0.18

    as_frame : bool, default=False
        If True, the data is a pandas DataFrame including columns with
        appropriate dtypes (numeric). The target is
        a pandas DataFrame or Series depending on the number of target columns.
        If `return_X_y` is True, then (`data`, `target`) will be pandas
        DataFrames or Series as described below.

        .. versionadded:: 0.23

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : {ndarray, dataframe} of shape (569, 30)
            The data matrix. If `as_frame=True`, `data` will be a pandas
            DataFrame.
        target: {ndarray, Series} of shape (569,)
            The classification target. If `as_frame=True`, `target` will be
            a pandas Series.
        feature_names: list
            The names of the dataset columns.
        target_names: list
            The names of target classes.
        frame: DataFrame of shape (569, 31)
            Only present when `as_frame=True`. DataFrame with `data` and
            `target`.

            .. versionadded:: 0.23
        DESCR: str
            The full description of the dataset.
        filename: str
            The path to the location of the data.

            .. versionadded:: 0.20

    (data, target) : tuple if ``return_X_y`` is True

        .. versionadded:: 0.18

    The copy of UCI ML Breast Cancer Wisconsin (Diagnostic) dataset is
    downloaded from:
    https://goo.gl/U2Uwz2

    Examples
    --------
    Let's say you are interested in the samples 10, 50, and 85, and want to
    know their class name.

    &gt;&gt;&gt; from sklearn.datasets import load_breast_cancer
    &gt;&gt;&gt; data = load_breast_cancer()
    &gt;&gt;&gt; data.target[[10, 50, 85]]
    array([0, 1, 0])
    &gt;&gt;&gt; list(data.target_names)
    ['malignant', 'benign']
    """</span>
    <span class="identifier">module_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span>
    <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span><span class="punctuation">,</span> <span class="identifier">target_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">load_data</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'breast_cancer.csv'</span><span class="grouping">)</span>
    <span class="identifier">csv_filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'data', 'breast_cancer.csv'</span><span class="grouping">)</span>

    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'descr', 'breast_cancer.rst'</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">rst_file</span><span class="punctuation">:</span>
        <span class="identifier">fdescr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rst_file</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="identifier">feature_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="string-literal">'mean radius', 'mean texture'</span><span class="punctuation">,</span>
                              <span class="string-literal">'mean perimeter', 'mean area'</span><span class="punctuation">,</span>
                              <span class="string-literal">'mean smoothness', 'mean compactness'</span><span class="punctuation">,</span>
                              <span class="string-literal">'mean concavity', 'mean concave points'</span><span class="punctuation">,</span>
                              <span class="string-literal">'mean symmetry', 'mean fractal dimension'</span><span class="punctuation">,</span>
                              <span class="string-literal">'radius error', 'texture error'</span><span class="punctuation">,</span>
                              <span class="string-literal">'perimeter error', 'area error'</span><span class="punctuation">,</span>
                              <span class="string-literal">'smoothness error', 'compactness error'</span><span class="punctuation">,</span>
                              <span class="string-literal">'concavity error', 'concave points error'</span><span class="punctuation">,</span>
                              <span class="string-literal">'symmetry error', 'fractal dimension error'</span><span class="punctuation">,</span>
                              <span class="string-literal">'worst radius', 'worst texture'</span><span class="punctuation">,</span>
                              <span class="string-literal">'worst perimeter', 'worst area'</span><span class="punctuation">,</span>
                              <span class="string-literal">'worst smoothness', 'worst compactness'</span><span class="punctuation">,</span>
                              <span class="string-literal">'worst concavity', 'worst concave points'</span><span class="punctuation">,</span>
                              <span class="string-literal">'worst symmetry', 'worst fractal dimension'</span><span class="grouping">]</span><span class="grouping">)</span>

    <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
    <span class="identifier">target_columns</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'target'</span><span class="punctuation">,</span> <span class="grouping">]</span>
    <span class="keyword">if</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">:</span>
        <span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_convert_data_dataframe</span><span class="grouping">(</span><span class="string-literal">"load_breast_cancer"</span><span class="punctuation">,</span>
                                                      <span class="identifier">data</span><span class="punctuation">,</span>
                                                      <span class="identifier">target</span><span class="punctuation">,</span>
                                                      <span class="identifier">feature_names</span><span class="punctuation">,</span>
                                                      <span class="identifier">target_columns</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">data</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                 <span class="identifier">frame</span><span class="arithmetic-assignment">=</span><span class="identifier">frame</span><span class="punctuation">,</span>
                 <span class="identifier">target_names</span><span class="arithmetic-assignment">=</span><span class="identifier">target_names</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">fdescr</span><span class="punctuation">,</span>
                 <span class="identifier">feature_names</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span><span class="punctuation">,</span>
                 <span class="identifier">filename</span><span class="arithmetic-assignment">=</span><span class="identifier">csv_filename</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_digits</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="identifier">n_class</span><span class="arithmetic-assignment">=</span><span class="int-literal">10</span><span class="punctuation">,</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load and return the digits dataset (classification).

    Each datapoint is a 8x8 image of a digit.

    =================   ==============
    Classes                         10
    Samples per class             ~180
    Samples total                 1797
    Dimensionality                  64
    Features             integers 0-16
    =================   ==============

    Read more in the :ref:`User Guide &lt;digits_dataset&gt;`.

    Parameters
    ----------
    n_class : int, default=10
        The number of classes to return. Between 0 and 10.

    return_X_y : bool, default=False
        If True, returns ``(data, target)`` instead of a Bunch object.
        See below for more information about the `data` and `target` object.

        .. versionadded:: 0.18

    as_frame : bool, default=False
        If True, the data is a pandas DataFrame including columns with
        appropriate dtypes (numeric). The target is
        a pandas DataFrame or Series depending on the number of target columns.
        If `return_X_y` is True, then (`data`, `target`) will be pandas
        DataFrames or Series as described below.

        .. versionadded:: 0.23

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : {ndarray, dataframe} of shape (1797, 64)
            The flattened data matrix. If `as_frame=True`, `data` will be
            a pandas DataFrame.
        target: {ndarray, Series} of shape (1797,)
            The classification target. If `as_frame=True`, `target` will be
            a pandas Series.
        feature_names: list
            The names of the dataset columns.
        target_names: list
            The names of target classes.

            .. versionadded:: 0.20

        frame: DataFrame of shape (1797, 65)
            Only present when `as_frame=True`. DataFrame with `data` and
            `target`.

            .. versionadded:: 0.23
        images: {ndarray} of shape (1797, 8, 8)
            The raw image data.
        DESCR: str
            The full description of the dataset.

    (data, target) : tuple if ``return_X_y`` is True

        .. versionadded:: 0.18

    This is a copy of the test set of the UCI ML hand-written digits datasets
    https://archive.ics.uci.edu/ml/datasets/Optical+Recognition+of+Handwritten+Digits

    Examples
    --------
    To load the data and visualize the images::

        &gt;&gt;&gt; from sklearn.datasets import load_digits
        &gt;&gt;&gt; digits = load_digits()
        &gt;&gt;&gt; print(digits.data.shape)
        (1797, 64)
        &gt;&gt;&gt; import matplotlib.pyplot as plt #doctest: +SKIP
        &gt;&gt;&gt; plt.gray() #doctest: +SKIP
        &gt;&gt;&gt; plt.matshow(digits.images[0]) #doctest: +SKIP
        &gt;&gt;&gt; plt.show() #doctest: +SKIP
    """</span>
    <span class="identifier">module_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span>
    <span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">loadtxt</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'data', 'digits.csv.gz'</span><span class="grouping">)</span><span class="punctuation">,</span>
                      <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">l</span><span class="invalid">i</span><span class="invalid">m</span><span class="invalid">i</span><span class="invalid">t</span><span class="invalid">e</span><span class="invalid">r</span><span class="arithmetic-assignment">=</span><span class="string-literal">','</span><span class="grouping">)</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'descr', 'digits.rst'</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">descr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">copy</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
    <span class="identifier">flat_data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span>
    <span class="identifier">images</span> <span class="arithmetic-assignment">=</span> <span class="identifier">flat_data</span><span class="punctuation">.</span><span class="identifier">view</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">images</span><span class="punctuation">.</span><span class="identifier">shape</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="identifier">n_class</span> <span class="relational-operator">&lt;</span> <span class="int-literal">10</span><span class="punctuation">:</span>
        <span class="identifier">idx</span> <span class="arithmetic-assignment">=</span> <span class="identifier">target</span> <span class="relational-operator">&lt;</span> <span class="identifier">n_class</span>
        <span class="identifier">flat_data</span><span class="punctuation">,</span> <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">flat_data</span><span class="grouping">[</span><span class="identifier">idx</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">target</span><span class="grouping">[</span><span class="identifier">idx</span><span class="grouping">]</span>
        <span class="identifier">images</span> <span class="arithmetic-assignment">=</span> <span class="identifier">images</span><span class="grouping">[</span><span class="identifier">idx</span><span class="grouping">]</span>

    <span class="identifier">feature_names</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'pixel_{}_{}'</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">row_idx</span><span class="punctuation">,</span> <span class="identifier">col_idx</span><span class="grouping">)</span>
                     <span class="keyword">for</span> <span class="identifier">row_idx</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">8</span><span class="grouping">)</span>
                     <span class="keyword">for</span> <span class="identifier">col_idx</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">8</span><span class="grouping">)</span><span class="grouping">]</span>

    <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
    <span class="identifier">target_columns</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'target'</span><span class="punctuation">,</span> <span class="grouping">]</span>
    <span class="keyword">if</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">:</span>
        <span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">flat_data</span><span class="punctuation">,</span> <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_convert_data_dataframe</span><span class="grouping">(</span><span class="string-literal">"load_digits"</span><span class="punctuation">,</span>
                                                           <span class="identifier">flat_data</span><span class="punctuation">,</span>
                                                           <span class="identifier">target</span><span class="punctuation">,</span>
                                                           <span class="identifier">feature_names</span><span class="punctuation">,</span>
                                                           <span class="identifier">target_columns</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">flat_data</span><span class="punctuation">,</span> <span class="identifier">target</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">flat_data</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                 <span class="identifier">frame</span><span class="arithmetic-assignment">=</span><span class="identifier">frame</span><span class="punctuation">,</span>
                 <span class="identifier">feature_names</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span><span class="punctuation">,</span>
                 <span class="identifier">target_names</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arange</span><span class="grouping">(</span><span class="int-literal">10</span><span class="grouping">)</span><span class="punctuation">,</span>
                 <span class="identifier">images</span><span class="arithmetic-assignment">=</span><span class="identifier">images</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">descr</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_diabetes</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load and return the diabetes dataset (regression).

    ==============   ==================
    Samples total    442
    Dimensionality   10
    Features         real, -.2 &lt; x &lt; .2
    Targets          integer 25 - 346
    ==============   ==================
    
    .. note::
       The meaning of each feature (i.e. `feature_names`) might be unclear
       (especially for `ltg`) as the documentation of the original dataset is
       not explicit. We provide information that seems correct in regard with
       the scientific literature in this field of research.

    Read more in the :ref:`User Guide &lt;diabetes_dataset&gt;`.

    Parameters
    ----------
    return_X_y : bool, default=False.
        If True, returns ``(data, target)`` instead of a Bunch object.
        See below for more information about the `data` and `target` object.

        .. versionadded:: 0.18

    as_frame : bool, default=False
        If True, the data is a pandas DataFrame including columns with
        appropriate dtypes (numeric). The target is
        a pandas DataFrame or Series depending on the number of target columns.
        If `return_X_y` is True, then (`data`, `target`) will be pandas
        DataFrames or Series as described below.

        .. versionadded:: 0.23

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : {ndarray, dataframe} of shape (442, 10)
            The data matrix. If `as_frame=True`, `data` will be a pandas
            DataFrame.
        target: {ndarray, Series} of shape (442,)
            The regression target. If `as_frame=True`, `target` will be
            a pandas Series.
        feature_names: list
            The names of the dataset columns.
        frame: DataFrame of shape (442, 11)
            Only present when `as_frame=True`. DataFrame with `data` and
            `target`.

            .. versionadded:: 0.23
        DESCR: str
            The full description of the dataset.
        data_filename: str
            The path to the location of the data.
        target_filename: str
            The path to the location of the target.

    (data, target) : tuple if ``return_X_y`` is True

        .. versionadded:: 0.18
    """</span>
    <span class="identifier">module_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span>
    <span class="identifier">base_dir</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'data'</span><span class="grouping">)</span>
    <span class="identifier">data_filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">base_dir</span><span class="punctuation">,</span> <span class="string-literal">'diabetes_data.csv.gz'</span><span class="grouping">)</span>
    <span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">loadtxt</span><span class="grouping">(</span><span class="identifier">data_filename</span><span class="grouping">)</span>
    <span class="identifier">target_filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">base_dir</span><span class="punctuation">,</span> <span class="string-literal">'diabetes_target.csv.gz'</span><span class="grouping">)</span>
    <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">loadtxt</span><span class="grouping">(</span><span class="identifier">target_filename</span><span class="grouping">)</span>

    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'descr', 'diabetes.rst'</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">rst_file</span><span class="punctuation">:</span>
        <span class="identifier">fdescr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">rst_file</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="identifier">feature_names</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'age', 'sex', 'bmi', 'bp'</span><span class="punctuation">,</span>
                     <span class="string-literal">'s1', 's2', 's3', 's4', 's5', 's6'</span><span class="grouping">]</span>

    <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
    <span class="identifier">target_columns</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'target'</span><span class="punctuation">,</span> <span class="grouping">]</span>
    <span class="keyword">if</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">:</span>
        <span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_convert_data_dataframe</span><span class="grouping">(</span><span class="string-literal">"load_diabetes"</span><span class="punctuation">,</span>
                                                      <span class="identifier">data</span><span class="punctuation">,</span>
                                                      <span class="identifier">target</span><span class="punctuation">,</span>
                                                      <span class="identifier">feature_names</span><span class="punctuation">,</span>
                                                      <span class="identifier">target_columns</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">data</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                 <span class="identifier">frame</span><span class="arithmetic-assignment">=</span><span class="identifier">frame</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">fdescr</span><span class="punctuation">,</span>
                 <span class="identifier">feature_names</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span><span class="punctuation">,</span>
                 <span class="identifier">data_filename</span><span class="arithmetic-assignment">=</span><span class="identifier">data_filename</span><span class="punctuation">,</span>
                 <span class="identifier">target_filename</span><span class="arithmetic-assignment">=</span><span class="identifier">target_filename</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_linnerud</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load and return the physical excercise linnerud dataset.

    This dataset is suitable for multi-ouput regression tasks.

    ==============   ============================
    Samples total    20
    Dimensionality   3 (for both data and target)
    Features         integer
    Targets          integer
    ==============   ============================

    Read more in the :ref:`User Guide &lt;linnerrud_dataset&gt;`.

    Parameters
    ----------
    return_X_y : bool, default=False
        If True, returns ``(data, target)`` instead of a Bunch object.
        See below for more information about the `data` and `target` object.

        .. versionadded:: 0.18

    as_frame : bool, default=False
        If True, the data is a pandas DataFrame including columns with
        appropriate dtypes (numeric, string or categorical). The target is
        a pandas DataFrame or Series depending on the number of target columns.
        If `return_X_y` is True, then (`data`, `target`) will be pandas
        DataFrames or Series as described below.

        .. versionadded:: 0.23

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : {ndarray, dataframe} of shape (20, 3)
            The data matrix. If `as_frame=True`, `data` will be a pandas
            DataFrame.
        target: {ndarray, dataframe} of shape (20, 3)
            The regression targets. If `as_frame=True`, `target` will be
            a pandas DataFrame.
        feature_names: list
            The names of the dataset columns.
        target_names: list
            The names of the target columns.
        frame: DataFrame of shape (20, 6)
            Only present when `as_frame=True`. DataFrame with `data` and
            `target`.

            .. versionadded:: 0.23
        DESCR: str
            The full description of the dataset.
        data_filename: str
            The path to the location of the data.
        target_filename: str
            The path to the location of the target.

            .. versionadded:: 0.20

    (data, target) : tuple if ``return_X_y`` is True

        .. versionadded:: 0.18
    """</span>
    <span class="identifier">base_dir</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="string-literal">'data/'</span><span class="grouping">)</span>
    <span class="identifier">data_filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">base_dir</span><span class="punctuation">,</span> <span class="string-literal">'linnerud_exercise.csv'</span><span class="grouping">)</span>
    <span class="identifier">target_filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">base_dir</span><span class="punctuation">,</span> <span class="string-literal">'linnerud_physiological.csv'</span><span class="grouping">)</span>

    <span class="comment"># Read data</span>
    <span class="identifier">data_exercise</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">loadtxt</span><span class="grouping">(</span><span class="identifier">data_filename</span><span class="punctuation">,</span> <span class="identifier">skiprows</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>
    <span class="identifier">data_physiological</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">loadtxt</span><span class="grouping">(</span><span class="identifier">target_filename</span><span class="punctuation">,</span> <span class="identifier">skiprows</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>

    <span class="comment"># Read header</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">data_filename</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">header_exercise</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">readline</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">split</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">target_filename</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">header_physiological</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">readline</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">split</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="string-literal">'/descr/linnerud.rst'</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">descr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
    <span class="keyword">if</span> <span class="invalid">a</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">:</span>
        <span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span>
         <span class="identifier">data_exercise</span><span class="punctuation">,</span>
         <span class="identifier">data_physiological</span><span class="grouping">)</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_convert_data_dataframe</span><span class="grouping">(</span><span class="string-literal">"load_linnerud"</span><span class="punctuation">,</span>
                                                       <span class="identifier">data_exercise</span><span class="punctuation">,</span>
                                                       <span class="identifier">data_physiological</span><span class="punctuation">,</span>
                                                       <span class="identifier">header_exercise</span><span class="punctuation">,</span>
                                                       <span class="identifier">header_physiological</span><span class="grouping">)</span>
    <span class="keyword">if</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">data_exercise</span><span class="punctuation">,</span> <span class="identifier">data_physiological</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">data_exercise</span><span class="punctuation">,</span>
                 <span class="identifier">feature_names</span><span class="arithmetic-assignment">=</span><span class="identifier">header_exercise</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">data_physiological</span><span class="punctuation">,</span>
                 <span class="identifier">target_names</span><span class="arithmetic-assignment">=</span><span class="identifier">header_physiological</span><span class="punctuation">,</span>
                 <span class="identifier">frame</span><span class="arithmetic-assignment">=</span><span class="identifier">frame</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">descr</span><span class="punctuation">,</span>
                 <span class="identifier">data_filename</span><span class="arithmetic-assignment">=</span><span class="identifier">data_filename</span><span class="punctuation">,</span>
                 <span class="identifier">target_filename</span><span class="arithmetic-assignment">=</span><span class="identifier">target_filename</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_boston</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load and return the boston house-prices dataset (regression).

    ==============   ==============
    Samples total               506
    Dimensionality               13
    Features         real, positive
    Targets           real 5. - 50.
    ==============   ==============

    Read more in the :ref:`User Guide &lt;boston_dataset&gt;`.

    Parameters
    ----------
    return_X_y : bool, default=False
        If True, returns ``(data, target)`` instead of a Bunch object.
        See below for more information about the `data` and `target` object.

        .. versionadded:: 0.18

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        data : ndarray of shape (506, 13)
            The data matrix.
        target : ndarray of shape (506, )
            The regression target.
        filename : str
            The physical location of boston csv dataset.

            .. versionadded:: 0.20

        DESCR : str
            The full description of the dataset.
        feature_names : ndarray
            The names of features

    (data, target) : tuple if ``return_X_y`` is True

        .. versionadded:: 0.18

    Notes
    -----
        .. versionchanged:: 0.20
            Fixed a wrong data point at [445, 0].

    Examples
    --------
    &gt;&gt;&gt; from sklearn.datasets import load_boston
    &gt;&gt;&gt; X, y = load_boston(return_X_y=True)
    &gt;&gt;&gt; print(X.shape)
    (506, 13)
    """</span>
    <span class="identifier">module_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span>

    <span class="identifier">fdescr_name</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'descr', 'boston_house_prices.rst'</span><span class="grouping">)</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">fdescr_name</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">descr_text</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="identifier">data_file_name</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'data', 'boston_house_prices.csv'</span><span class="grouping">)</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">data_file_name</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">data_file</span> <span class="arithmetic-assignment">=</span> <span class="identifier">csv</span><span class="punctuation">.</span><span class="identifier">reader</span><span class="grouping">(</span><span class="identifier">f</span><span class="grouping">)</span>
        <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">next</span><span class="grouping">(</span><span class="identifier">data_file</span><span class="grouping">)</span>
        <span class="identifier">n_samples</span> <span class="arithmetic-assignment">=</span> <span class="identifier">int</span><span class="grouping">(</span><span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">n_features</span> <span class="arithmetic-assignment">=</span> <span class="identifier">int</span><span class="grouping">(</span><span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
        <span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">empty</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">n_samples</span><span class="punctuation">,</span> <span class="identifier">n_features</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">empty</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">n_samples</span><span class="punctuation">,</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">next</span><span class="grouping">(</span><span class="identifier">data_file</span><span class="grouping">)</span>  <span class="comment"># names of features</span>
        <span class="identifier">feature_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">temp</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">d</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">data_file</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">data</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">a</span><span class="invalid">r</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">y</span><span class="grouping">(</span><span class="identifier">d</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">float64</span><span class="grouping">)</span>
            <span class="identifier">target</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">a</span><span class="invalid">r</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">y</span><span class="grouping">(</span><span class="identifier">d</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">float64</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="invalid">r</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">u</span><span class="invalid">r</span><span class="invalid">n</span><span class="invalid">_</span><span class="invalid">X</span><span class="invalid">_</span><span class="invalid">y</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">data</span><span class="arithmetic-assignment">=</span><span class="identifier">data</span><span class="punctuation">,</span>
                 <span class="identifier">target</span><span class="arithmetic-assignment">=</span><span class="identifier">target</span><span class="punctuation">,</span>
                 <span class="comment"># last column is target value</span>
                 <span class="identifier">feature_names</span><span class="arithmetic-assignment">=</span><span class="identifier">feature_names</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">descr_text</span><span class="punctuation">,</span>
                 <span class="identifier">filename</span><span class="arithmetic-assignment">=</span><span class="identifier">data_file_name</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_sample_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load sample images for image manipulation.

    Loads both, ``china`` and ``flower``.

    Read more in the :ref:`User Guide &lt;sample_images&gt;`.

    Returns
    -------
    data : :class:`~sklearn.utils.Bunch`
        Dictionary-like object, with the following attributes.

        images : list of ndarray of shape (427, 640, 3)
            The two sample image.
        filenames : list
            The filenames for the images.
        DESCR : str
            The full description of the dataset.

    Examples
    --------
    To load the data and visualize the images:

    &gt;&gt;&gt; from sklearn.datasets import load_sample_images
    &gt;&gt;&gt; dataset = load_sample_images()     #doctest: +SKIP
    &gt;&gt;&gt; len(dataset.images)                #doctest: +SKIP
    2
    &gt;&gt;&gt; first_img_data = dataset.images[0] #doctest: +SKIP
    &gt;&gt;&gt; first_img_data.shape               #doctest: +SKIP
    (427, 640, 3)
    &gt;&gt;&gt; first_img_data.dtype               #doctest: +SKIP
    dtype('uint8')
    """</span>
    <span class="comment"># import PIL only when needed</span>
    <span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">externals</span><span class="punctuation">.</span><span class="identifier">_pilutil</span> <span class="keyword">import</span> <span class="identifier">imread</span>

    <span class="identifier">module_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="string-literal">"images"</span><span class="grouping">)</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="string-literal">'README.txt'</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">descr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">filenames</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="punctuation">,</span> <span class="identifier">filename</span><span class="grouping">)</span>
                 <span class="keyword">for</span> <span class="identifier">filename</span> <span class="relational-operator">in</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">listdir</span><span class="grouping">(</span><span class="identifier">module_path</span><span class="grouping">)</span><span class="grouping">)</span>
                 <span class="keyword">if</span> <span class="identifier">filename</span><span class="punctuation">.</span><span class="identifier">endswith</span><span class="grouping">(</span><span class="string-literal">".jpg"</span><span class="grouping">)</span><span class="grouping">]</span>
    <span class="comment"># Load image data for each image in the source folder.</span>
    <span class="identifier">images</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">imread</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">filename</span> <span class="relational-operator">in</span> <span class="identifier">filenames</span><span class="grouping">]</span>

    <span class="keyword">return</span> <span class="identifier">Bunch</span><span class="grouping">(</span><span class="identifier">images</span><span class="arithmetic-assignment">=</span><span class="identifier">images</span><span class="punctuation">,</span>
                 <span class="identifier">filenames</span><span class="arithmetic-assignment">=</span><span class="identifier">filenames</span><span class="punctuation">,</span>
                 <span class="identifier">DESCR</span><span class="arithmetic-assignment">=</span><span class="identifier">descr</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">load_sample_image</span><span class="grouping">(</span><span class="identifier">image_name</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Load the numpy array of a single sample image

    Read more in the :ref:`User Guide &lt;sample_images&gt;`.

    Parameters
    ----------
    image_name : {`china.jpg`, `flower.jpg`}
        The name of the sample image loaded

    Returns
    -------
    img : 3D array
        The image as a numpy array: height x width x color

    Examples
    --------

    &gt;&gt;&gt; from sklearn.datasets import load_sample_image
    &gt;&gt;&gt; china = load_sample_image('china.jpg')   # doctest: +SKIP
    &gt;&gt;&gt; china.dtype                              # doctest: +SKIP
    dtype('uint8')
    &gt;&gt;&gt; china.shape                              # doctest: +SKIP
    (427, 640, 3)
    &gt;&gt;&gt; flower = load_sample_image('flower.jpg') # doctest: +SKIP
    &gt;&gt;&gt; flower.dtype                             # doctest: +SKIP
    dtype('uint8')
    &gt;&gt;&gt; flower.shape                             # doctest: +SKIP
    (427, 640, 3)
    """</span>
    <span class="identifier">images</span> <span class="arithmetic-assignment">=</span> <span class="identifier">load_sample_images</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">index</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
    <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">filename</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">images</span><span class="punctuation">.</span><span class="identifier">filenames</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="identifier">filename</span><span class="punctuation">.</span><span class="identifier">endswith</span><span class="grouping">(</span><span class="identifier">image_name</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">index</span> <span class="arithmetic-assignment">=</span> <span class="identifier">i</span>
            <span class="keyword">break</span>
    <span class="keyword">if</span> <span class="identifier">index</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="keyword">raise</span> <span class="identifier">AttributeError</span><span class="grouping">(</span><span class="string-literal">"Cannot find sample image: %s"</span> <span class="arithmetic-operator">%</span> <span class="identifier">image_name</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">images</span><span class="punctuation">.</span><span class="identifier">images</span><span class="grouping">[</span><span class="identifier">index</span><span class="grouping">]</span>


<span class="keyword">def</span> <span class="identifier">_pkl_filepath</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="identifier">args</span><span class="punctuation">,</span> <span class="arithmetic-operator">**</span><span class="identifier">kwargs</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Return filename for Python 3 pickles

    args[-1] is expected to be the ".pkl" filename. For compatibility with
    older scikit-learn versions, a suffix is inserted before the extension.

    _pkl_filepath('/path/to/folder', 'filename.pkl') returns
    '/path/to/folder/filename_py3.pkl'

    """</span>
    <span class="identifier">py3_suffix</span> <span class="arithmetic-assignment">=</span> <span class="identifier">kwargs</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"py3_suffix", "_py3"</span><span class="grouping">)</span>
    <span class="identifier">basename</span><span class="punctuation">,</span> <span class="identifier">ext</span> <span class="arithmetic-assignment">=</span> <span class="identifier">splitext</span><span class="grouping">(</span><span class="identifier">args</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">basename</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">py3_suffix</span>
    <span class="identifier">new_args</span> <span class="arithmetic-assignment">=</span> <span class="identifier">args</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="grouping">(</span><span class="identifier">basename</span> <span class="arithmetic-operator">+</span> <span class="identifier">ext</span><span class="punctuation">,</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">join</span><span class="grouping">(</span><span class="arithmetic-operator">*</span><span class="identifier">new_args</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">_sha256</span><span class="grouping">(</span><span class="identifier">path</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Calculate the sha256 hash of the file at path."""</span>
    <span class="identifier">sha256hash</span> <span class="arithmetic-assignment">=</span> <span class="identifier">hashlib</span><span class="punctuation">.</span><span class="identifier">sha256</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">chunk_size</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">8192</span>
    <span class="keyword">with</span> <span class="identifier">open</span><span class="grouping">(</span><span class="identifier">path</span><span class="punctuation">,</span> <span class="string-literal">"rb"</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="keyword">while</span> <span class="bool-literal">True</span><span class="punctuation">:</span>
            <span class="identifier">buffer</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="punctuation">.</span><span class="identifier">read</span><span class="grouping">(</span><span class="identifier">chunk_size</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">buffer</span><span class="punctuation">:</span>
                <span class="keyword">break</span>
            <span class="identifier">sha256hash</span><span class="punctuation">.</span><span class="identifier">update</span><span class="grouping">(</span><span class="identifier">buffer</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">sha256hash</span><span class="punctuation">.</span><span class="identifier">hexdigest</span><span class="grouping">(</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">_fetch_remote</span><span class="grouping">(</span><span class="identifier">remote</span><span class="punctuation">,</span> <span class="identifier">dirname</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Helper function to download a remote dataset into path

    Fetch a dataset pointed by remote's url, save into path using remote's
    filename and ensure its integrity based on the SHA256 Checksum of the
    downloaded file.

    Parameters
    ----------
    remote : RemoteFileMetadata
        Named tuple containing remote dataset meta information: url, filename
        and checksum

    dirname : string
        Directory to save the file to.

    Returns
    -------
    file_path: string
        Full path of the created file.
    """</span>

    <span class="identifier">file_path</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">remote</span><span class="punctuation">.</span><span class="identifier">filename</span> <span class="keyword">if</span> <span class="identifier">dirname</span> <span class="relational-operator">is</span> <span class="none-literal">None</span>
                 <span class="keyword">else</span> <span class="identifier">join</span><span class="grouping">(</span><span class="identifier">dirname</span><span class="punctuation">,</span> <span class="identifier">remote</span><span class="punctuation">.</span><span class="identifier">filename</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">urlretrieve</span><span class="grouping">(</span><span class="identifier">remote</span><span class="punctuation">.</span><span class="identifier">url</span><span class="punctuation">,</span> <span class="identifier">file_path</span><span class="grouping">)</span>
    <span class="identifier">checksum</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_sha256</span><span class="grouping">(</span><span class="identifier">file_path</span><span class="grouping">)</span>
    <span class="keyword">if</span> <span class="identifier">remote</span><span class="punctuation">.</span><span class="identifier">checksum</span> <span class="relational-operator">!=</span> <span class="identifier">checksum</span><span class="punctuation">:</span>
        <span class="keyword">raise</span> <span class="identifier">IOError</span><span class="grouping">(</span><span class="string-literal">"{} has an SHA256 checksum ({}) "</span>
                      <span class="string-literal">"differing from expected ({}), "</span>
                      <span class="string-literal">"file may be corrupted."</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">file_path</span><span class="punctuation">,</span> <span class="identifier">checksum</span><span class="punctuation">,</span>
                                                      <span class="identifier">remote</span><span class="punctuation">.</span><span class="identifier">checksum</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">file_path</span>

    </pre>
  </body>
</html>