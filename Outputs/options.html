<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">#!/usr/bin python3</span>
<span class="comment">""" Cli Options for the GUI """</span>
<span class="keyword">import</span> <span class="identifier">inspect</span>
<span class="keyword">from</span> <span class="identifier">argparse</span> <span class="keyword">import</span> <span class="identifier">SUPPRESS</span>
<span class="keyword">from</span> <span class="invalid">i</span><span class="invalid">m</span><span class="invalid">p</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">t</span><span class="invalid">l</span><span class="invalid">i</span><span class="invalid">b</span> <span class="keyword">import</span> <span class="invalid">i</span><span class="invalid">m</span><span class="invalid">p</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">m</span><span class="invalid">o</span><span class="invalid">d</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">e</span>
<span class="keyword">import</span> <span class="identifier">logging</span>
<span class="keyword">import</span> <span class="identifier">os</span>
<span class="keyword">import</span> <span class="identifier">re</span>
<span class="keyword">import</span> <span class="identifier">sys</span>
<span class="keyword">from</span> <span class="identifier">collections</span> <span class="keyword">import</span> <span class="identifier">OrderedDict</span>

<span class="keyword">from</span> <span class="identifier">lib</span><span class="punctuation">.</span><span class="identifier">cli</span> <span class="keyword">import</span> <span class="identifier">actions</span><span class="punctuation">,</span> <span class="identifier">args</span> <span class="keyword">as</span> <span class="identifier">cli</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">get_images</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">control_helper</span> <span class="keyword">import</span> <span class="identifier">ControlPanelOption</span>

<span class="identifier">logger</span> <span class="arithmetic-assignment">=</span> <span class="identifier">logging</span><span class="punctuation">.</span><span class="identifier">getLogger</span><span class="grouping">(</span><span class="identifier">__name__</span><span class="grouping">)</span>  <span class="comment"># pylint: disable=invalid-name</span>


<span class="keyword">class</span> <span class="identifier">CliOptions</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">""" Class and methods for the command line options """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initializing %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">categories</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="string-literal">"faceswap", "tools"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">commands</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">opts</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">build_options</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initialized %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">build_options</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Get the commands that belong to each category """</span>
        <span class="keyword">for</span> <span class="identifier">category</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">categories</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building '%s'"</span><span class="punctuation">,</span> <span class="identifier">category</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">category</span> <span class="relational-operator">==</span> <span class="string-literal">"tools"</span><span class="punctuation">:</span>
                <span class="identifier">mod_classes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_get_tools_cli_classes</span><span class="grouping">(</span><span class="grouping">)</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">commands</span><span class="grouping">[</span><span class="identifier">category</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">sort_commands</span><span class="grouping">(</span><span class="identifier">category</span><span class="punctuation">,</span> <span class="identifier">mod_classes</span><span class="grouping">)</span>
                <span class="keyword">for</span> <span class="identifier">tool</span> <span class="relational-operator">in</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">mod_classes</span><span class="grouping">)</span><span class="punctuation">:</span>
                    <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">opts</span><span class="punctuation">.</span><span class="identifier">update</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">extract_options</span><span class="grouping">(</span><span class="identifier">mod_classes</span><span class="grouping">[</span><span class="identifier">tool</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="identifier">tool</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="identifier">mod_classes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">get_cli_classes</span><span class="grouping">(</span><span class="identifier">cli</span><span class="grouping">)</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">commands</span><span class="grouping">[</span><span class="identifier">category</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">sort_commands</span><span class="grouping">(</span><span class="identifier">category</span><span class="punctuation">,</span> <span class="identifier">mod_classes</span><span class="grouping">)</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">opts</span><span class="punctuation">.</span><span class="identifier">update</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">extract_options</span><span class="grouping">(</span><span class="identifier">cli</span><span class="punctuation">,</span> <span class="identifier">mod_classes</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built '%s'"</span><span class="punctuation">,</span> <span class="identifier">category</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">get_cli_classes</span><span class="grouping">(</span><span class="identifier">cli_source</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Parse the cli scripts for the argument classes """</span>
        <span class="identifier">mod_classes</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
        <span class="keyword">for</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">obj</span> <span class="relational-operator">in</span> <span class="identifier">inspect</span><span class="punctuation">.</span><span class="identifier">getmembers</span><span class="grouping">(</span><span class="identifier">cli_source</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">inspect</span><span class="punctuation">.</span><span class="identifier">isclass</span><span class="grouping">(</span><span class="identifier">obj</span><span class="grouping">)</span> <span class="logical-operator">and</span> <span class="identifier">name</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">endswith</span><span class="grouping">(</span><span class="string-literal">"args"</span><span class="grouping">)</span> <span class="invalid">\</span>
                    <span class="logical-operator">and</span> <span class="identifier">name</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="grouping">(</span><span class="string-literal">"faceswapargs"</span><span class="punctuation">,</span>
                                              <span class="string-literal">"extractconvertargs"</span><span class="punctuation">,</span>
                                              <span class="string-literal">"guiargs"</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">mod_classes</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">name</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="identifier">mod_classes</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">mod_classes</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">_get_tools_cli_classes</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Parse the tools cli scripts for the argument classes """</span>
        <span class="identifier">base_path</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">realpath</span><span class="grouping">(</span><span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">sys</span><span class="punctuation">.</span><span class="identifier">argv</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">tools_dir</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">base_path</span><span class="punctuation">,</span> <span class="string-literal">"tools"</span><span class="grouping">)</span>
        <span class="identifier">mod_classes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">tool_name</span> <span class="relational-operator">in</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">listdir</span><span class="grouping">(</span><span class="identifier">tools_dir</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">cli_file</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">tools_dir</span><span class="punctuation">,</span> <span class="identifier">tool_name</span><span class="punctuation">,</span> <span class="string-literal">"cli.py"</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">exists</span><span class="grouping">(</span><span class="identifier">cli_file</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">mod</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">".".join(("tools", tool_name, "cli"</span><span class="grouping">)</span><span class="grouping">)</span>
                <span class="identifier">mod_classes</span><span class="grouping">[</span><span class="string-literal">"{}Args"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">tool_name</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="invalid">i</span><span class="invalid">m</span><span class="invalid">p</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">m</span><span class="invalid">o</span><span class="invalid">d</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">mod</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">mod_classes</span>

    <span class="keyword">def</span> <span class="identifier">sort_commands</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">category</span><span class="punctuation">,</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">e</span><span class="invalid">s</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Format classes into command names and sort:
            Specific workflow order for faceswap.
            Alphabetical for all others """</span>
        <span class="identifier">commands</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">c</span><span class="invalid">o</span><span class="invalid">m</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">n</span><span class="invalid">d</span><span class="invalid">_</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">command</span><span class="grouping">)</span>
                          <span class="keyword">for</span> <span class="identifier">command</span> <span class="relational-operator">in</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">e</span><span class="invalid">s</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">category</span> <span class="relational-operator">==</span> <span class="string-literal">"faceswap"</span><span class="punctuation">:</span>
            <span class="identifier">ordered</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">"extract", "train", "convert"</span><span class="grouping">]</span>
            <span class="identifier">commands</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ordered</span> <span class="arithmetic-operator">+</span> <span class="grouping">[</span><span class="identifier">command</span> <span class="keyword">for</span> <span class="identifier">command</span> <span class="relational-operator">in</span> <span class="identifier">commands</span>
                                  <span class="keyword">if</span> <span class="identifier">command</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="identifier">ordered</span><span class="grouping">]</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="identifier">commands</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">commands</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">c</span><span class="invalid">o</span><span class="invalid">m</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">n</span><span class="invalid">d</span><span class="invalid">_</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="grouping">(</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Format args class name to command """</span>
        <span class="keyword">return</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">4</span><span class="grouping">]</span>

    <span class="keyword">def</span> <span class="identifier">extract_options</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">cli_source</span><span class="punctuation">,</span> <span class="identifier">mod_classes</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Extract the existing ArgParse Options
            into master options Dictionary """</span>
        <span class="identifier">subopts</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span> <span class="relational-operator">in</span> <span class="identifier">mod_classes</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Processing: (classname: '%s')"</span><span class="punctuation">,</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="grouping">)</span>
            <span class="identifier">command</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">c</span><span class="invalid">o</span><span class="invalid">m</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">n</span><span class="invalid">d</span><span class="invalid">_</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="grouping">(</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="grouping">)</span>
            <span class="identifier">info</span><span class="punctuation">,</span> <span class="identifier">options</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">get_cli_arguments</span><span class="grouping">(</span><span class="identifier">cli_source</span><span class="punctuation">,</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span>
            <span class="identifier">options</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">process_options</span><span class="grouping">(</span><span class="identifier">options</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span>
            <span class="identifier">options</span><span class="grouping">[</span><span class="string-literal">"helptext"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">info</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Processed: (classname: '%s', command: '%s', options: %s)"</span><span class="punctuation">,</span>
                         <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="punctuation">,</span> <span class="identifier">options</span><span class="grouping">)</span>
            <span class="identifier">subopts</span><span class="grouping">[</span><span class="identifier">command</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">options</span>
        <span class="keyword">return</span> <span class="identifier">subopts</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">get_cli_arguments</span><span class="grouping">(</span><span class="identifier">cli_source</span><span class="punctuation">,</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Extract the options from the main and tools cli files """</span>
        <span class="identifier">meth</span> <span class="arithmetic-assignment">=</span> <span class="identifier">getattr</span><span class="grouping">(</span><span class="identifier">cli_source</span><span class="punctuation">,</span> <span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">n</span><span class="invalid">a</span><span class="invalid">m</span><span class="invalid">e</span><span class="grouping">)</span><span class="grouping">(</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">meth</span><span class="punctuation">.</span><span class="identifier">info</span><span class="punctuation">,</span> <span class="identifier">meth</span><span class="punctuation">.</span><span class="identifier">argument_list</span> <span class="arithmetic-operator">+</span> <span class="identifier">meth</span><span class="punctuation">.</span><span class="identifier">optional_arguments</span> <span class="arithmetic-operator">+</span> <span class="identifier">meth</span><span class="punctuation">.</span><span class="invalid">g</span><span class="invalid">l</span><span class="invalid">o</span><span class="invalid">b</span><span class="invalid">a</span><span class="invalid">l</span><span class="invalid">_</span><span class="invalid">a</span><span class="invalid">r</span><span class="invalid">g</span><span class="invalid">u</span><span class="invalid">m</span><span class="invalid">e</span><span class="invalid">n</span><span class="invalid">t</span><span class="invalid">s</span>

    <span class="keyword">def</span> <span class="identifier">process_options</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command_options</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Process the options for a single command """</span>
        <span class="identifier">gui_options</span> <span class="arithmetic-assignment">=</span> <span class="identifier">OrderedDict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">opt</span> <span class="relational-operator">in</span> <span class="identifier">command_options</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Processing: %s"</span><span class="punctuation">,</span> <span class="identifier">opt</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"help", ""</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="identifier">SUPPRESS</span><span class="punctuation">:</span>
                <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Skipping suppressed option: %s"</span><span class="punctuation">,</span> <span class="identifier">opt</span><span class="grouping">)</span>
                <span class="keyword">continue</span>
            <span class="identifier">title</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">set_control_title</span><span class="grouping">(</span><span class="identifier">opt</span><span class="grouping">[</span><span class="string-literal">"opts"</span><span class="grouping">]</span><span class="grouping">)</span>
            <span class="identifier">cpanel_option</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ControlPanelOption</span><span class="grouping">(</span>
                <span class="identifier">title</span><span class="punctuation">,</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">get_data_type</span><span class="grouping">(</span><span class="identifier">opt</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">group</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"group"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"default"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">choices</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"choices"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">is_radio</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"action", ""</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">Radio</span><span class="punctuation">,</span>
                <span class="identifier">is_multi_option</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"action", ""</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">MultiOption</span><span class="punctuation">,</span>
                <span class="identifier">rounding</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">get_rounding</span><span class="grouping">(</span><span class="identifier">opt</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">min_max</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"min_max"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">sysbrowser</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">get_sysbrowser</span><span class="grouping">(</span><span class="identifier">opt</span><span class="punctuation">,</span> <span class="identifier">command_options</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">helptext</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="grouping">[</span><span class="string-literal">"help"</span><span class="grouping">]</span><span class="punctuation">,</span>
                <span class="identifier">track_modified</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span>
                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">command</span><span class="grouping">)</span>
            <span class="identifier">gui_options</span><span class="grouping">[</span><span class="identifier">title</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">cpanel_option</span><span class="arithmetic-assignment">=</span><span class="identifier">cpanel_option</span><span class="punctuation">,</span>
                                      <span class="identifier">opts</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="grouping">[</span><span class="string-literal">"opts"</span><span class="grouping">]</span><span class="punctuation">,</span>
                                      <span class="identifier">nargs</span><span class="arithmetic-assignment">=</span><span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"nargs"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">trace</span><span class="grouping">(</span><span class="string-literal">"Processed: %s"</span><span class="punctuation">,</span> <span class="identifier">gui_options</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">gui_options</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">set_control_title</span><span class="grouping">(</span><span class="identifier">opts</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Take the option switch and format it nicely """</span>
        <span class="identifier">ctltitle</span> <span class="arithmetic-assignment">=</span> <span class="identifier">opts</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span> <span class="keyword">if</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">opts</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="int-literal">2</span> <span class="keyword">else</span> <span class="identifier">opts</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
        <span class="identifier">ctltitle</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ctltitle</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">"-", " ").replace("_", " "</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">ctltitle</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">get_data_type</span><span class="grouping">(</span><span class="identifier">opt</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Return a datatype for passing into control_helper.py to get the correct control """</span>
        <span class="keyword">if</span> <span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"type", None) is not None and isinstance(opt["type"</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">type</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">opt</span><span class="grouping">[</span><span class="string-literal">"type"</span><span class="grouping">]</span>
        <span class="keyword">elif</span> <span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"action", "") in ("store_true", "store_false"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">bool</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">str</span>
        <span class="keyword">return</span> <span class="identifier">retval</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">get_rounding</span><span class="grouping">(</span><span class="identifier">opt</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Return rounding if correct data type, else None """</span>
        <span class="identifier">dtype</span> <span class="arithmetic-assignment">=</span> <span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"type"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">dtype</span> <span class="relational-operator">==</span> <span class="identifier">float</span><span class="punctuation">:</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"rounding"</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">dtype</span> <span class="relational-operator">==</span> <span class="identifier">int</span><span class="punctuation">:</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"rounding"</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
        <span class="keyword">return</span> <span class="identifier">retval</span>

    <span class="keyword">def</span> <span class="identifier">get_sysbrowser</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">option</span><span class="punctuation">,</span> <span class="identifier">options</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Return the system file browser and file types if required else None """</span>
        <span class="identifier">action</span> <span class="arithmetic-assignment">=</span> <span class="identifier">option</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"action"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">action</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">DirFullPaths</span><span class="punctuation">,</span>
                          <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">FileFullPaths</span><span class="punctuation">,</span>
                          <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">FilesFullPaths</span><span class="punctuation">,</span>
                          <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">DirOrFileFullPaths</span><span class="punctuation">,</span>
                          <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">SaveFileFullPaths</span><span class="punctuation">,</span>
                          <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">ContextFullPaths</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">return</span> <span class="none-literal">None</span>

        <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">action_option</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
        <span class="keyword">if</span> <span class="identifier">option</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"action_option"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">expand_action_option</span><span class="grouping">(</span><span class="identifier">option</span><span class="punctuation">,</span> <span class="identifier">options</span><span class="grouping">)</span>
            <span class="identifier">action_option</span> <span class="arithmetic-assignment">=</span> <span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"action_option"</span><span class="grouping">]</span>
        <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"filetypes"] = option.get("filetypes", "default"</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">FileFullPaths</span><span class="punctuation">:</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"browser"] = ["load"</span><span class="grouping">]</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">FilesFullPaths</span><span class="punctuation">:</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"browser"] = ["multi_load"</span><span class="grouping">]</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">SaveFileFullPaths</span><span class="punctuation">:</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"browser"] = ["save"</span><span class="grouping">]</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">DirOrFileFullPaths</span><span class="punctuation">:</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"browser"] = ["folder", "load"</span><span class="grouping">]</span>
        <span class="keyword">elif</span> <span class="identifier">action</span> <span class="relational-operator">==</span> <span class="identifier">actions</span><span class="punctuation">.</span><span class="identifier">ContextFullPaths</span> <span class="logical-operator">and</span> <span class="identifier">action_option</span><span class="punctuation">:</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"browser"] = ["context"</span><span class="grouping">]</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"command"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">command</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"action_option"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">action_option</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"destination"] = option.get("dest", option["opts"][1].replace("--", ""</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">retval</span><span class="grouping">[</span><span class="string-literal">"browser"] = ["folder"</span><span class="grouping">]</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="identifier">retval</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">retval</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">expand_action_option</span><span class="grouping">(</span><span class="identifier">option</span><span class="punctuation">,</span> <span class="identifier">options</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Expand the action option to the full command name """</span>
        <span class="identifier">opts</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="identifier">opt</span><span class="grouping">[</span><span class="string-literal">"opts"][0]: opt["opts"</span><span class="grouping">]</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span>
                <span class="keyword">for</span> <span class="identifier">opt</span> <span class="relational-operator">in</span> <span class="identifier">options</span><span class="grouping">}</span>
        <span class="identifier">old_val</span> <span class="arithmetic-assignment">=</span> <span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"action_option"</span><span class="grouping">]</span>
        <span class="identifier">new_val</span> <span class="arithmetic-assignment">=</span> <span class="identifier">opts</span><span class="grouping">[</span><span class="identifier">old_val</span><span class="grouping">]</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Updating action option from '%s' to '%s'"</span><span class="punctuation">,</span> <span class="identifier">old_val</span><span class="punctuation">,</span> <span class="identifier">new_val</span><span class="grouping">)</span>
        <span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"action_option"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">new_val</span>

    <span class="keyword">def</span> <span class="identifier">gen_command_options</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Yield each option for specified command """</span>
        <span class="keyword">for</span> <span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">val</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">opts</span><span class="grouping">[</span><span class="identifier">command</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">isinstance</span><span class="grouping">(</span><span class="identifier">val</span><span class="punctuation">,</span> <span class="identifier">dict</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="keyword">continue</span>
            <span class="keyword">yield</span> <span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">val</span>

    <span class="keyword">def</span> <span class="identifier">options_to_process</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Return a consistent object for processing regardless of whether processing all commands
            or just one command for reset and clear. Removes helptext from return value """</span>
        <span class="keyword">if</span> <span class="identifier">command</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">options</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">opt</span> <span class="keyword">for</span> <span class="identifier">opts</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">opts</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span>
                       <span class="keyword">for</span> <span class="identifier">opt</span> <span class="relational-operator">in</span> <span class="identifier">opts</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span> <span class="keyword">if</span> <span class="identifier">isinstance</span><span class="grouping">(</span><span class="identifier">opt</span><span class="punctuation">,</span> <span class="identifier">dict</span><span class="grouping">)</span><span class="grouping">]</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">options</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">opt</span> <span class="keyword">for</span> <span class="identifier">opt</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">opts</span><span class="grouping">[</span><span class="identifier">command</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">(</span><span class="grouping">)</span> <span class="keyword">if</span> <span class="identifier">isinstance</span><span class="grouping">(</span><span class="identifier">opt</span><span class="punctuation">,</span> <span class="identifier">dict</span><span class="grouping">)</span><span class="grouping">]</span>
        <span class="keyword">return</span> <span class="identifier">options</span>

    <span class="keyword">def</span> <span class="identifier">reset</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Reset the options for all or passed command
            back to default value """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Resetting options to default. (command: '%s'"</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">option</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">options_to_process</span><span class="grouping">(</span><span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">cp_opt</span> <span class="arithmetic-assignment">=</span> <span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"cpanel_option"</span><span class="grouping">]</span>
            <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span> <span class="keyword">if</span> <span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span> <span class="relational-operator">is</span> <span class="none-literal">None</span> <span class="keyword">else</span> <span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span>
            <span class="keyword">if</span> <span class="grouping">(</span><span class="identifier">option</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"nargs"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span>
                    <span class="logical-operator">and</span> <span class="identifier">isinstance</span><span class="grouping">(</span><span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="identifier">list</span><span class="punctuation">,</span> <span class="identifier">tuple</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">' '</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">str</span><span class="grouping">(</span><span class="identifier">val</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">val</span> <span class="relational-operator">in</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="grouping">)</span>
            <span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">clear</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Clear the options values for all or passed commands """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Clearing options. (command: '%s'"</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">option</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">options_to_process</span><span class="grouping">(</span><span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">cp_opt</span> <span class="arithmetic-assignment">=</span> <span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"cpanel_option"</span><span class="grouping">]</span>
            <span class="keyword">if</span> <span class="identifier">isinstance</span><span class="grouping">(</span><span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">bool</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">False</span><span class="grouping">)</span>
            <span class="keyword">elif</span> <span class="identifier">isinstance</span><span class="grouping">(</span><span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">float</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="identifier">cp_opt</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="string-literal">""</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">get_option_values</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Return all or single command control titles with the associated tk_var value """</span>
        <span class="identifier">ctl_dict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">cmd</span><span class="punctuation">,</span> <span class="identifier">opts</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">opts</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">command</span> <span class="logical-operator">and</span> <span class="identifier">command</span> <span class="relational-operator">!=</span> <span class="identifier">cmd</span><span class="punctuation">:</span>
                <span class="keyword">continue</span>
            <span class="identifier">cmd_dict</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="keyword">for</span> <span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">val</span> <span class="relational-operator">in</span> <span class="identifier">opts</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">isinstance</span><span class="grouping">(</span><span class="identifier">val</span><span class="punctuation">,</span> <span class="identifier">dict</span><span class="grouping">)</span><span class="punctuation">:</span>
                    <span class="keyword">continue</span>
                <span class="identifier">cmd_dict</span><span class="grouping">[</span><span class="identifier">key</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">val</span><span class="grouping">[</span><span class="string-literal">"cpanel_option"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="identifier">ctl_dict</span><span class="grouping">[</span><span class="identifier">cmd</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd_dict</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"command: '%s', ctl_dict: %s"</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="punctuation">,</span> <span class="identifier">ctl_dict</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">ctl_dict</span>

    <span class="keyword">def</span> <span class="identifier">get_one_option_variable</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="punctuation">,</span> <span class="identifier">title</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Return a single tk_var for the specified
            command and control_title """</span>
        <span class="keyword">for</span> <span class="identifier">opt_title</span><span class="punctuation">,</span> <span class="identifier">option</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">gen_command_options</span><span class="grouping">(</span><span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">opt_title</span> <span class="relational-operator">==</span> <span class="identifier">title</span><span class="punctuation">:</span>
                <span class="keyword">return</span> <span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"cpanel_option"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">tk_var</span>
        <span class="keyword">return</span> <span class="none-literal">None</span>

    <span class="keyword">def</span> <span class="identifier">gen_cli_arguments</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Return the generated cli arguments for the selected command """</span>
        <span class="keyword">for</span> <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">option</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">gen_command_options</span><span class="grouping">(</span><span class="identifier">command</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">optval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">str</span><span class="grouping">(</span><span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"cpanel_option"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">opt</span> <span class="arithmetic-assignment">=</span> <span class="identifier">option</span><span class="grouping">[</span><span class="string-literal">"opts"</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
            <span class="keyword">if</span> <span class="identifier">command</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"extract", "convert") and opt == "-o"</span><span class="punctuation">:</span>
                <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">set_faceswap_output_path</span><span class="grouping">(</span><span class="identifier">optval</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">optval</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"False", ""</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="keyword">continue</span>
            <span class="keyword">if</span> <span class="identifier">optval</span> <span class="relational-operator">==</span> <span class="string-literal">"True"</span><span class="punctuation">:</span>
                <span class="keyword">yield</span> <span class="grouping">(</span><span class="identifier">opt</span><span class="punctuation">,</span> <span class="grouping">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="keyword">if</span> <span class="identifier">option</span><span class="punctuation">.</span><span class="identifier">get</span><span class="grouping">(</span><span class="string-literal">"nargs"</span><span class="punctuation">,</span> <span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
                    <span class="keyword">if</span> <span class="string-literal">"\""</span> <span class="relational-operator">in</span> <span class="identifier">optval</span><span class="punctuation">:</span>
                        <span class="identifier">optval</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">arg</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span> <span class="keyword">for</span> <span class="identifier">arg</span> <span class="relational-operator">in</span> <span class="identifier">re</span><span class="punctuation">.</span><span class="identifier">findall</span><span class="grouping">(</span><span class="identifier">r</span><span class="string-literal">"\".+?\""</span><span class="punctuation">,</span> <span class="identifier">optval</span><span class="grouping">)</span><span class="grouping">]</span>
                    <span class="keyword">else</span><span class="punctuation">:</span>
                        <span class="identifier">optval</span> <span class="arithmetic-assignment">=</span> <span class="identifier">optval</span><span class="punctuation">.</span><span class="identifier">split</span><span class="grouping">(</span><span class="string-literal">" "</span><span class="grouping">)</span>
                    <span class="identifier">opt</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">opt</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">optval</span>
                <span class="keyword">else</span><span class="punctuation">:</span>
                    <span class="identifier">opt</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">opt</span><span class="punctuation">,</span> <span class="identifier">optval</span><span class="grouping">)</span>
                <span class="keyword">yield</span> <span class="identifier">opt</span>

    </pre>
  </body>
</html>