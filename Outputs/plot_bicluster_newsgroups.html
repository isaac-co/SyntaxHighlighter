<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
================================================================
Biclustering documents with the Spectral Co-clustering algorithm
================================================================

This example demonstrates the Spectral Co-clustering algorithm on the
twenty newsgroups dataset. The 'comp.os.ms-windows.misc' category is
excluded because it contains many posts containing nothing but data.

The TF-IDF vectorized posts form a word frequency matrix, which is
then biclustered using Dhillon's Spectral Co-Clustering algorithm. The
resulting document-word biclusters indicate subsets words used more
often in those subsets documents.

For a few of the best biclusters, its most common document categories
and its ten most important words get printed. The best biclusters are
determined by their normalized cut. The best words are determined by
comparing their sums inside and outside the bicluster.

For comparison, the documents are also clustered using
MiniBatchKMeans. The document clusters derived from the biclusters
achieve a better V-measure than clusters found by MiniBatchKMeans.

"""</span>
<span class="keyword">from</span> <span class="identifier">collections</span> <span class="keyword">import</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="invalid">d</span><span class="invalid">i</span><span class="invalid">c</span><span class="invalid">t</span>
<span class="keyword">import</span> <span class="identifier">operator</span>
<span class="keyword">from</span> <span class="identifier">time</span> <span class="keyword">import</span> <span class="identifier">time</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>

<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">cluster</span> <span class="keyword">import</span> <span class="identifier">SpectralCoclustering</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">cluster</span> <span class="keyword">import</span> <span class="identifier">MiniBatchKMeans</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">datasets</span> <span class="keyword">import</span> <span class="identifier">fetch_20newsgroups</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">feature_extraction</span><span class="punctuation">.</span><span class="identifier">text</span> <span class="keyword">import</span> <span class="identifier">TfidfVectorizer</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">metrics</span><span class="punctuation">.</span><span class="identifier">cluster</span> <span class="keyword">import</span> <span class="identifier">v_measure_score</span>

<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">__doc__</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">number_normalizer</span><span class="grouping">(</span><span class="identifier">tokens</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">""" Map all numeric tokens to a placeholder.

    For many applications, tokens that begin with a number are not directly
    useful, but the fact that such a token exists can be relevant.  By applying
    this form of dimensionality reduction, some methods may perform better.
    """</span>
    <span class="keyword">return</span> <span class="grouping">(</span><span class="string-literal">"#NUMBER"</span> <span class="keyword">if</span> <span class="identifier">token</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">isdigit</span><span class="grouping">(</span><span class="grouping">)</span> <span class="keyword">else</span> <span class="identifier">token</span> <span class="keyword">for</span> <span class="identifier">token</span> <span class="relational-operator">in</span> <span class="identifier">tokens</span><span class="grouping">)</span>


<span class="keyword">class</span> <span class="identifier">NumberNormalizingVectorizer</span><span class="grouping">(</span><span class="identifier">TfidfVectorizer</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="keyword">def</span> <span class="identifier">build_tokenizer</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">tokenize</span> <span class="arithmetic-assignment">=</span> <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">build_tokenizer</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="keyword">lambda</span> <span class="identifier">doc</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">number_normalizer</span><span class="grouping">(</span><span class="identifier">tokenize</span><span class="grouping">(</span><span class="identifier">doc</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>


<span class="comment"># exclude 'comp.os.ms-windows.misc'</span>
<span class="identifier">categories</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'alt.atheism', 'comp.graphics'</span><span class="punctuation">,</span>
              <span class="string-literal">'comp.sys.ibm.pc.hardware', 'comp.sys.mac.hardware'</span><span class="punctuation">,</span>
              <span class="string-literal">'comp.windows.x', 'misc.forsale', 'rec.autos'</span><span class="punctuation">,</span>
              <span class="string-literal">'rec.motorcycles', 'rec.sport.baseball'</span><span class="punctuation">,</span>
              <span class="string-literal">'rec.sport.hockey', 'sci.crypt', 'sci.electronics'</span><span class="punctuation">,</span>
              <span class="string-literal">'sci.med', 'sci.space', 'soc.religion.christian'</span><span class="punctuation">,</span>
              <span class="string-literal">'talk.politics.guns', 'talk.politics.mideast'</span><span class="punctuation">,</span>
              <span class="string-literal">'talk.politics.misc', 'talk.religion.misc'</span><span class="grouping">]</span>
<span class="identifier">newsgroups</span> <span class="arithmetic-assignment">=</span> <span class="identifier">fetch_20newsgroups</span><span class="grouping">(</span><span class="identifier">categories</span><span class="arithmetic-assignment">=</span><span class="identifier">categories</span><span class="grouping">)</span>
<span class="identifier">y_true</span> <span class="arithmetic-assignment">=</span> <span class="identifier">newsgroups</span><span class="punctuation">.</span><span class="identifier">target</span>

<span class="identifier">vectorizer</span> <span class="arithmetic-assignment">=</span> <span class="identifier">NumberNormalizingVectorizer</span><span class="grouping">(</span><span class="identifier">stop_words</span><span class="arithmetic-assignment">=</span><span class="string-literal">'english'</span><span class="punctuation">,</span> <span class="identifier">min_df</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="grouping">)</span>
<span class="identifier">cocluster</span> <span class="arithmetic-assignment">=</span> <span class="identifier">SpectralCoclustering</span><span class="grouping">(</span><span class="identifier">n_clusters</span><span class="arithmetic-assignment">=</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">categories</span><span class="grouping">)</span><span class="punctuation">,</span>
                                 <span class="identifier">svd_method</span><span class="arithmetic-assignment">=</span><span class="string-literal">'arpack'</span><span class="punctuation">,</span> <span class="identifier">random_state</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
<span class="identifier">kmeans</span> <span class="arithmetic-assignment">=</span> <span class="identifier">MiniBatchKMeans</span><span class="grouping">(</span><span class="identifier">n_clusters</span><span class="arithmetic-assignment">=</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">categories</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">batch_size</span><span class="arithmetic-assignment">=</span><span class="int-literal">20000</span><span class="punctuation">,</span>
                         <span class="identifier">random_state</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>

<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Vectorizing..."</span><span class="grouping">)</span>
<span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">vectorizer</span><span class="punctuation">.</span><span class="identifier">fit_transform</span><span class="grouping">(</span><span class="identifier">newsgroups</span><span class="punctuation">.</span><span class="identifier">data</span><span class="grouping">)</span>

<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Coclustering..."</span><span class="grouping">)</span>
<span class="identifier">start_time</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
<span class="identifier">y_cocluster</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">row_labels_</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Done in {:.2f}s. V-measure: {:.4f}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span>
    <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span> <span class="arithmetic-operator">-</span> <span class="identifier">start_time</span><span class="punctuation">,</span>
    <span class="identifier">v_measure_score</span><span class="grouping">(</span><span class="identifier">y_cocluster</span><span class="punctuation">,</span> <span class="identifier">y_true</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"MiniBatchKMeans..."</span><span class="grouping">)</span>
<span class="identifier">start_time</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">y_kmeans</span> <span class="arithmetic-assignment">=</span> <span class="identifier">kmeans</span><span class="punctuation">.</span><span class="identifier">fit_predict</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Done in {:.2f}s. V-measure: {:.4f}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span>
    <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span> <span class="arithmetic-operator">-</span> <span class="identifier">start_time</span><span class="punctuation">,</span>
    <span class="identifier">v_measure_score</span><span class="grouping">(</span><span class="identifier">y_kmeans</span><span class="punctuation">,</span> <span class="identifier">y_true</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">feature_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">vectorizer</span><span class="punctuation">.</span><span class="identifier">get_feature_names</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">document_names</span> <span class="arithmetic-assignment">=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">newsgroups</span><span class="punctuation">.</span><span class="identifier">target_names</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span> <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">newsgroups</span><span class="punctuation">.</span><span class="identifier">target</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">bicluster_ncut</span><span class="grouping">(</span><span class="identifier">i</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">rows</span><span class="punctuation">,</span> <span class="identifier">cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">get_indices</span><span class="grouping">(</span><span class="identifier">i</span><span class="grouping">)</span>
    <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">any</span><span class="grouping">(</span><span class="identifier">rows</span><span class="grouping">)</span> <span class="logical-operator">and</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">any</span><span class="grouping">(</span><span class="identifier">cols</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">import</span> <span class="identifier">sys</span>
        <span class="keyword">return</span> <span class="identifier">sys</span><span class="punctuation">.</span><span class="identifier">float_info</span><span class="punctuation">.</span><span class="identifier">max</span>
    <span class="identifier">row_complement</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">nonzero</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">logical_not</span><span class="grouping">(</span><span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">rows_</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
    <span class="identifier">col_complement</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">nonzero</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">logical_not</span><span class="grouping">(</span><span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">columns_</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
    <span class="comment"># Note: the following is identical to X[rows[:, np.newaxis],</span>
    <span class="comment"># cols].sum() but much faster in scipy &lt;= 0.16</span>
    <span class="identifier">weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">rows</span><span class="grouping">]</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">cols</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">cut</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="identifier">row_complement</span><span class="grouping">]</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">cols</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span>
           <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">rows</span><span class="grouping">]</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">col_complement</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">cut</span> <span class="arithmetic-operator">/</span> <span class="identifier">weight</span>


<span class="keyword">def</span> <span class="identifier">most_common</span><span class="grouping">(</span><span class="identifier">d</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Items of a defaultdict(int) with the highest values.

    Like Counter.most_common in Python &gt;=2.7.
    """</span>
    <span class="keyword">return</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">d</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">key</span><span class="arithmetic-assignment">=</span><span class="identifier">operator</span><span class="punctuation">.</span><span class="identifier">itemgetter</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">reverse</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>


<span class="identifier">bicluster_ncuts</span> <span class="arithmetic-assignment">=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">bicluster_ncut</span><span class="grouping">(</span><span class="identifier">i</span><span class="grouping">)</span>
                       <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">newsgroups</span><span class="punctuation">.</span><span class="identifier">target_names</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">best_idx</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">argsort</span><span class="grouping">(</span><span class="identifier">bicluster_ncuts</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="int-literal">5</span><span class="grouping">]</span>

<span class="identifier">print</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Best biclusters:"</span><span class="grouping">)</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"----------------"</span><span class="grouping">)</span>
<span class="keyword">for</span> <span class="identifier">idx</span><span class="punctuation">,</span> <span class="identifier">cluster</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">best_idx</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">n_rows</span><span class="punctuation">,</span> <span class="identifier">n_cols</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">get_shape</span><span class="grouping">(</span><span class="identifier">cluster</span><span class="grouping">)</span>
    <span class="identifier">cluster_docs</span><span class="punctuation">,</span> <span class="identifier">cluster_words</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">get_indices</span><span class="grouping">(</span><span class="identifier">cluster</span><span class="grouping">)</span>
    <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">cluster_docs</span><span class="grouping">)</span> <span class="logical-operator">or</span> <span class="logical-operator">not</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">cluster_words</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">continue</span>

    <span class="comment"># categories</span>
    <span class="identifier">counter</span> <span class="arithmetic-assignment">=</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="invalid">d</span><span class="invalid">i</span><span class="invalid">c</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">int</span><span class="grouping">)</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">cluster_docs</span><span class="punctuation">:</span>
        <span class="identifier">counter</span><span class="grouping">[</span><span class="identifier">document_names</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">]</span> <span class="arithmetic-assignment">+=</span> <span class="int-literal">1</span>
    <span class="identifier">cat_string</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">", ".join("{:.0f}% {}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">float</span><span class="grouping">(</span><span class="identifier">c</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">n_rows</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="grouping">)</span>
                           <span class="keyword">for</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">c</span> <span class="relational-operator">in</span> <span class="identifier">most_common</span><span class="grouping">(</span><span class="identifier">counter</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="int-literal">3</span><span class="grouping">]</span><span class="grouping">)</span>

    <span class="comment"># words</span>
    <span class="identifier">out_of_cluster_docs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cocluster</span><span class="punctuation">.</span><span class="identifier">row_labels_</span> <span class="relational-operator">!=</span> <span class="identifier">cluster</span>
    <span class="identifier">out_of_cluster_docs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">where</span><span class="grouping">(</span><span class="identifier">out_of_cluster_docs</span><span class="grouping">)</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
    <span class="identifier">word_col</span> <span class="arithmetic-assignment">=</span> <span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="identifier">cluster_words</span><span class="grouping">]</span>
    <span class="identifier">word_scores</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="identifier">word_col</span><span class="grouping">[</span><span class="identifier">cluster_docs</span><span class="punctuation">,</span> <span class="punctuation">:</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span> <span class="arithmetic-operator">-</span>
                           <span class="identifier">word_col</span><span class="grouping">[</span><span class="identifier">out_of_cluster_docs</span><span class="punctuation">,</span> <span class="punctuation">:</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">axis</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">word_scores</span> <span class="arithmetic-assignment">=</span> <span class="identifier">word_scores</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="invalid">i</span><span class="invalid">m</span><span class="invalid">p</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">t</span><span class="invalid">a</span><span class="invalid">n</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">w</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">d</span><span class="invalid">s</span> <span class="arithmetic-assignment">=</span> <span class="identifier">list</span><span class="grouping">(</span><span class="identifier">feature_names</span><span class="grouping">[</span><span class="identifier">cluster_words</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">]</span>
                           <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">word_scores</span><span class="punctuation">.</span><span class="identifier">argsort</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">[</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">11</span><span class="punctuation">:</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>

    <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"bicluster {} : {} documents, {} words"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span>
        <span class="identifier">idx</span><span class="punctuation">,</span> <span class="identifier">n_rows</span><span class="punctuation">,</span> <span class="identifier">n_cols</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"categories   : {}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">cat_string</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"words        : {}\n"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="string-literal">', '</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="invalid">i</span><span class="invalid">m</span><span class="invalid">p</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">t</span><span class="invalid">a</span><span class="invalid">n</span><span class="invalid">t</span><span class="invalid">_</span><span class="invalid">w</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">d</span><span class="invalid">s</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>

    </pre>
  </body>
</html>