<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
This script demonstrates the implementation of the Softmax function.

Its a function that takes as input a vector of K real numbers, and normalizes
it into a probability distribution consisting of K probabilities proportional
to the exponentials of the input numbers. After softmax, the elements of the
vector always sum up to 1.

Script inspired from its corresponding Wikipedia article
https://en.wikipedia.org/wiki/Softmax_function
"""</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>


<span class="keyword">def</span> <span class="identifier">softmax</span><span class="grouping">(</span><span class="identifier">vector</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    Implements the softmax function

    Parameters:
        vector (np.array,list,tuple): A  numpy array of shape (1,n)
        consisting of real values or a similar list,tuple


    Returns:
        softmax_vec (np.array): The input numpy array  after applying
        softmax.

    The softmax vector adds up to one. We need to ceil to mitigate for
    precision
    &gt;&gt;&gt; np.ceil(np.sum(softmax([1,2,3,4])))
    1.0

    &gt;&gt;&gt; vec = np.array([5,5])
    &gt;&gt;&gt; softmax(vec)
    array([0.5, 0.5])

    &gt;&gt;&gt; softmax([0])
    array([1.])
    """</span>

    <span class="comment"># Calculate e^x for each x in your vector where e is Euler's</span>
    <span class="comment"># number (approximately 2.718)</span>
    <span class="identifier">exponentVector</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">exp</span><span class="grouping">(</span><span class="identifier">vector</span><span class="grouping">)</span>

    <span class="comment"># Add up the all the exponentials</span>
    <span class="identifier">sumOfExponents</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">exponentVector</span><span class="grouping">)</span>

    <span class="comment"># Divide every exponent by the sum of all exponents</span>
    <span class="identifier">softmax_vector</span> <span class="arithmetic-assignment">=</span> <span class="identifier">exponentVector</span> <span class="arithmetic-operator">/</span> <span class="identifier">sumOfExponents</span>

    <span class="keyword">return</span> <span class="identifier">softmax_vector</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="relational-operator">==</span> <span class="string-literal">"__main__"</span><span class="punctuation">:</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">softmax</span><span class="grouping">(</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>

    </pre>
  </body>
</html>