<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="keyword">from</span> <span class="identifier">itertools</span> <span class="keyword">import</span> <span class="identifier">product</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>

<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span> <span class="keyword">import</span> <span class="identifier">confusion_matrix</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">check_matplotlib_support</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">deprecated</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">utils</span><span class="punctuation">.</span><span class="identifier">multiclass</span> <span class="keyword">import</span> <span class="identifier">unique_labels</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="punctuation">.</span><span class="punctuation">.</span><span class="identifier">base</span> <span class="keyword">import</span> <span class="identifier">is_classifier</span>


<span class="keyword">class</span> <span class="identifier">ConfusionMatrixDisplay</span><span class="punctuation">:</span>
    <span class="comment">"""Confusion Matrix visualization.

    It is recommend to use
    :func:`~sklearn.metrics.ConfusionMatrixDisplay.from_estimator` or
    :func:`~sklearn.metrics.ConfusionMatrixDisplay.from_predictions` to
    create a :class:`ConfusionMatrixDisplay`. All parameters are stored as
    attributes.

    Read more in the :ref:`User Guide &lt;visualizations&gt;`.

    Parameters
    ----------
    confusion_matrix : ndarray of shape (n_classes, n_classes)
        Confusion matrix.

    display_labels : ndarray of shape (n_classes,), default=None
        Display labels for plot. If None, display labels are set from 0 to
        `n_classes - 1`.

    Attributes
    ----------
    im_ : matplotlib AxesImage
        Image representing the confusion matrix.

    text_ : ndarray of shape (n_classes, n_classes), dtype=matplotlib Text, \
            or None
        Array of matplotlib axes. `None` if `include_values` is false.

    ax_ : matplotlib Axes
        Axes with confusion matrix.

    figure_ : matplotlib Figure
        Figure containing the confusion matrix.

    See Also
    --------
    confusion_matrix : Compute Confusion Matrix to evaluate the accuracy of a
        classification.
    ConfusionMatrixDisplay.from_estimator : Plot the confusion matrix
        given an estimator, the data, and the label.
    ConfusionMatrixDisplay.from_predictions : Plot the confusion matrix
        given the true and predicted labels.

    Examples
    --------
    &gt;&gt;&gt; from sklearn.datasets import make_classification
    &gt;&gt;&gt; from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay
    &gt;&gt;&gt; from sklearn.model_selection import train_test_split
    &gt;&gt;&gt; from sklearn.svm import SVC
    &gt;&gt;&gt; X, y = make_classification(random_state=0)
    &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y,
    ...                                                     random_state=0)
    &gt;&gt;&gt; clf = SVC(random_state=0)
    &gt;&gt;&gt; clf.fit(X_train, y_train)
    SVC(random_state=0)
    &gt;&gt;&gt; predictions = clf.predict(X_test)
    &gt;&gt;&gt; cm = confusion_matrix(y_test, predictions, labels=clf.classes_)
    &gt;&gt;&gt; disp = ConfusionMatrixDisplay(confusion_matrix=cm,
    ...                               display_labels=clf.classes_)
    &gt;&gt;&gt; disp.plot() # doctest: +SKIP
    """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">confusion_matrix</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="identifier">display_labels</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">confusion_matrix</span> <span class="arithmetic-assignment">=</span> <span class="identifier">confusion_matrix</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">display_labels</span>

    <span class="keyword">def</span> <span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="identifier">include_values</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="string-literal">'viridis'</span><span class="punctuation">,</span>
             <span class="identifier">xticks_rotation</span><span class="arithmetic-assignment">=</span><span class="string-literal">'horizontal'</span><span class="punctuation">,</span> <span class="identifier">values_format</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
             <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">colorbar</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">"""Plot visualization.

        Parameters
        ----------
        include_values : bool, default=True
            Includes values in confusion matrix.

        cmap : str or matplotlib Colormap, default='viridis'
            Colormap recognized by matplotlib.

        xticks_rotation : {'vertical', 'horizontal'} or float, \
                         default='horizontal'
            Rotation of xtick labels.

        values_format : str, default=None
            Format specification for values in confusion matrix. If `None`,
            the format specification is 'd' or '.2g' whichever is shorter.

        ax : matplotlib axes, default=None
            Axes object to plot on. If `None`, a new figure and axes is
            created.

        colorbar : bool, default=True
            Whether or not to add a colorbar to the plot.

        Returns
        -------
        display : :class:`~sklearn.metrics.ConfusionMatrixDisplay`
        """</span>
        <span class="identifier">check_matplotlib_support</span><span class="grouping">(</span><span class="string-literal">"ConfusionMatrixDisplay.plot"</span><span class="grouping">)</span>
        <span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>

        <span class="keyword">if</span> <span class="identifier">ax</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">fig</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">figure</span>

        <span class="identifier">cm</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">confusion_matrix</span>
        <span class="identifier">n_classes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">im_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">imshow</span><span class="grouping">(</span><span class="identifier">cm</span><span class="punctuation">,</span> <span class="identifier">interpolation</span><span class="arithmetic-assignment">=</span><span class="string-literal">'nearest'</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">text_</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
        <span class="identifier">cmap_min</span><span class="punctuation">,</span> <span class="identifier">cmap_max</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">im_</span><span class="punctuation">.</span><span class="identifier">cmap</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">im_</span><span class="punctuation">.</span><span class="identifier">cmap</span><span class="grouping">(</span><span class="int-literal">256</span><span class="grouping">)</span>

        <span class="keyword">if</span> <span class="identifier">include_values</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">text_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">empty_like</span><span class="grouping">(</span><span class="identifier">cm</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">object</span><span class="grouping">)</span>

            <span class="comment"># print text with appropriate color depending on background</span>
            <span class="identifier">thresh</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">max</span><span class="grouping">(</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">min</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="float-literal">2.0</span>

            <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">product</span><span class="grouping">(</span><span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">color</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmap_max</span> <span class="keyword">if</span> <span class="identifier">cm</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="relational-operator">&lt;</span> <span class="identifier">thresh</span> <span class="keyword">else</span> <span class="identifier">cmap_min</span>

                <span class="keyword">if</span> <span class="identifier">values_format</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
                    <span class="identifier">text_cm</span> <span class="arithmetic-assignment">=</span> <span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">cm</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="string-literal">'.2g'</span><span class="grouping">)</span>
                    <span class="keyword">if</span> <span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">dtype</span><span class="punctuation">.</span><span class="identifier">kind</span> <span class="relational-operator">!=</span> <span class="string-literal">'f'</span><span class="punctuation">:</span>
                        <span class="identifier">text_d</span> <span class="arithmetic-assignment">=</span> <span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">cm</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="string-literal">'d'</span><span class="grouping">)</span>
                        <span class="keyword">if</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">text_d</span><span class="grouping">)</span> <span class="relational-operator">&lt;</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">text_cm</span><span class="grouping">)</span><span class="punctuation">:</span>
                            <span class="identifier">text_cm</span> <span class="arithmetic-assignment">=</span> <span class="identifier">text_d</span>
                <span class="keyword">else</span><span class="punctuation">:</span>
                    <span class="identifier">text_cm</span> <span class="arithmetic-assignment">=</span> <span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">cm</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">values_format</span><span class="grouping">)</span>

                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">text_</span><span class="grouping">[</span><span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">text</span><span class="grouping">(</span>
                    <span class="identifier">j</span><span class="punctuation">,</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">text_cm</span><span class="punctuation">,</span>
                    <span class="identifier">ha</span><span class="arithmetic-assignment">=</span><span class="string-literal">"center", va="center"</span><span class="punctuation">,</span>
                    <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="identifier">color</span><span class="grouping">)</span>

        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_labels</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">display_labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arange</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">display_labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">display_labels</span>
        <span class="keyword">if</span> <span class="identifier">colorbar</span><span class="punctuation">:</span>
            <span class="identifier">fig</span><span class="punctuation">.</span><span class="identifier">colorbar</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">im_</span><span class="punctuation">,</span> <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="identifier">ax</span><span class="grouping">)</span>
        <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="identifier">xticks</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arange</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span><span class="punctuation">,</span>
               <span class="identifier">yticks</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arange</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span><span class="punctuation">,</span>
               <span class="identifier">xticklabels</span><span class="arithmetic-assignment">=</span><span class="identifier">display_labels</span><span class="punctuation">,</span>
               <span class="identifier">yticklabels</span><span class="arithmetic-assignment">=</span><span class="identifier">display_labels</span><span class="punctuation">,</span>
               <span class="identifier">ylabel</span><span class="arithmetic-assignment">=</span><span class="string-literal">"True label"</span><span class="punctuation">,</span>
               <span class="identifier">xlabel</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Predicted label"</span><span class="grouping">)</span>

        <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_ylim</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">n_classes</span> <span class="arithmetic-operator">-</span> <span class="float-literal">0.5</span><span class="punctuation">,</span> <span class="float-literal">-0.5</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">setp</span><span class="grouping">(</span><span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">get_xticklabels</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">rotation</span><span class="arithmetic-assignment">=</span><span class="identifier">xticks_rotation</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">figure_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">fig</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">ax_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ax</span>
        <span class="keyword">return</span> <span class="identifier">self</span>

    <span class="punctuation">@</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">m</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">h</span><span class="invalid">o</span><span class="invalid">d</span>
    <span class="keyword">def</span> <span class="invalid">f</span><span class="invalid">r</span><span class="invalid">o</span><span class="invalid">m</span><span class="invalid">_</span><span class="invalid">e</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">i</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="invalid">o</span><span class="invalid">r</span><span class="grouping">(</span>
        <span class="identifier">cls</span><span class="punctuation">,</span>
        <span class="identifier">estimator</span><span class="punctuation">,</span>
        <span class="identifier">X</span><span class="punctuation">,</span>
        <span class="identifier">y</span><span class="punctuation">,</span>
        <span class="arithmetic-operator">*</span><span class="punctuation">,</span>
        <span class="identifier">labels</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">sample_weight</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">normalize</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">display_labels</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">include_values</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span>
        <span class="identifier">xticks_rotation</span><span class="arithmetic-assignment">=</span><span class="string-literal">"horizontal"</span><span class="punctuation">,</span>
        <span class="identifier">values_format</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="string-literal">"viridis"</span><span class="punctuation">,</span>
        <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">colorbar</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span>
    <span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">"""Plot Confusion Matrix given an estimator and some data.

        Read more in the :ref:`User Guide &lt;confusion_matrix&gt;`.

        .. versionadded:: 1.0

        Parameters
        ----------
        estimator : estimator instance
            Fitted classifier or a fitted :class:`~sklearn.pipeline.Pipeline`
            in which the last estimator is a classifier.

        X : {array-like, sparse matrix} of shape (n_samples, n_features)
            Input values.

        y : array-like of shape (n_samples,)
            Target values.

        labels : array-like of shape (n_classes,), default=None
            List of labels to index the confusion matrix. This may be used to
            reorder or select a subset of labels. If `None` is given, those
            that appear at least once in `y_true` or `y_pred` are used in
            sorted order.

        sample_weight : array-like of shape (n_samples,), default=None
            Sample weights.

        normalize : {'true', 'pred', 'all'}, default=None
            Either to normalize the counts display in the matrix:

            - if `'true'`, the confusion matrix is normalized over the true
              conditions (e.g. rows);
            - if `'pred'`, the confusion matrix is normalized over the
              predicted conditions (e.g. columns);
            - if `'all'`, the confusion matrix is normalized by the total
              number of samples;
            - if `None` (default), the confusion matrix will not be normalized.

        display_labels : array-like of shape (n_classes,), default=None
            Target names used for plotting. By default, `labels` will be used
            if it is defined, otherwise the unique labels of `y_true` and
            `y_pred` will be used.

        include_values : bool, default=True
            Includes values in confusion matrix.

        xticks_rotation : {'vertical', 'horizontal'} or float, \
                default='horizontal'
            Rotation of xtick labels.

        values_format : str, default=None
            Format specification for values in confusion matrix. If `None`, the
            format specification is 'd' or '.2g' whichever is shorter.

        cmap : str or matplotlib Colormap, default='viridis'
            Colormap recognized by matplotlib.

        ax : matplotlib Axes, default=None
            Axes object to plot on. If `None`, a new figure and axes is
            created.

        colorbar : bool, default=True
            Whether or not to add a colorbar to the plot.

        Returns
        -------
        display : :class:`~sklearn.metrics.ConfusionMatrixDisplay`

        See Also
        --------
        ConfusionMatrixDisplay.from_predictions : Plot the confusion matrix
            given the true and predicted labels.

        Examples
        --------
        &gt;&gt;&gt; import matplotlib.pyplot as plt  # doctest: +SKIP
        &gt;&gt;&gt; from sklearn.datasets import make_classification
        &gt;&gt;&gt; from sklearn.metrics import ConfusionMatrixDisplay
        &gt;&gt;&gt; from sklearn.model_selection import train_test_split
        &gt;&gt;&gt; from sklearn.svm import SVC
        &gt;&gt;&gt; X, y = make_classification(random_state=0)
        &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(
        ...         X, y, random_state=0)
        &gt;&gt;&gt; clf = SVC(random_state=0)
        &gt;&gt;&gt; clf.fit(X_train, y_train)
        SVC(random_state=0)
        &gt;&gt;&gt; ConfusionMatrixDisplay.from_estimator(
        ...     clf, X_test, y_test)  # doctest: +SKIP
        &gt;&gt;&gt; plt.show()  # doctest: +SKIP
        """</span>
        <span class="identifier">method_name</span> <span class="arithmetic-assignment">=</span> <span class="identifier">f</span><span class="string-literal">"{cls.__name__}.from_estimator"</span>
        <span class="identifier">check_matplotlib_support</span><span class="grouping">(</span><span class="identifier">method_name</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">is_classifier</span><span class="grouping">(</span><span class="identifier">estimator</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">raise</span> <span class="identifier">ValueError</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"{method_name} only supports classifiers"</span><span class="grouping">)</span>
        <span class="identifier">y_pred</span> <span class="arithmetic-assignment">=</span> <span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>

        <span class="keyword">return</span> <span class="identifier">cls</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">r</span><span class="invalid">o</span><span class="invalid">m</span><span class="invalid">_</span><span class="invalid">p</span><span class="invalid">r</span><span class="invalid">e</span><span class="invalid">d</span><span class="invalid">i</span><span class="invalid">c</span><span class="invalid">t</span><span class="invalid">i</span><span class="invalid">o</span><span class="invalid">n</span><span class="invalid">s</span><span class="grouping">(</span>
            <span class="identifier">y</span><span class="punctuation">,</span>
            <span class="identifier">y_pred</span><span class="punctuation">,</span>
            <span class="identifier">sample_weight</span><span class="arithmetic-assignment">=</span><span class="identifier">sample_weight</span><span class="punctuation">,</span>
            <span class="identifier">labels</span><span class="arithmetic-assignment">=</span><span class="identifier">labels</span><span class="punctuation">,</span>
            <span class="identifier">normalize</span><span class="arithmetic-assignment">=</span><span class="identifier">normalize</span><span class="punctuation">,</span>
            <span class="identifier">display_labels</span><span class="arithmetic-assignment">=</span><span class="identifier">display_labels</span><span class="punctuation">,</span>
            <span class="identifier">include_values</span><span class="arithmetic-assignment">=</span><span class="identifier">include_values</span><span class="punctuation">,</span>
            <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap</span><span class="punctuation">,</span>
            <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="identifier">ax</span><span class="punctuation">,</span>
            <span class="identifier">xticks_rotation</span><span class="arithmetic-assignment">=</span><span class="identifier">xticks_rotation</span><span class="punctuation">,</span>
            <span class="identifier">values_format</span><span class="arithmetic-assignment">=</span><span class="identifier">values_format</span><span class="punctuation">,</span>
            <span class="identifier">colorbar</span><span class="arithmetic-assignment">=</span><span class="identifier">colorbar</span><span class="punctuation">,</span>
        <span class="grouping">)</span>

    <span class="punctuation">@</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">m</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">h</span><span class="invalid">o</span><span class="invalid">d</span>
    <span class="keyword">def</span> <span class="invalid">f</span><span class="invalid">r</span><span class="invalid">o</span><span class="invalid">m</span><span class="invalid">_</span><span class="invalid">p</span><span class="invalid">r</span><span class="invalid">e</span><span class="invalid">d</span><span class="invalid">i</span><span class="invalid">c</span><span class="invalid">t</span><span class="invalid">i</span><span class="invalid">o</span><span class="invalid">n</span><span class="invalid">s</span><span class="grouping">(</span>
        <span class="identifier">cls</span><span class="punctuation">,</span>
        <span class="identifier">y_true</span><span class="punctuation">,</span>
        <span class="identifier">y_pred</span><span class="punctuation">,</span>
        <span class="arithmetic-operator">*</span><span class="punctuation">,</span>
        <span class="identifier">labels</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">sample_weight</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">normalize</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">display_labels</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">include_values</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span>
        <span class="identifier">xticks_rotation</span><span class="arithmetic-assignment">=</span><span class="string-literal">"horizontal"</span><span class="punctuation">,</span>
        <span class="identifier">values_format</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="string-literal">"viridis"</span><span class="punctuation">,</span>
        <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
        <span class="identifier">colorbar</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span>
    <span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">"""Plot Confusion Matrix given true and predicted labels.

        Read more in the :ref:`User Guide &lt;confusion_matrix&gt;`.

        .. versionadded:: 0.24

        Parameters
        ----------
        y_true : array-like of shape (n_samples,)
            True labels.

        y_pred : array-like of shape (n_samples,)
            The predicted labels given by the method `predict` of an
            classifier.

        labels : array-like of shape (n_classes,), default=None
            List of labels to index the confusion matrix. This may be used to
            reorder or select a subset of labels. If `None` is given, those
            that appear at least once in `y_true` or `y_pred` are used in
            sorted order.

        sample_weight : array-like of shape (n_samples,), default=None
            Sample weights.

        normalize : {'true', 'pred', 'all'}, default=None
            Either to normalize the counts display in the matrix:

            - if `'true'`, the confusion matrix is normalized over the true
              conditions (e.g. rows);
            - if `'pred'`, the confusion matrix is normalized over the
              predicted conditions (e.g. columns);
            - if `'all'`, the confusion matrix is normalized by the total
              number of samples;
            - if `None` (default), the confusion matrix will not be normalized.

        display_labels : array-like of shape (n_classes,), default=None
            Target names used for plotting. By default, `labels` will be used
            if it is defined, otherwise the unique labels of `y_true` and
            `y_pred` will be used.

        include_values : bool, default=True
            Includes values in confusion matrix.

        xticks_rotation : {'vertical', 'horizontal'} or float, \
                default='horizontal'
            Rotation of xtick labels.

        values_format : str, default=None
            Format specification for values in confusion matrix. If `None`, the
            format specification is 'd' or '.2g' whichever is shorter.

        cmap : str or matplotlib Colormap, default='viridis'
            Colormap recognized by matplotlib.

        ax : matplotlib Axes, default=None
            Axes object to plot on. If `None`, a new figure and axes is
            created.

        colorbar : bool, default=True
            Whether or not to add a colorbar to the plot.

        Returns
        -------
        display : :class:`~sklearn.metrics.ConfusionMatrixDisplay`

        See Also
        --------
        ConfusionMatrixDisplay.from_estimator : Plot the confusion matrix
            given an estimator, the data, and the label.

        Examples
        --------
        &gt;&gt;&gt; import matplotlib.pyplot as plt  # doctest: +SKIP
        &gt;&gt;&gt; from sklearn.datasets import make_classification
        &gt;&gt;&gt; from sklearn.metrics import ConfusionMatrixDisplay
        &gt;&gt;&gt; from sklearn.model_selection import train_test_split
        &gt;&gt;&gt; from sklearn.svm import SVC
        &gt;&gt;&gt; X, y = make_classification(random_state=0)
        &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(
        ...         X, y, random_state=0)
        &gt;&gt;&gt; clf = SVC(random_state=0)
        &gt;&gt;&gt; clf.fit(X_train, y_train)
        SVC(random_state=0)
        &gt;&gt;&gt; y_pred = clf.predict(X_test)
        &gt;&gt;&gt; ConfusionMatrixDisplay.from_predictions(
        ...    y_test, y_pred)  # doctest: +SKIP
        &gt;&gt;&gt; plt.show()  # doctest: +SKIP
        """</span>
        <span class="identifier">check_matplotlib_support</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"{cls.__name__}.from_predictions"</span><span class="grouping">)</span>

        <span class="keyword">if</span> <span class="identifier">display_labels</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">labels</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
                <span class="identifier">display_labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">unique_labels</span><span class="grouping">(</span><span class="identifier">y_true</span><span class="punctuation">,</span> <span class="identifier">y_pred</span><span class="grouping">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="identifier">display_labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">labels</span>

        <span class="identifier">cm</span> <span class="arithmetic-assignment">=</span> <span class="identifier">confusion_matrix</span><span class="grouping">(</span>
            <span class="identifier">y_true</span><span class="punctuation">,</span>
            <span class="identifier">y_pred</span><span class="punctuation">,</span>
            <span class="identifier">sample_weight</span><span class="arithmetic-assignment">=</span><span class="identifier">sample_weight</span><span class="punctuation">,</span>
            <span class="identifier">labels</span><span class="arithmetic-assignment">=</span><span class="identifier">labels</span><span class="punctuation">,</span>
            <span class="identifier">normalize</span><span class="arithmetic-assignment">=</span><span class="identifier">normalize</span><span class="punctuation">,</span>
        <span class="grouping">)</span>

        <span class="identifier">disp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cls</span><span class="grouping">(</span><span class="identifier">confusion_matrix</span><span class="arithmetic-assignment">=</span><span class="identifier">cm</span><span class="punctuation">,</span> <span class="identifier">display_labels</span><span class="arithmetic-assignment">=</span><span class="identifier">display_labels</span><span class="grouping">)</span>

        <span class="keyword">return</span> <span class="identifier">disp</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span>
            <span class="identifier">include_values</span><span class="arithmetic-assignment">=</span><span class="identifier">include_values</span><span class="punctuation">,</span>
            <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap</span><span class="punctuation">,</span>
            <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="identifier">ax</span><span class="punctuation">,</span>
            <span class="identifier">xticks_rotation</span><span class="arithmetic-assignment">=</span><span class="identifier">xticks_rotation</span><span class="punctuation">,</span>
            <span class="identifier">values_format</span><span class="arithmetic-assignment">=</span><span class="identifier">values_format</span><span class="punctuation">,</span>
            <span class="identifier">colorbar</span><span class="arithmetic-assignment">=</span><span class="identifier">colorbar</span><span class="punctuation">,</span>
        <span class="grouping">)</span>


<span class="punctuation">@</span><span class="identifier">deprecated</span><span class="grouping">(</span>
    <span class="string-literal">"Function plot_confusion_matrix is deprecated in 1.0 and will be "</span>
    <span class="string-literal">"removed in 1.2. Use one of the class methods: "</span>
    <span class="string-literal">"ConfusionMatrixDisplay.from_predictions or "</span>
    <span class="string-literal">"ConfusionMatrixDisplay.from_estimator."</span>
<span class="grouping">)</span>
<span class="keyword">def</span> <span class="identifier">plot_confusion_matrix</span><span class="grouping">(</span><span class="identifier">estimator</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y_true</span><span class="punctuation">,</span> <span class="arithmetic-operator">*</span><span class="punctuation">,</span> <span class="identifier">labels</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
                          <span class="identifier">sample_weight</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">normalize</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
                          <span class="identifier">display_labels</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">include_values</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span>
                          <span class="identifier">xticks_rotation</span><span class="arithmetic-assignment">=</span><span class="string-literal">'horizontal'</span><span class="punctuation">,</span>
                          <span class="identifier">values_format</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span>
                          <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="string-literal">'viridis'</span><span class="punctuation">,</span> <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">colorbar</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""Plot Confusion Matrix.

    Read more in the :ref:`User Guide &lt;confusion_matrix&gt;`.

    .. deprecated:: 1.0
       `plot_confusion_matrix` is deprecated in 1.0 and will be removed in
       1.2. Use one of the following class methods:
       :func:`~sklearn.metrics.ConfusionMatrixDisplay.from_predictions` or
       :func:`~sklearn.metrics.ConfusionMatrixDisplay.from_estimator`.

    Parameters
    ----------
    estimator : estimator instance
        Fitted classifier or a fitted :class:`~sklearn.pipeline.Pipeline`
        in which the last estimator is a classifier.

    X : {array-like, sparse matrix} of shape (n_samples, n_features)
        Input values.

    y_true : array-like of shape (n_samples,)
        Target values.

    labels : array-like of shape (n_classes,), default=None
        List of labels to index the matrix. This may be used to reorder or
        select a subset of labels. If `None` is given, those that appear at
        least once in `y_true` or `y_pred` are used in sorted order.

    sample_weight : array-like of shape (n_samples,), default=None
        Sample weights.

    normalize : {'true', 'pred', 'all'}, default=None
        Either to normalize the counts display in the matrix:

            - if `'true'`, the confusion matrix is normalized over the true
              conditions (e.g. rows);
            - if `'pred'`, the confusion matrix is normalized over the
              predicted conditions (e.g. columns);
            - if `'all'`, the confusion matrix is normalized by the total
              number of samples;
            - if `None` (default), the confusion matrix will not be normalized.

    display_labels : array-like of shape (n_classes,), default=None
        Target names used for plotting. By default, `labels` will be used if
        it is defined, otherwise the unique labels of `y_true` and `y_pred`
        will be used.

    include_values : bool, default=True
        Includes values in confusion matrix.

    xticks_rotation : {'vertical', 'horizontal'} or float, \
                        default='horizontal'
        Rotation of xtick labels.

    values_format : str, default=None
        Format specification for values in confusion matrix. If `None`,
        the format specification is 'd' or '.2g' whichever is shorter.

    cmap : str or matplotlib Colormap, default='viridis'
        Colormap recognized by matplotlib.

    ax : matplotlib Axes, default=None
        Axes object to plot on. If `None`, a new figure and axes is
        created.

    colorbar : bool, default=True
        Whether or not to add a colorbar to the plot.

        .. versionadded:: 0.24

    Returns
    -------
    display : :class:`~sklearn.metrics.ConfusionMatrixDisplay`

    See Also
    --------
    confusion_matrix : Compute Confusion Matrix to evaluate the accuracy of a
        classification.
    ConfusionMatrixDisplay : Confusion Matrix visualization.

    Examples
    --------
    &gt;&gt;&gt; import matplotlib.pyplot as plt  # doctest: +SKIP
    &gt;&gt;&gt; from sklearn.datasets import make_classification
    &gt;&gt;&gt; from sklearn.metrics import plot_confusion_matrix
    &gt;&gt;&gt; from sklearn.model_selection import train_test_split
    &gt;&gt;&gt; from sklearn.svm import SVC
    &gt;&gt;&gt; X, y = make_classification(random_state=0)
    &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(
    ...         X, y, random_state=0)
    &gt;&gt;&gt; clf = SVC(random_state=0)
    &gt;&gt;&gt; clf.fit(X_train, y_train)
    SVC(random_state=0)
    &gt;&gt;&gt; plot_confusion_matrix(clf, X_test, y_test)  # doctest: +SKIP
    &gt;&gt;&gt; plt.show()  # doctest: +SKIP
    """</span>
    <span class="identifier">check_matplotlib_support</span><span class="grouping">(</span><span class="string-literal">"plot_confusion_matrix"</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">is_classifier</span><span class="grouping">(</span><span class="identifier">estimator</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">raise</span> <span class="identifier">ValueError</span><span class="grouping">(</span><span class="string-literal">"plot_confusion_matrix only supports classifiers"</span><span class="grouping">)</span>

    <span class="identifier">y_pred</span> <span class="arithmetic-assignment">=</span> <span class="identifier">estimator</span><span class="punctuation">.</span><span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
    <span class="identifier">cm</span> <span class="arithmetic-assignment">=</span> <span class="identifier">confusion_matrix</span><span class="grouping">(</span><span class="identifier">y_true</span><span class="punctuation">,</span> <span class="identifier">y_pred</span><span class="punctuation">,</span> <span class="identifier">sample_weight</span><span class="arithmetic-assignment">=</span><span class="identifier">sample_weight</span><span class="punctuation">,</span>
                          <span class="identifier">labels</span><span class="arithmetic-assignment">=</span><span class="identifier">labels</span><span class="punctuation">,</span> <span class="identifier">normalize</span><span class="arithmetic-assignment">=</span><span class="identifier">normalize</span><span class="grouping">)</span>

    <span class="keyword">if</span> <span class="identifier">display_labels</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="identifier">labels</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="identifier">display_labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">unique_labels</span><span class="grouping">(</span><span class="identifier">y_true</span><span class="punctuation">,</span> <span class="identifier">y_pred</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">display_labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">labels</span>

    <span class="identifier">disp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ConfusionMatrixDisplay</span><span class="grouping">(</span><span class="identifier">confusion_matrix</span><span class="arithmetic-assignment">=</span><span class="identifier">cm</span><span class="punctuation">,</span>
                                  <span class="identifier">display_labels</span><span class="arithmetic-assignment">=</span><span class="identifier">display_labels</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">disp</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">include_values</span><span class="arithmetic-assignment">=</span><span class="identifier">include_values</span><span class="punctuation">,</span>
                     <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap</span><span class="punctuation">,</span> <span class="identifier">ax</span><span class="arithmetic-assignment">=</span><span class="identifier">ax</span><span class="punctuation">,</span> <span class="identifier">xticks_rotation</span><span class="arithmetic-assignment">=</span><span class="identifier">xticks_rotation</span><span class="punctuation">,</span>
                     <span class="identifier">values_format</span><span class="arithmetic-assignment">=</span><span class="identifier">values_format</span><span class="punctuation">,</span> <span class="identifier">colorbar</span><span class="arithmetic-assignment">=</span><span class="identifier">colorbar</span><span class="grouping">)</span>

    </pre>
  </body>
</html>