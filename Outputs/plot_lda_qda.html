<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
====================================================================
Linear and Quadratic Discriminant Analysis with covariance ellipsoid
====================================================================

This example plots the covariance ellipsoids of each class and
decision boundary learned by LDA and QDA. The ellipsoids display
the double standard deviation for each class. With LDA, the
standard deviation is the same for all the classes, while each
class has its own standard deviation with QDA.
"""</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">__doc__</span><span class="grouping">)</span>

<span class="keyword">from</span> <span class="identifier">scipy</span> <span class="keyword">import</span> <span class="identifier">linalg</span>
<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span> <span class="keyword">as</span> <span class="identifier">mpl</span>
<span class="keyword">from</span> <span class="identifier">matplotlib</span> <span class="keyword">import</span> <span class="identifier">colors</span>

<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">discriminant_analysis</span> <span class="keyword">import</span> <span class="identifier">LinearDiscriminantAnalysis</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">discriminant_analysis</span> <span class="keyword">import</span> <span class="identifier">QuadraticDiscriminantAnalysis</span>

<span class="comment"># #############################################################################</span>
<span class="comment"># Colormap</span>
<span class="identifier">cmap</span> <span class="arithmetic-assignment">=</span> <span class="identifier">colors</span><span class="punctuation">.</span><span class="identifier">LinearSegmentedColormap</span><span class="grouping">(</span>
    <span class="string-literal">'red_blue_classes'</span><span class="punctuation">,</span>
    <span class="grouping">{</span><span class="string-literal">'red'</span><span class="punctuation">:</span> <span class="grouping">[</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
     <span class="string-literal">'green'</span><span class="punctuation">:</span> <span class="grouping">[</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">,</span>
     <span class="string-literal">'blue'</span><span class="punctuation">:</span> <span class="grouping">[</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="punctuation">,</span> <span class="float-literal">0.7</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">}</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">cm</span><span class="punctuation">.</span><span class="identifier">register_cmap</span><span class="grouping">(</span><span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="identifier">cmap</span><span class="grouping">)</span>


<span class="comment"># #############################################################################</span>
<span class="comment"># Generate datasets</span>
<span class="keyword">def</span> <span class="identifier">dataset_fixed_cov</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">'''Generate 2 Gaussians samples with the same covariance matrix'''</span>
    <span class="identifier">n</span><span class="punctuation">,</span> <span class="identifier">dim</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">300</span><span class="punctuation">,</span> <span class="int-literal">2</span>
    <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">seed</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span>
    <span class="identifier">C</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="float-literal">-0.23</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">0.83</span><span class="punctuation">,</span> <span class="float-literal">.23</span><span class="grouping">]</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">r_</span><span class="grouping">[</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">dot</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randn</span><span class="grouping">(</span><span class="identifier">n</span><span class="punctuation">,</span> <span class="identifier">dim</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">C</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">dot</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randn</span><span class="grouping">(</span><span class="identifier">n</span><span class="punctuation">,</span> <span class="identifier">dim</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">C</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">]</span>
    <span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">hstack</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="identifier">n</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">ones</span><span class="grouping">(</span><span class="identifier">n</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span>


<span class="keyword">def</span> <span class="identifier">dataset_cov</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">'''Generate 2 Gaussians samples with different covariance matrices'''</span>
    <span class="identifier">n</span><span class="punctuation">,</span> <span class="identifier">dim</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">300</span><span class="punctuation">,</span> <span class="int-literal">2</span>
    <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">seed</span><span class="grouping">(</span><span class="int-literal">0</span><span class="grouping">)</span>
    <span class="identifier">C</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="punctuation">.</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">2.5</span><span class="punctuation">,</span> <span class="float-literal">.7</span><span class="grouping">]</span><span class="grouping">]</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="int-literal">2</span><span class="punctuation">.</span>
    <span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">r_</span><span class="grouping">[</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">dot</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randn</span><span class="grouping">(</span><span class="identifier">n</span><span class="punctuation">,</span> <span class="identifier">dim</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">C</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">dot</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randn</span><span class="grouping">(</span><span class="identifier">n</span><span class="punctuation">,</span> <span class="identifier">dim</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">C</span><span class="punctuation">.</span><span class="identifier">T</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">array</span><span class="grouping">(</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">4</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">]</span>
    <span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">hstack</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">zeros</span><span class="grouping">(</span><span class="identifier">n</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">ones</span><span class="grouping">(</span><span class="identifier">n</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span>


<span class="comment"># #############################################################################</span>
<span class="comment"># Plot functions</span>
<span class="keyword">def</span> <span class="identifier">plot_data</span><span class="grouping">(</span><span class="identifier">lda</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">y_pred</span><span class="punctuation">,</span> <span class="identifier">fig_index</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">splot</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplot</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">fig_index</span><span class="grouping">)</span>
    <span class="keyword">if</span> <span class="identifier">fig_index</span> <span class="relational-operator">==</span> <span class="int-literal">1</span><span class="punctuation">:</span>
        <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="string-literal">'Linear Discriminant Analysis'</span><span class="grouping">)</span>
        <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">ylabel</span><span class="grouping">(</span><span class="string-literal">'Data with\n fixed covariance'</span><span class="grouping">)</span>
    <span class="keyword">elif</span> <span class="identifier">fig_index</span> <span class="relational-operator">==</span> <span class="int-literal">2</span><span class="punctuation">:</span>
        <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="string-literal">'Quadratic Discriminant Analysis'</span><span class="grouping">)</span>
    <span class="keyword">elif</span> <span class="identifier">fig_index</span> <span class="relational-operator">==</span> <span class="int-literal">3</span><span class="punctuation">:</span>
        <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">ylabel</span><span class="grouping">(</span><span class="string-literal">'Data with\n varying covariances'</span><span class="grouping">)</span>

    <span class="identifier">tp</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="identifier">y_pred</span><span class="grouping">)</span>  <span class="comment"># True Positive</span>
    <span class="identifier">tp0</span><span class="punctuation">,</span> <span class="identifier">tp1</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tp</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">tp</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="int-literal">1</span><span class="grouping">]</span>
    <span class="identifier">X0</span><span class="punctuation">,</span> <span class="identifier">X1</span> <span class="arithmetic-assignment">=</span> <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="int-literal">1</span><span class="grouping">]</span>
    <span class="identifier">X0_tp</span><span class="punctuation">,</span> <span class="identifier">X0_fp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">X0</span><span class="grouping">[</span><span class="identifier">tp0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X0</span><span class="grouping">[</span><span class="bitwise-operator">~</span><span class="identifier">tp0</span><span class="grouping">]</span>
    <span class="identifier">X1_tp</span><span class="punctuation">,</span> <span class="identifier">X1_fp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">X1</span><span class="grouping">[</span><span class="identifier">tp1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X1</span><span class="grouping">[</span><span class="bitwise-operator">~</span><span class="identifier">tp1</span><span class="grouping">]</span>

    <span class="comment"># class 0: dots</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">X0_tp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X0_tp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'.', color='red'</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">X0_fp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X0_fp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'x'</span><span class="punctuation">,</span>
                <span class="identifier">s</span><span class="arithmetic-assignment">=</span><span class="int-literal">20</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'#990000'</span><span class="grouping">)</span>  <span class="comment"># dark red</span>

    <span class="comment"># class 1: dots</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">X1_tp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X1_tp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'.', color='blue'</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">X1_fp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X1_fp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">marker</span><span class="arithmetic-assignment">=</span><span class="string-literal">'x'</span><span class="punctuation">,</span>
                <span class="identifier">s</span><span class="arithmetic-assignment">=</span><span class="int-literal">20</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="arithmetic-assignment">=</span><span class="string-literal">'#000099'</span><span class="grouping">)</span>  <span class="comment"># dark blue</span>

    <span class="comment"># class 0 and 1 : areas</span>
    <span class="identifier">nx</span><span class="punctuation">,</span> <span class="identifier">ny</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">200</span><span class="punctuation">,</span> <span class="int-literal">100</span>
    <span class="identifier">x_min</span><span class="punctuation">,</span> <span class="identifier">x_max</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">xlim</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">y_min</span><span class="punctuation">,</span> <span class="identifier">y_max</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">ylim</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">xx</span><span class="punctuation">,</span> <span class="identifier">yy</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">meshgrid</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="identifier">x_min</span><span class="punctuation">,</span> <span class="identifier">x_max</span><span class="punctuation">,</span> <span class="identifier">nx</span><span class="grouping">)</span><span class="punctuation">,</span>
                         <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">linspace</span><span class="grouping">(</span><span class="identifier">y_min</span><span class="punctuation">,</span> <span class="identifier">y_max</span><span class="punctuation">,</span> <span class="identifier">ny</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">Z</span> <span class="arithmetic-assignment">=</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">predict_proba</span><span class="grouping">(</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">c_</span><span class="grouping">[</span><span class="identifier">xx</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">yy</span><span class="punctuation">.</span><span class="identifier">ravel</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">Z</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Z</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">reshape</span><span class="grouping">(</span><span class="identifier">xx</span><span class="punctuation">.</span><span class="identifier">shape</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">pcolormesh</span><span class="grouping">(</span><span class="identifier">xx</span><span class="punctuation">,</span> <span class="identifier">yy</span><span class="punctuation">,</span> <span class="identifier">Z</span><span class="punctuation">,</span> <span class="identifier">cmap</span><span class="arithmetic-assignment">=</span><span class="string-literal">'red_blue_classes'</span><span class="punctuation">,</span>
                   <span class="identifier">norm</span><span class="arithmetic-assignment">=</span><span class="identifier">colors</span><span class="punctuation">.</span><span class="identifier">Normalize</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">.</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">zorder</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">contour</span><span class="grouping">(</span><span class="identifier">xx</span><span class="punctuation">,</span> <span class="identifier">yy</span><span class="punctuation">,</span> <span class="identifier">Z</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="float-literal">0.5</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">linewidths</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">.</span><span class="punctuation">,</span> <span class="identifier">colors</span><span class="arithmetic-assignment">=</span><span class="string-literal">'white'</span><span class="grouping">)</span>

    <span class="comment"># means</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span>
             <span class="string-literal">'*', color='yellow', markersize=15, markeredgecolor='grey'</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">plot</span><span class="grouping">(</span><span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span>
             <span class="string-literal">'*', color='yellow', markersize=15, markeredgecolor='grey'</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="identifier">splot</span>


<span class="keyword">def</span> <span class="identifier">plot_ellipse</span><span class="grouping">(</span><span class="identifier">splot</span><span class="punctuation">,</span> <span class="identifier">mean</span><span class="punctuation">,</span> <span class="identifier">cov</span><span class="punctuation">,</span> <span class="identifier">color</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">v</span><span class="punctuation">,</span> <span class="identifier">w</span> <span class="arithmetic-assignment">=</span> <span class="identifier">linalg</span><span class="punctuation">.</span><span class="identifier">eigh</span><span class="grouping">(</span><span class="identifier">cov</span><span class="grouping">)</span>
    <span class="identifier">u</span> <span class="arithmetic-assignment">=</span> <span class="identifier">w</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span> <span class="arithmetic-operator">/</span> <span class="identifier">linalg</span><span class="punctuation">.</span><span class="identifier">norm</span><span class="grouping">(</span><span class="identifier">w</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">angle</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">arctan</span><span class="grouping">(</span><span class="identifier">u</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span> <span class="arithmetic-operator">/</span> <span class="identifier">u</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">angle</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">180</span> <span class="arithmetic-operator">*</span> <span class="identifier">angle</span> <span class="arithmetic-operator">/</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">pi</span>  <span class="comment"># convert to degrees</span>
    <span class="comment"># filled Gaussian at 2 standard deviation</span>
    <span class="identifier">ell</span> <span class="arithmetic-assignment">=</span> <span class="identifier">mpl</span><span class="punctuation">.</span><span class="identifier">patches</span><span class="punctuation">.</span><span class="identifier">Ellipse</span><span class="grouping">(</span><span class="identifier">mean</span><span class="punctuation">,</span> <span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">v</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span> <span class="arithmetic-operator">**</span> <span class="float-literal">0.5</span><span class="punctuation">,</span> <span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">v</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span> <span class="arithmetic-operator">**</span> <span class="float-literal">0.5</span><span class="punctuation">,</span>
                              <span class="int-literal">180</span> <span class="arithmetic-operator">+</span> <span class="identifier">angle</span><span class="punctuation">,</span> <span class="identifier">facecolor</span><span class="arithmetic-assignment">=</span><span class="identifier">color</span><span class="punctuation">,</span>
                              <span class="identifier">edgecolor</span><span class="arithmetic-assignment">=</span><span class="string-literal">'black'</span><span class="punctuation">,</span> <span class="identifier">linewidth</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="grouping">)</span>
    <span class="identifier">ell</span><span class="punctuation">.</span><span class="identifier">set_clip_box</span><span class="grouping">(</span><span class="identifier">splot</span><span class="punctuation">.</span><span class="identifier">bbox</span><span class="grouping">)</span>
    <span class="identifier">ell</span><span class="punctuation">.</span><span class="identifier">set_alpha</span><span class="grouping">(</span><span class="float-literal">0.2</span><span class="grouping">)</span>
    <span class="identifier">splot</span><span class="punctuation">.</span><span class="identifier">add_artist</span><span class="grouping">(</span><span class="identifier">ell</span><span class="grouping">)</span>
    <span class="identifier">splot</span><span class="punctuation">.</span><span class="identifier">set_xticks</span><span class="grouping">(</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">splot</span><span class="punctuation">.</span><span class="identifier">set_yticks</span><span class="grouping">(</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">plot_lda_cov</span><span class="grouping">(</span><span class="identifier">lda</span><span class="punctuation">,</span> <span class="identifier">splot</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">plot_ellipse</span><span class="grouping">(</span><span class="identifier">splot</span><span class="punctuation">,</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">covariance_</span><span class="punctuation">,</span> <span class="string-literal">'red'</span><span class="grouping">)</span>
    <span class="identifier">plot_ellipse</span><span class="grouping">(</span><span class="identifier">splot</span><span class="punctuation">,</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">covariance_</span><span class="punctuation">,</span> <span class="string-literal">'blue'</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">plot_qda_cov</span><span class="grouping">(</span><span class="identifier">qda</span><span class="punctuation">,</span> <span class="identifier">splot</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">plot_ellipse</span><span class="grouping">(</span><span class="identifier">splot</span><span class="punctuation">,</span> <span class="identifier">qda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">qda</span><span class="punctuation">.</span><span class="identifier">covariance_</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="string-literal">'red'</span><span class="grouping">)</span>
    <span class="identifier">plot_ellipse</span><span class="grouping">(</span><span class="identifier">splot</span><span class="punctuation">,</span> <span class="identifier">qda</span><span class="punctuation">.</span><span class="identifier">means_</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">qda</span><span class="punctuation">.</span><span class="identifier">covariance_</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="string-literal">'blue'</span><span class="grouping">)</span>


<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">figure</span><span class="grouping">(</span><span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">10</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">facecolor</span><span class="arithmetic-assignment">=</span><span class="string-literal">'white'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">suptitle</span><span class="grouping">(</span><span class="string-literal">'Linear Discriminant Analysis vs Quadratic Discriminant Analysis'</span><span class="punctuation">,</span>
             <span class="identifier">y</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.98</span><span class="punctuation">,</span> <span class="identifier">fontsize</span><span class="arithmetic-assignment">=</span><span class="int-literal">15</span><span class="grouping">)</span>
<span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="grouping">)</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="grouping">[</span><span class="identifier">dataset_fixed_cov</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">dataset_cov</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment"># Linear Discriminant Analysis</span>
    <span class="identifier">lda</span> <span class="arithmetic-assignment">=</span> <span class="identifier">LinearDiscriminantAnalysis</span><span class="grouping">(</span><span class="identifier">solver</span><span class="arithmetic-assignment">=</span><span class="string-literal">"svd"</span><span class="punctuation">,</span> <span class="identifier">store_covariance</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
    <span class="identifier">y_pred</span> <span class="arithmetic-assignment">=</span> <span class="identifier">lda</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
    <span class="identifier">splot</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plot_data</span><span class="grouping">(</span><span class="identifier">lda</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">y_pred</span><span class="punctuation">,</span> <span class="identifier">fig_index</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">i</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span><span class="grouping">)</span>
    <span class="identifier">plot_lda_cov</span><span class="grouping">(</span><span class="identifier">lda</span><span class="punctuation">,</span> <span class="identifier">splot</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">axis</span><span class="grouping">(</span><span class="string-literal">'tight'</span><span class="grouping">)</span>

    <span class="comment"># Quadratic Discriminant Analysis</span>
    <span class="identifier">qda</span> <span class="arithmetic-assignment">=</span> <span class="identifier">QuadraticDiscriminantAnalysis</span><span class="grouping">(</span><span class="identifier">store_covariance</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
    <span class="identifier">y_pred</span> <span class="arithmetic-assignment">=</span> <span class="identifier">qda</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
    <span class="identifier">splot</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plot_data</span><span class="grouping">(</span><span class="identifier">qda</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">y_pred</span><span class="punctuation">,</span> <span class="identifier">fig_index</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">i</span> <span class="arithmetic-operator">+</span> <span class="int-literal">2</span><span class="grouping">)</span>
    <span class="identifier">plot_qda_cov</span><span class="grouping">(</span><span class="identifier">qda</span><span class="punctuation">,</span> <span class="identifier">splot</span><span class="grouping">)</span>
    <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">axis</span><span class="grouping">(</span><span class="string-literal">'tight'</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">tight_layout</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">subplots_adjust</span><span class="grouping">(</span><span class="identifier">top</span><span class="arithmetic-assignment">=</span><span class="float-literal">0.92</span><span class="grouping">)</span>
<span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>