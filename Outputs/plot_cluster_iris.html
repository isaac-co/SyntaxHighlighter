<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">#!/usr/bin/python</span>
<span class="comment"># -*- coding: utf-8 -*-</span>

<span class="comment">"""
=========================================================
K-means Clustering
=========================================================

The plots display firstly what a K-means algorithm would yield
using three clusters. It is then shown what the effect of a bad
initialization is on the classification process:
By setting n_init to only 1 (default is 10), the amount of
times that the algorithm will be run with different centroid
seeds is reduced.
The next plot displays what using eight clusters would deliver
and finally the ground truth.

"""</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">__doc__</span><span class="grouping">)</span>


<span class="comment"># Code source: GaÃ«l Varoquaux</span>
<span class="comment"># Modified for documentation by Jaques Grobler</span>
<span class="comment"># License: BSD 3 clause</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">matplotlib</span><span class="punctuation">.</span><span class="identifier">pyplot</span> <span class="keyword">as</span> <span class="identifier">plt</span>
<span class="comment"># Though the following import is not directly being used, it is required</span>
<span class="comment"># for 3D projection to work</span>
<span class="keyword">from</span> <span class="identifier">mpl_toolkits</span><span class="punctuation">.</span><span class="identifier">mplot3d</span> <span class="keyword">import</span> <span class="identifier">Axes3D</span>

<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">cluster</span> <span class="keyword">import</span> <span class="identifier">KMeans</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span> <span class="keyword">import</span> <span class="identifier">datasets</span>

<span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">seed</span><span class="grouping">(</span><span class="int-literal">5</span><span class="grouping">)</span>

<span class="identifier">iris</span> <span class="arithmetic-assignment">=</span> <span class="identifier">datasets</span><span class="punctuation">.</span><span class="identifier">load_iris</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">X</span> <span class="arithmetic-assignment">=</span> <span class="identifier">iris</span><span class="punctuation">.</span><span class="identifier">data</span>
<span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">iris</span><span class="punctuation">.</span><span class="identifier">target</span>

<span class="identifier">estimators</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">(</span><span class="string-literal">'k_means_iris_8'</span><span class="punctuation">,</span> <span class="identifier">KMeans</span><span class="grouping">(</span><span class="identifier">n_clusters</span><span class="arithmetic-assignment">=</span><span class="int-literal">8</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="grouping">(</span><span class="string-literal">'k_means_iris_3'</span><span class="punctuation">,</span> <span class="identifier">KMeans</span><span class="grouping">(</span><span class="identifier">n_clusters</span><span class="arithmetic-assignment">=</span><span class="int-literal">3</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="grouping">(</span><span class="string-literal">'k_means_iris_bad_init'</span><span class="punctuation">,</span> <span class="identifier">KMeans</span><span class="grouping">(</span><span class="identifier">n_clusters</span><span class="arithmetic-assignment">=</span><span class="int-literal">3</span><span class="punctuation">,</span> <span class="identifier">n_init</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="punctuation">,</span>
                                               <span class="identifier">init</span><span class="arithmetic-assignment">=</span><span class="string-literal">'random'</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">]</span>

<span class="identifier">fignum</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">1</span>
<span class="identifier">titles</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="string-literal">'8 clusters', '3 clusters', '3 clusters, bad initialization'</span><span class="grouping">]</span>
<span class="keyword">for</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">est</span> <span class="relational-operator">in</span> <span class="identifier">estimators</span><span class="punctuation">:</span>
    <span class="identifier">fig</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">figure</span><span class="grouping">(</span><span class="identifier">fignum</span><span class="punctuation">,</span> <span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Axes3D</span><span class="grouping">(</span><span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">rect</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="float-literal">.95</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">elev</span><span class="arithmetic-assignment">=</span><span class="int-literal">48</span><span class="punctuation">,</span> <span class="identifier">azim</span><span class="arithmetic-assignment">=</span><span class="int-literal">134</span><span class="grouping">)</span>
    <span class="identifier">est</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">)</span>
    <span class="identifier">labels</span> <span class="arithmetic-assignment">=</span> <span class="identifier">est</span><span class="punctuation">.</span><span class="identifier">labels_</span>

    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">]</span><span class="punctuation">,</span>
               <span class="identifier">c</span><span class="arithmetic-assignment">=</span><span class="identifier">labels</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">float</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">edgecolor</span><span class="arithmetic-assignment">=</span><span class="string-literal">'k'</span><span class="grouping">)</span>

    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">w_xaxis</span><span class="punctuation">.</span><span class="identifier">set_ticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">w_yaxis</span><span class="punctuation">.</span><span class="identifier">set_ticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">w_zaxis</span><span class="punctuation">.</span><span class="identifier">set_ticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_xlabel</span><span class="grouping">(</span><span class="string-literal">'Petal width'</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_ylabel</span><span class="grouping">(</span><span class="string-literal">'Sepal length'</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_zlabel</span><span class="grouping">(</span><span class="string-literal">'Petal length'</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_title</span><span class="grouping">(</span><span class="identifier">titles</span><span class="grouping">[</span><span class="identifier">fignum</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">dist</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">12</span>
    <span class="identifier">fignum</span> <span class="arithmetic-assignment">=</span> <span class="identifier">fignum</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span>

<span class="comment"># Plot the ground truth</span>
<span class="identifier">fig</span> <span class="arithmetic-assignment">=</span> <span class="identifier">plt</span><span class="punctuation">.</span><span class="identifier">figure</span><span class="grouping">(</span><span class="identifier">fignum</span><span class="punctuation">,</span> <span class="identifier">figsize</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="identifier">ax</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Axes3D</span><span class="grouping">(</span><span class="identifier">fig</span><span class="punctuation">,</span> <span class="identifier">rect</span><span class="arithmetic-assignment">=</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="float-literal">.95</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">elev</span><span class="arithmetic-assignment">=</span><span class="int-literal">48</span><span class="punctuation">,</span> <span class="identifier">azim</span><span class="arithmetic-assignment">=</span><span class="int-literal">134</span><span class="grouping">)</span>

<span class="keyword">for</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">label</span> <span class="relational-operator">in</span> <span class="grouping">[</span><span class="grouping">(</span><span class="string-literal">'Setosa'</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">)</span><span class="punctuation">,</span>
                    <span class="grouping">(</span><span class="string-literal">'Versicolour'</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span>
                    <span class="grouping">(</span><span class="string-literal">'Virginica'</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">)</span><span class="grouping">]</span><span class="punctuation">:</span>
    <span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">text3D</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="identifier">label</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="identifier">label</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="identifier">X</span><span class="grouping">[</span><span class="identifier">y</span> <span class="relational-operator">==</span> <span class="identifier">label</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">mean</span><span class="grouping">(</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">name</span><span class="punctuation">,</span>
              <span class="identifier">horizontalalignment</span><span class="arithmetic-assignment">=</span><span class="string-literal">'center'</span><span class="punctuation">,</span>
              <span class="identifier">bbox</span><span class="arithmetic-assignment">=</span><span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">alpha</span><span class="arithmetic-assignment">=</span><span class="float-literal">.2</span><span class="punctuation">,</span> <span class="identifier">edgecolor</span><span class="arithmetic-assignment">=</span><span class="string-literal">'w', facecolor='w'</span><span class="grouping">)</span><span class="grouping">)</span>
<span class="comment"># Reorder the labels to have colors matching the cluster results</span>
<span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">choose</span><span class="grouping">(</span><span class="identifier">y</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">t</span><span class="invalid">y</span><span class="invalid">p</span><span class="invalid">e</span><span class="grouping">(</span><span class="identifier">float</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">scatter</span><span class="grouping">(</span><span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">X</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">c</span><span class="arithmetic-assignment">=</span><span class="identifier">y</span><span class="punctuation">,</span> <span class="identifier">edgecolor</span><span class="arithmetic-assignment">=</span><span class="string-literal">'k'</span><span class="grouping">)</span>

<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">w_xaxis</span><span class="punctuation">.</span><span class="identifier">set_ticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">w_yaxis</span><span class="punctuation">.</span><span class="identifier">set_ticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">w_zaxis</span><span class="punctuation">.</span><span class="identifier">set_ticklabels</span><span class="grouping">(</span><span class="grouping">[</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_xlabel</span><span class="grouping">(</span><span class="string-literal">'Petal width'</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_ylabel</span><span class="grouping">(</span><span class="string-literal">'Sepal length'</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_zlabel</span><span class="grouping">(</span><span class="string-literal">'Petal length'</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">set_title</span><span class="grouping">(</span><span class="string-literal">'Ground Truth'</span><span class="grouping">)</span>
<span class="identifier">ax</span><span class="punctuation">.</span><span class="identifier">dist</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">12</span>

<span class="identifier">fig</span><span class="punctuation">.</span><span class="identifier">show</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>