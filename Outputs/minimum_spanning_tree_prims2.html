<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
Prim's (also known as Jarn√≠k's) algorithm is a greedy algorithm that finds a minimum
spanning tree for a weighted undirected graph. This means it finds a subset of the
edges that forms a tree that includes every vertex, where the total weight of all the
edges in the tree is minimized. The algorithm operates by building this tree one vertex
at a time, from an arbitrary starting vertex, at each step adding the cheapest possible
connection from the tree to another vertex.
"""</span>

<span class="keyword">from</span> <span class="identifier">sys</span> <span class="keyword">import</span> <span class="identifier">maxsize</span>
<span class="keyword">from</span> <span class="identifier">typing</span> <span class="keyword">import</span> <span class="identifier">Dict</span><span class="punctuation">,</span> <span class="identifier">Optional</span><span class="punctuation">,</span> <span class="identifier">Tuple</span><span class="punctuation">,</span> <span class="identifier">Union</span>


<span class="keyword">def</span> <span class="identifier">get_parent_position</span><span class="grouping">(</span><span class="identifier">position</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">int</span><span class="punctuation">:</span>
    <span class="comment">"""
    heap helper function get the position of the parent of the current node

    &gt;&gt;&gt; get_parent_position(1)
    0
    &gt;&gt;&gt; get_parent_position(2)
    0
    """</span>
    <span class="keyword">return</span> <span class="grouping">(</span><span class="identifier">position</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">)</span> <span class="arithmetic-operator">//</span> <span class="int-literal">2</span>


<span class="keyword">def</span> <span class="identifier">get_child_left_position</span><span class="grouping">(</span><span class="identifier">position</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">int</span><span class="punctuation">:</span>
    <span class="comment">"""
    heap helper function get the position of the left child of the current node

    &gt;&gt;&gt; get_child_left_position(0)
    1
    """</span>
    <span class="keyword">return</span> <span class="grouping">(</span><span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">position</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span>


<span class="keyword">def</span> <span class="identifier">get_child_right_position</span><span class="grouping">(</span><span class="identifier">position</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">int</span><span class="punctuation">:</span>
    <span class="comment">"""
    heap helper function get the position of the right child of the current node

    &gt;&gt;&gt; get_child_right_position(0)
    2
    """</span>
    <span class="keyword">return</span> <span class="grouping">(</span><span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">position</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="int-literal">2</span>


<span class="keyword">class</span> <span class="identifier">MinPriorityQueue</span><span class="punctuation">:</span>
    <span class="comment">"""
    Minimum Priority Queue Class

    Functions:
    is_empty: function to check if the priority queue is empty
    push: function to add an element with given priority to the queue
    extract_min: function to remove and return the element with lowest weight (highest
                 priority)
    update_key: function to update the weight of the given key
    _bubble_up: helper function to place a node at the proper position (upward
                movement)
    _bubble_down: helper function to place a node at the proper position (downward
                movement)
    _swap_nodes: helper function to swap the nodes at the given positions

    &gt;&gt;&gt; queue = MinPriorityQueue()

    &gt;&gt;&gt; queue.push(1, 1000)
    &gt;&gt;&gt; queue.push(2, 100)
    &gt;&gt;&gt; queue.push(3, 4000)
    &gt;&gt;&gt; queue.push(4, 3000)

    &gt;&gt;&gt; print(queue.extract_min())
    2

    &gt;&gt;&gt; queue.update_key(4, 50)

    &gt;&gt;&gt; print(queue.extract_min())
    4
    &gt;&gt;&gt; print(queue.extract_min())
    1
    &gt;&gt;&gt; print(queue.extract_min())
    3
    """</span>

    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="grouping">}</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">0</span>

    <span class="keyword">def</span> <span class="identifier">__len__</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">int</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span>

    <span class="keyword">def</span> <span class="identifier">__repr__</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">str</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">str</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">is_empty</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">bool</span><span class="punctuation">:</span>
        <span class="comment"># Check if the priority queue is empty</span>
        <span class="keyword">return</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="relational-operator">==</span> <span class="int-literal">0</span>

    <span class="keyword">def</span> <span class="identifier">push</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">elem</span><span class="punctuation">:</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">weight</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="comment"># Add an element with given priority to the queue</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">elem</span><span class="punctuation">,</span> <span class="identifier">weight</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span><span class="grouping">[</span><span class="identifier">elem</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="arithmetic-assignment">+=</span> <span class="int-literal">1</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_up</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">extract_min</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="punctuation">:</span>
        <span class="comment"># Remove and return the element with lowest weight (highest priority)</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="relational-operator">&gt;</span> <span class="int-literal">1</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_swap_nodes</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">)</span>
        <span class="identifier">elem</span><span class="punctuation">,</span> <span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="punctuation">.</span><span class="identifier">pop</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">del</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span><span class="grouping">[</span><span class="identifier">elem</span><span class="grouping">]</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="arithmetic-assignment">-=</span> <span class="int-literal">1</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="identifier">bubble_down_elem</span><span class="punctuation">,</span> <span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_down</span><span class="grouping">(</span><span class="identifier">bubble_down_elem</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">elem</span>

    <span class="keyword">def</span> <span class="identifier">update_key</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">elem</span><span class="punctuation">:</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">weight</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="comment"># Update the weight of the given key</span>
        <span class="identifier">position</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span><span class="grouping">[</span><span class="identifier">elem</span><span class="grouping">]</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">position</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">elem</span><span class="punctuation">,</span> <span class="identifier">weight</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">position</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="identifier">parent_position</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_parent_position</span><span class="grouping">(</span><span class="identifier">position</span><span class="grouping">)</span>
            <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">parent_weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">parent_position</span><span class="grouping">]</span>
            <span class="keyword">if</span> <span class="identifier">parent_weight</span> <span class="relational-operator">&gt;</span> <span class="identifier">weight</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_up</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_down</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_down</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_bubble_up</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">elem</span><span class="punctuation">:</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="comment"># Place a node at the proper position (upward movement) [to be used internally</span>
        <span class="comment"># only]</span>
        <span class="identifier">curr_pos</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span><span class="grouping">[</span><span class="identifier">elem</span><span class="grouping">]</span>
        <span class="keyword">if</span> <span class="identifier">curr_pos</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="identifier">parent_position</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_parent_position</span><span class="grouping">(</span><span class="identifier">curr_pos</span><span class="grouping">)</span>
        <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">curr_pos</span><span class="grouping">]</span>
        <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">parent_weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">parent_position</span><span class="grouping">]</span>
        <span class="keyword">if</span> <span class="identifier">parent_weight</span> <span class="relational-operator">&gt;</span> <span class="identifier">weight</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_swap_nodes</span><span class="grouping">(</span><span class="identifier">parent_position</span><span class="punctuation">,</span> <span class="identifier">curr_pos</span><span class="grouping">)</span>
            <span class="keyword">return</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_up</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>
        <span class="keyword">return</span>

    <span class="keyword">def</span> <span class="identifier">_bubble_down</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">elem</span><span class="punctuation">:</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="comment"># Place a node at the proper position (downward movement) [to be used</span>
        <span class="comment"># internally only]</span>
        <span class="identifier">curr_pos</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span><span class="grouping">[</span><span class="identifier">elem</span><span class="grouping">]</span>
        <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">curr_pos</span><span class="grouping">]</span>
        <span class="identifier">child_left_position</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_child_left_position</span><span class="grouping">(</span><span class="identifier">curr_pos</span><span class="grouping">)</span>
        <span class="identifier">child_right_position</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_child_right_position</span><span class="grouping">(</span><span class="identifier">curr_pos</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">child_left_position</span> <span class="relational-operator">&lt;</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span> <span class="logical-operator">and</span> <span class="identifier">child_right_position</span> <span class="relational-operator">&lt;</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span><span class="punctuation">:</span>
            <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">child_left_weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">child_left_position</span><span class="grouping">]</span>
            <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">child_right_weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">child_right_position</span><span class="grouping">]</span>
            <span class="keyword">if</span> <span class="identifier">child_right_weight</span> <span class="relational-operator">&lt;</span> <span class="identifier">child_left_weight</span><span class="punctuation">:</span>
                <span class="keyword">if</span> <span class="identifier">child_right_weight</span> <span class="relational-operator">&lt;</span> <span class="identifier">weight</span><span class="punctuation">:</span>
                    <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_swap_nodes</span><span class="grouping">(</span><span class="identifier">child_right_position</span><span class="punctuation">,</span> <span class="identifier">curr_pos</span><span class="grouping">)</span>
                    <span class="keyword">return</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_down</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">child_left_position</span> <span class="relational-operator">&lt;</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span><span class="punctuation">:</span>
            <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">child_left_weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">child_left_position</span><span class="grouping">]</span>
            <span class="keyword">if</span> <span class="identifier">child_left_weight</span> <span class="relational-operator">&lt;</span> <span class="identifier">weight</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_swap_nodes</span><span class="grouping">(</span><span class="identifier">child_left_position</span><span class="punctuation">,</span> <span class="identifier">curr_pos</span><span class="grouping">)</span>
                <span class="keyword">return</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_down</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="keyword">return</span>
        <span class="keyword">if</span> <span class="identifier">child_right_position</span> <span class="relational-operator">&lt;</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">elements</span><span class="punctuation">:</span>
            <span class="identifier">_</span><span class="punctuation">,</span> <span class="identifier">child_right_weight</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">child_right_position</span><span class="grouping">]</span>
            <span class="keyword">if</span> <span class="identifier">child_right_weight</span> <span class="relational-operator">&lt;</span> <span class="identifier">weight</span><span class="punctuation">:</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_swap_nodes</span><span class="grouping">(</span><span class="identifier">child_right_position</span><span class="punctuation">,</span> <span class="identifier">curr_pos</span><span class="grouping">)</span>
                <span class="keyword">return</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_bubble_down</span><span class="grouping">(</span><span class="identifier">elem</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="keyword">return</span>

    <span class="keyword">def</span> <span class="identifier">_swap_nodes</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">node1_pos</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">node2_pos</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="comment"># Swap the nodes at the given positions</span>
        <span class="identifier">node1_elem</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">node1_pos</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
        <span class="identifier">node2_elem</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">node2_pos</span><span class="grouping">]</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">node1_pos</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">node2_pos</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">node2_pos</span><span class="grouping">]</span><span class="punctuation">,</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">heap</span><span class="grouping">[</span><span class="identifier">node1_pos</span><span class="grouping">]</span><span class="punctuation">,</span>
        <span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span><span class="grouping">[</span><span class="identifier">node1_elem</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">node2_pos</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">position_map</span><span class="grouping">[</span><span class="identifier">node2_elem</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">node1_pos</span>


<span class="keyword">class</span> <span class="identifier">GraphUndirectedWeighted</span><span class="punctuation">:</span>
    <span class="comment">"""
    Graph Undirected Weighted Class

    Functions:
    add_node: function to add a node in the graph
    add_edge: function to add an edge between 2 nodes in the graph
    """</span>

    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">connections</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="grouping">}</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">nodes</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">0</span>

    <span class="keyword">def</span> <span class="identifier">__repr__</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">str</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">str</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">__len__</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">int</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">nodes</span>

    <span class="keyword">def</span> <span class="identifier">add_node</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">node</span><span class="punctuation">:</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="comment"># Add a node in the graph if it is not in the graph</span>
        <span class="keyword">if</span> <span class="identifier">node</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="grouping">}</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">nodes</span> <span class="arithmetic-assignment">+=</span> <span class="int-literal">1</span>

    <span class="keyword">def</span> <span class="identifier">add_edge</span><span class="grouping">(</span>
        <span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">node1</span><span class="punctuation">:</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">node2</span><span class="punctuation">:</span> <span class="identifier">Union</span><span class="grouping">[</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">str</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">weight</span><span class="punctuation">:</span> <span class="identifier">int</span>
    <span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="none-literal">None</span><span class="punctuation">:</span>
        <span class="comment"># Add an edge between 2 nodes in the graph</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_node</span><span class="grouping">(</span><span class="identifier">node1</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_node</span><span class="grouping">(</span><span class="identifier">node2</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node1</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">node2</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">weight</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node2</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">node1</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">weight</span>


<span class="keyword">def</span> <span class="identifier">prims_algo</span><span class="grouping">(</span>
    <span class="identifier">graph</span><span class="punctuation">:</span> <span class="identifier">GraphUndirectedWeighted</span><span class="punctuation">,</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">Tuple</span><span class="grouping">[</span><span class="identifier">Dict</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">int</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">Dict</span><span class="grouping">[</span><span class="identifier">str</span><span class="punctuation">,</span> <span class="identifier">Optional</span><span class="grouping">[</span><span class="identifier">str</span><span class="grouping">]</span><span class="grouping">]</span><span class="grouping">]</span><span class="punctuation">:</span>
    <span class="comment">"""
    &gt;&gt;&gt; graph = GraphUndirectedWeighted()

    &gt;&gt;&gt; graph.add_edge("a", "b", 3)
    &gt;&gt;&gt; graph.add_edge("b", "c", 10)
    &gt;&gt;&gt; graph.add_edge("c", "d", 5)
    &gt;&gt;&gt; graph.add_edge("a", "c", 15)
    &gt;&gt;&gt; graph.add_edge("b", "d", 100)

    &gt;&gt;&gt; dist, parent = prims_algo(graph)

    &gt;&gt;&gt; abs(dist["a"] - dist["b"])
    3
    &gt;&gt;&gt; abs(dist["d"] - dist["b"])
    15
    &gt;&gt;&gt; abs(dist["a"] - dist["c"])
    13
    """</span>
    <span class="comment"># prim's algorithm for minimum spanning tree</span>
    <span class="identifier">dist</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="identifier">node</span><span class="punctuation">:</span> <span class="identifier">maxsize</span> <span class="keyword">for</span> <span class="identifier">node</span> <span class="relational-operator">in</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">}</span>
    <span class="identifier">parent</span> <span class="arithmetic-assignment">=</span> <span class="grouping">{</span><span class="identifier">node</span><span class="punctuation">:</span> <span class="none-literal">None</span> <span class="keyword">for</span> <span class="identifier">node</span> <span class="relational-operator">in</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">}</span>
    <span class="identifier">priority_queue</span> <span class="arithmetic-assignment">=</span> <span class="identifier">MinPriorityQueue</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="grouping">[</span><span class="identifier">priority_queue</span><span class="punctuation">.</span><span class="identifier">push</span><span class="grouping">(</span><span class="identifier">node</span><span class="punctuation">,</span> <span class="identifier">weight</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">node</span><span class="punctuation">,</span> <span class="identifier">weight</span> <span class="relational-operator">in</span> <span class="identifier">dist</span><span class="punctuation">.</span><span class="identifier">items</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">]</span>
    <span class="keyword">if</span> <span class="identifier">priority_queue</span><span class="punctuation">.</span><span class="identifier">is_empty</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="identifier">dist</span><span class="punctuation">,</span> <span class="identifier">parent</span>

    <span class="comment"># initialization</span>
    <span class="identifier">node</span> <span class="arithmetic-assignment">=</span> <span class="identifier">priority_queue</span><span class="punctuation">.</span><span class="identifier">extract_min</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">0</span>
    <span class="keyword">for</span> <span class="identifier">neighbour</span> <span class="relational-operator">in</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span> <span class="relational-operator">&gt;</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span><span class="punctuation">:</span>
            <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span>
            <span class="identifier">priority_queue</span><span class="punctuation">.</span><span class="identifier">update_key</span><span class="grouping">(</span><span class="identifier">neighbour</span><span class="punctuation">,</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span><span class="grouping">)</span>
            <span class="identifier">parent</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">node</span>
    <span class="comment"># running prim's algorithm</span>
    <span class="keyword">while</span> <span class="logical-operator">not</span> <span class="identifier">priority_queue</span><span class="punctuation">.</span><span class="identifier">is_empty</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">node</span> <span class="arithmetic-assignment">=</span> <span class="identifier">priority_queue</span><span class="punctuation">.</span><span class="identifier">extract_min</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">neighbour</span> <span class="relational-operator">in</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span> <span class="relational-operator">&gt;</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span><span class="punctuation">:</span>
                <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">graph</span><span class="punctuation">.</span><span class="identifier">connections</span><span class="grouping">[</span><span class="identifier">node</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span>
                <span class="identifier">priority_queue</span><span class="punctuation">.</span><span class="identifier">update_key</span><span class="grouping">(</span><span class="identifier">neighbour</span><span class="punctuation">,</span> <span class="identifier">dist</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span><span class="grouping">)</span>
                <span class="identifier">parent</span><span class="grouping">[</span><span class="identifier">neighbour</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="identifier">node</span>
    <span class="keyword">return</span> <span class="identifier">dist</span><span class="punctuation">,</span> <span class="identifier">parent</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="relational-operator">==</span> <span class="string-literal">"__main__"</span><span class="punctuation">:</span>
    <span class="keyword">from</span> <span class="identifier">doctest</span> <span class="keyword">import</span> <span class="identifier">testmod</span>

    <span class="identifier">testmod</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>