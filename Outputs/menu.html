<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">#!/usr/bin python3</span>
<span class="comment">""" The Menu Bars for faceswap GUI """</span>

<span class="keyword">import</span> <span class="identifier">gettext</span>
<span class="keyword">import</span> <span class="identifier">locale</span>
<span class="keyword">import</span> <span class="identifier">logging</span>
<span class="keyword">import</span> <span class="identifier">os</span>
<span class="keyword">import</span> <span class="identifier">sys</span>
<span class="keyword">import</span> <span class="identifier">tkinter</span> <span class="keyword">as</span> <span class="identifier">tk</span>
<span class="keyword">from</span> <span class="identifier">tkinter</span> <span class="keyword">import</span> <span class="identifier">ttk</span>
<span class="keyword">import</span> <span class="identifier">webbrowser</span>

<span class="keyword">from</span> <span class="identifier">subprocess</span> <span class="keyword">import</span> <span class="identifier">Popen</span><span class="punctuation">,</span> <span class="identifier">PIPE</span><span class="punctuation">,</span> <span class="identifier">STDOUT</span>

<span class="keyword">from</span> <span class="identifier">lib</span><span class="punctuation">.</span><span class="identifier">multithreading</span> <span class="keyword">import</span> <span class="identifier">MultiThread</span>
<span class="keyword">from</span> <span class="identifier">lib</span><span class="punctuation">.</span><span class="identifier">serializer</span> <span class="keyword">import</span> <span class="identifier">get_serializer</span>
<span class="keyword">from</span> <span class="identifier">lib</span><span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">FaceswapError</span>
<span class="keyword">import</span> <span class="identifier">update_deps</span>

<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">popup_configure</span> <span class="keyword">import</span> <span class="identifier">open_popup</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">custom_widgets</span> <span class="keyword">import</span> <span class="identifier">Tooltip</span>
<span class="keyword">from</span> <span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="identifier">get_config</span><span class="punctuation">,</span> <span class="identifier">get_images</span>

<span class="identifier">logger</span> <span class="arithmetic-assignment">=</span> <span class="identifier">logging</span><span class="punctuation">.</span><span class="identifier">getLogger</span><span class="grouping">(</span><span class="identifier">__name__</span><span class="grouping">)</span>  <span class="comment"># pylint: disable=invalid-name</span>

<span class="comment"># LOCALES</span>
<span class="identifier">_LANG</span> <span class="arithmetic-assignment">=</span> <span class="identifier">gettext</span><span class="punctuation">.</span><span class="identifier">translation</span><span class="grouping">(</span><span class="string-literal">"gui.tooltips", localedir="locales"</span><span class="punctuation">,</span> <span class="identifier">fallback</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
<span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_LANG</span><span class="punctuation">.</span><span class="identifier">gettext</span>

<span class="identifier">_WORKING_DIR</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">realpath</span><span class="grouping">(</span><span class="identifier">sys</span><span class="punctuation">.</span><span class="identifier">argv</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span>

<span class="identifier">_RESOURCES</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">(</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"faceswap.dev - Guides and Forum"), "https://www.faceswap.dev"</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="grouping">(</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Patreon - Support this project"), "https://www.patreon.com/faceswap"</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="grouping">(</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Discord - The FaceSwap Discord server"), "https://discord.gg/VasFUAy"</span><span class="grouping">)</span><span class="punctuation">,</span>
              <span class="grouping">(</span><span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Github - Our Source Code"), "https://github.com/deepfakes/faceswap"</span><span class="grouping">)</span><span class="grouping">]</span>


<span class="keyword">class</span> <span class="identifier">MainMenuBar</span><span class="grouping">(</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Menu</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint:disable=too-many-ancestors</span>
    <span class="comment">""" GUI Main Menu Bar """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">master</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initializing %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">master</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span> <span class="arithmetic-assignment">=</span> <span class="identifier">master</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">file_menu</span> <span class="arithmetic-assignment">=</span> <span class="identifier">FileMenu</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">settings_menu</span> <span class="arithmetic-assignment">=</span> <span class="identifier">SettingsMenu</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">help_menu</span> <span class="arithmetic-assignment">=</span> <span class="identifier">HelpMenu</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_cascade</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"File"</span><span class="punctuation">,</span> <span class="identifier">menu</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">file_menu</span><span class="punctuation">,</span> <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_cascade</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Settings"</span><span class="punctuation">,</span> <span class="identifier">menu</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">settings_menu</span><span class="punctuation">,</span> <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_cascade</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Help"</span><span class="punctuation">,</span> <span class="identifier">menu</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">help_menu</span><span class="punctuation">,</span> <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initialized %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>


<span class="keyword">class</span> <span class="identifier">SettingsMenu</span><span class="grouping">(</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Menu</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint:disable=too-many-ancestors</span>
    <span class="comment">""" Settings menu items and functions """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">parent</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initializing %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">parent</span><span class="punctuation">,</span> <span class="identifier">tearoff</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span> <span class="arithmetic-assignment">=</span> <span class="identifier">parent</span><span class="punctuation">.</span><span class="identifier">root</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">build</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initialized %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">build</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the settings menu to the menu bar """</span>
        <span class="comment"># pylint: disable=cell-var-from-loop</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building settings menu"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Configure Settings..."</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">open_popup</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built settings menu"</span><span class="grouping">)</span>


<span class="keyword">class</span> <span class="identifier">FileMenu</span><span class="grouping">(</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Menu</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint:disable=too-many-ancestors</span>
    <span class="comment">""" File menu items and functions """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">parent</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initializing %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">parent</span><span class="punctuation">,</span> <span class="identifier">tearoff</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span> <span class="arithmetic-assignment">=</span> <span class="identifier">parent</span><span class="punctuation">.</span><span class="identifier">root</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_config</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recent_menu</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Menu</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">tearoff</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">postcommand</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">refresh_recent_menu</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">build</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initialized %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">build</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Add the file menu to the menu bar """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building File menu"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"New Project..."</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Ctrl+N"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">new</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;Control-n&gt;"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">new</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Open Project..."</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Ctrl+O"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">load</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;Control-o&gt;"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">load</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Save Project"</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Ctrl+S"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">save_as</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;Control-s&gt;"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">e</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">e</span><span class="punctuation">,</span> <span class="identifier">save_as</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Save Project as..."</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">13</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Ctrl+Alt+S"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">save_as</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;Control-Alt-s&gt;"</span><span class="punctuation">,</span> <span class="keyword">lambda</span> <span class="identifier">e</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">e</span><span class="punctuation">,</span> <span class="identifier">save_as</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Reload Project from Disk"</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"F5"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">reload</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;F5&gt;"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">reload</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Close Project"</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Ctrl+W"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">close</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;Control-w&gt;"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">close</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Open Task..."</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">5</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Ctrl+Alt+T"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">tasks</span><span class="punctuation">.</span><span class="identifier">load</span><span class="grouping">(</span><span class="identifier">current_tab</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;Control-Alt-t&gt;"</span><span class="punctuation">,</span>
                           <span class="keyword">lambda</span> <span class="identifier">e</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">tasks</span><span class="punctuation">.</span><span class="identifier">load</span><span class="grouping">(</span><span class="identifier">e</span><span class="punctuation">,</span> <span class="identifier">current_tab</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_cascade</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Open recent"</span><span class="punctuation">,</span> <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="identifier">menu</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recent_menu</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Quit"</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">accelerator</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Alt+F4"</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">close_app</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">bind_all</span><span class="grouping">(</span><span class="string-literal">"&lt;Alt-F4&gt;"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">close_app</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built File menu"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">build_recent_menu</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Load recent files into menu bar """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Recent Files menu"</span><span class="grouping">)</span>
        <span class="identifier">serializer</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_serializer</span><span class="grouping">(</span><span class="string-literal">"json"</span><span class="grouping">)</span>
        <span class="identifier">menu_file</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">pathcache</span><span class="punctuation">,</span> <span class="string-literal">".recent.json"</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">isfile</span><span class="grouping">(</span><span class="identifier">menu_file</span><span class="grouping">)</span> <span class="logical-operator">or</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">getsize</span><span class="grouping">(</span><span class="identifier">menu_file</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">clear_recent_files</span><span class="grouping">(</span><span class="identifier">serializer</span><span class="punctuation">,</span> <span class="identifier">menu_file</span><span class="grouping">)</span>
        <span class="keyword">try</span><span class="punctuation">:</span>
            <span class="identifier">recent_files</span> <span class="arithmetic-assignment">=</span> <span class="identifier">serializer</span><span class="punctuation">.</span><span class="identifier">load</span><span class="grouping">(</span><span class="identifier">menu_file</span><span class="grouping">)</span>
        <span class="keyword">except</span> <span class="identifier">FaceswapError</span> <span class="keyword">as</span> <span class="identifier">err</span><span class="punctuation">:</span>
            <span class="keyword">if</span> <span class="string-literal">"Error unserializing data for type"</span> <span class="relational-operator">in</span> <span class="identifier">str</span><span class="grouping">(</span><span class="identifier">err</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="comment"># Some reports of corruption breaking menus</span>
                <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">warning</span><span class="grouping">(</span><span class="string-literal">"There was an error opening the recent files list so it has been "</span>
                               <span class="string-literal">"reset."</span><span class="grouping">)</span>
                <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">clear_recent_files</span><span class="grouping">(</span><span class="identifier">serializer</span><span class="punctuation">,</span> <span class="identifier">menu_file</span><span class="grouping">)</span>
                <span class="identifier">recent_files</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Loaded recent files: %s"</span><span class="punctuation">,</span> <span class="identifier">recent_files</span><span class="grouping">)</span>
        <span class="identifier">removed_files</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
        <span class="keyword">for</span> <span class="identifier">recent_item</span> <span class="relational-operator">in</span> <span class="identifier">recent_files</span><span class="punctuation">:</span>
            <span class="identifier">filename</span><span class="punctuation">,</span> <span class="identifier">command</span> <span class="arithmetic-assignment">=</span> <span class="identifier">recent_item</span>
            <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">isfile</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"File does not exist. Flagging for removal: '%s'"</span><span class="punctuation">,</span> <span class="identifier">filename</span><span class="grouping">)</span>
                <span class="identifier">removed_files</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">recent_item</span><span class="grouping">)</span>
                <span class="keyword">continue</span>
            <span class="comment"># Legacy project files didn't have a command stored</span>
            <span class="identifier">command</span> <span class="arithmetic-assignment">=</span> <span class="identifier">command</span> <span class="keyword">if</span> <span class="identifier">command</span> <span class="keyword">else</span> <span class="string-literal">"project"</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"processing: ('%s', %s)"</span><span class="punctuation">,</span> <span class="identifier">filename</span><span class="punctuation">,</span> <span class="identifier">command</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">command</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="string-literal">"project"</span><span class="punctuation">:</span>
                <span class="identifier">load_func</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">.</span><span class="identifier">load</span>
                <span class="identifier">lbl</span> <span class="arithmetic-assignment">=</span> <span class="identifier">command</span>
                <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">filename</span><span class="arithmetic-assignment">=</span><span class="identifier">filename</span><span class="grouping">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="identifier">load_func</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">tasks</span><span class="punctuation">.</span><span class="identifier">load</span>
                <span class="identifier">lbl</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"{} Task"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">command</span><span class="grouping">)</span>
                <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">filename</span><span class="arithmetic-assignment">=</span><span class="identifier">filename</span><span class="punctuation">,</span> <span class="identifier">current_tab</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recent_menu</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span>
                <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"{} ({})"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">filename</span><span class="punctuation">,</span> <span class="identifier">lbl</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">kw</span><span class="arithmetic-assignment">=</span><span class="identifier">kwargs</span><span class="punctuation">,</span> <span class="identifier">fn</span><span class="arithmetic-assignment">=</span><span class="identifier">load_func</span><span class="punctuation">:</span> <span class="identifier">fn</span><span class="grouping">(</span><span class="arithmetic-operator">**</span><span class="identifier">kw</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">removed_files</span><span class="punctuation">:</span>
            <span class="keyword">for</span> <span class="identifier">recent_item</span> <span class="relational-operator">in</span> <span class="identifier">removed_files</span><span class="punctuation">:</span>
                <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Removing from recent files: `%s`"</span><span class="punctuation">,</span> <span class="identifier">recent_item</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="grouping">)</span>
                <span class="identifier">recent_files</span><span class="punctuation">.</span><span class="identifier">remove</span><span class="grouping">(</span><span class="identifier">recent_item</span><span class="grouping">)</span>
            <span class="identifier">serializer</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">menu_file</span><span class="punctuation">,</span> <span class="identifier">recent_files</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recent_menu</span><span class="punctuation">.</span><span class="identifier">add_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recent_menu</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span>
            <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Clear recent files"</span><span class="punctuation">,</span>
            <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
            <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">srl</span><span class="arithmetic-assignment">=</span><span class="identifier">serializer</span><span class="punctuation">,</span> <span class="identifier">mnu</span><span class="arithmetic-assignment">=</span><span class="identifier">menu_file</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">clear_recent_files</span><span class="grouping">(</span><span class="identifier">srl</span><span class="punctuation">,</span> <span class="identifier">mnu</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built Recent Files menu"</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">clear_recent_files</span><span class="grouping">(</span><span class="identifier">serializer</span><span class="punctuation">,</span> <span class="identifier">menu_file</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Creates or clears recent file list """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"clearing recent files list: '%s'"</span><span class="punctuation">,</span> <span class="identifier">menu_file</span><span class="grouping">)</span>
        <span class="identifier">serializer</span><span class="punctuation">.</span><span class="identifier">save</span><span class="grouping">(</span><span class="identifier">menu_file</span><span class="punctuation">,</span> <span class="identifier">list</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">refresh_recent_menu</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Refresh recent menu on save/load of files """</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recent_menu</span><span class="punctuation">.</span><span class="invalid">d</span><span class="invalid">e</span><span class="invalid">l</span><span class="invalid">e</span><span class="invalid">t</span><span class="invalid">e</span><span class="grouping">(</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="string-literal">"end"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">build_recent_menu</span><span class="grouping">(</span><span class="grouping">)</span>


<span class="keyword">class</span> <span class="identifier">HelpMenu</span><span class="grouping">(</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Menu</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint:disable=too-many-ancestors</span>
    <span class="comment">""" Help menu items and functions """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">parent</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initializing %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">parent</span><span class="punctuation">,</span> <span class="identifier">tearoff</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span> <span class="arithmetic-assignment">=</span> <span class="identifier">parent</span><span class="punctuation">.</span><span class="identifier">root</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recources_menu</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Menu</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">tearoff</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_branches_menu</span> <span class="arithmetic-assignment">=</span> <span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Menu</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">tearoff</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">build</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Initialized %s"</span><span class="punctuation">,</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">__class__</span><span class="punctuation">.</span><span class="identifier">__name__</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">build</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Build the help menu """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Help menu"</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Check for updates..."</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">action</span><span class="arithmetic-assignment">=</span><span class="string-literal">"check"</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">in_thread</span><span class="grouping">(</span><span class="identifier">action</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Update Faceswap..."</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">action</span><span class="arithmetic-assignment">=</span><span class="string-literal">"update"</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">in_thread</span><span class="grouping">(</span><span class="identifier">action</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_build_branches_menu</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_cascade</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Switch Branch"</span><span class="punctuation">,</span> <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">7</span><span class="punctuation">,</span> <span class="identifier">menu</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_branches_menu</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_build_recources_menu</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_cascade</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Resources"</span><span class="punctuation">,</span> <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="identifier">menu</span><span class="arithmetic-assignment">=</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recources_menu</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span><span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Output System Information"</span><span class="punctuation">,</span>
                         <span class="identifier">underline</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                         <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">action</span><span class="arithmetic-assignment">=</span><span class="string-literal">"output_sysinfo"</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">in_thread</span><span class="grouping">(</span><span class="identifier">action</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built help menu"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_build_branches_menu</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Build branch selection menu.

        Queries git for available branches and builds a menu based on output.

        Returns
        -------
        bool
            ``True`` if menu was successfully built otherwise ``False``
        """</span>
        <span class="identifier">stdout</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_get_branches</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">stdout</span> <span class="relational-operator">is</span> <span class="none-literal">None</span><span class="punctuation">:</span>
            <span class="keyword">return</span> <span class="bool-literal">False</span>

        <span class="identifier">branches</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_filter_branches</span><span class="grouping">(</span><span class="identifier">stdout</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">branches</span><span class="punctuation">:</span>
            <span class="keyword">return</span> <span class="bool-literal">False</span>

        <span class="keyword">for</span> <span class="identifier">branch</span> <span class="relational-operator">in</span> <span class="identifier">branches</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_branches_menu</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span>
                <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="identifier">branch</span><span class="punctuation">,</span>
                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">b</span><span class="arithmetic-assignment">=</span><span class="identifier">branch</span><span class="punctuation">:</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_switch_branch</span><span class="grouping">(</span><span class="identifier">b</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="bool-literal">True</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">_get_branches</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Get the available github branches

        Returns
        -------
        str
            The list of branches available. If no branches were found or there was an
            error then `None` is returned
        """</span>
        <span class="identifier">gitcmd</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"git branch -a"</span>
        <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Popen</span><span class="grouping">(</span><span class="identifier">gitcmd</span><span class="punctuation">,</span> <span class="identifier">shell</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">stdout</span><span class="arithmetic-assignment">=</span><span class="identifier">PIPE</span><span class="punctuation">,</span> <span class="identifier">stderr</span><span class="arithmetic-assignment">=</span><span class="identifier">STDOUT</span><span class="punctuation">,</span> <span class="identifier">cwd</span><span class="arithmetic-assignment">=</span><span class="identifier">_WORKING_DIR</span><span class="grouping">)</span>
        <span class="identifier">stdout</span><span class="punctuation">,</span> <span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">communicate</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">retcode</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">poll</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">retcode</span> <span class="relational-operator">!=</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Unable to list git branches. return code: %s, message: %s"</span><span class="punctuation">,</span>
                         <span class="identifier">retcode</span><span class="punctuation">,</span> <span class="identifier">stdout</span><span class="punctuation">.</span><span class="identifier">decode</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">"\n", " - "</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="keyword">return</span> <span class="none-literal">None</span>
        <span class="keyword">return</span> <span class="identifier">stdout</span><span class="punctuation">.</span><span class="identifier">decode</span><span class="grouping">(</span><span class="identifier">locale</span><span class="punctuation">.</span><span class="identifier">getpreferredencoding</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">_filter_branches</span><span class="grouping">(</span><span class="identifier">stdout</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Filter the branches, remove duplicates and the current branch and return a sorted
        list.

        Parameters
        ----------
        stdout: str
            The output from the git branch query converted to a string

        Returns
        -------
        list
            Unique list of available branches sorted in alphabetical order
        """</span>
        <span class="identifier">current</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span>
        <span class="identifier">branches</span> <span class="arithmetic-assignment">=</span> <span class="identifier">set</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">line</span> <span class="relational-operator">in</span> <span class="identifier">stdout</span><span class="punctuation">.</span><span class="identifier">splitlines</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">branch</span> <span class="arithmetic-assignment">=</span> <span class="identifier">line</span><span class="grouping">[</span><span class="identifier">line</span><span class="punctuation">.</span><span class="identifier">rfind</span><span class="grouping">(</span><span class="string-literal">"/") + 1:] if "/"</span> <span class="relational-operator">in</span> <span class="identifier">line</span> <span class="keyword">else</span> <span class="identifier">line</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">branch</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"*"</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">branch</span> <span class="arithmetic-assignment">=</span> <span class="identifier">branch</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">"*", ""</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span>
                <span class="identifier">current</span> <span class="arithmetic-assignment">=</span> <span class="identifier">branch</span>
                <span class="keyword">continue</span>
            <span class="identifier">branches</span><span class="punctuation">.</span><span class="identifier">add</span><span class="grouping">(</span><span class="identifier">branch</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Found branches: %s"</span><span class="punctuation">,</span> <span class="identifier">branches</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">current</span> <span class="relational-operator">in</span> <span class="identifier">branches</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Removing current branch from output: %s"</span><span class="punctuation">,</span> <span class="identifier">current</span><span class="grouping">)</span>
            <span class="identifier">branches</span><span class="punctuation">.</span><span class="identifier">remove</span><span class="grouping">(</span><span class="identifier">current</span><span class="grouping">)</span>

        <span class="identifier">branches</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sorted</span><span class="grouping">(</span><span class="identifier">list</span><span class="grouping">(</span><span class="identifier">branches</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">key</span><span class="arithmetic-assignment">=</span><span class="identifier">str</span><span class="punctuation">.</span><span class="identifier">casefold</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Final branches: %s"</span><span class="punctuation">,</span> <span class="identifier">branches</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">branches</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">_switch_branch</span><span class="grouping">(</span><span class="identifier">branch</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Change the currently checked out branch, and return a notification.

        Parameters
        ----------
        str
            The branch to switch to
        """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="string-literal">"Switching branch to '%s'..."</span><span class="punctuation">,</span> <span class="identifier">branch</span><span class="grouping">)</span>
        <span class="identifier">gitcmd</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"git checkout {}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">branch</span><span class="grouping">)</span>
        <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Popen</span><span class="grouping">(</span><span class="identifier">gitcmd</span><span class="punctuation">,</span> <span class="identifier">shell</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">stdout</span><span class="arithmetic-assignment">=</span><span class="identifier">PIPE</span><span class="punctuation">,</span> <span class="identifier">stderr</span><span class="arithmetic-assignment">=</span><span class="identifier">STDOUT</span><span class="punctuation">,</span> <span class="identifier">cwd</span><span class="arithmetic-assignment">=</span><span class="identifier">_WORKING_DIR</span><span class="grouping">)</span>
        <span class="identifier">stdout</span><span class="punctuation">,</span> <span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">communicate</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">retcode</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">poll</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">retcode</span> <span class="relational-operator">!=</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">error</span><span class="grouping">(</span><span class="string-literal">"Unable to switch branch. return code: %s, message: %s"</span><span class="punctuation">,</span>
                         <span class="identifier">retcode</span><span class="punctuation">,</span> <span class="identifier">stdout</span><span class="punctuation">.</span><span class="identifier">decode</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">replace</span><span class="grouping">(</span><span class="string-literal">"\n", " - "</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="keyword">return</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="string-literal">"Succesfully switched to '%s'. You may want to check for updates to make sure "</span>
                    <span class="string-literal">"that you have the latest code."</span><span class="punctuation">,</span> <span class="identifier">branch</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="string-literal">"Please restart Faceswap to complete the switch."</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_build_recources_menu</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Build resources menu """</span>
        <span class="comment"># pylint: disable=cell-var-from-loop</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Building Resources Files menu"</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">resource</span> <span class="relational-operator">in</span> <span class="identifier">_RESOURCES</span><span class="punctuation">:</span>
            <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">recources_menu</span><span class="punctuation">.</span><span class="identifier">add_command</span><span class="grouping">(</span>
                <span class="identifier">label</span><span class="arithmetic-assignment">=</span><span class="identifier">resource</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span>
                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">link</span><span class="arithmetic-assignment">=</span><span class="identifier">resource</span><span class="grouping">[</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">:</span> <span class="identifier">webbrowser</span><span class="punctuation">.</span><span class="identifier">open_new</span><span class="grouping">(</span><span class="identifier">link</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Built resources menu"</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">in_thread</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Perform selected action inside a thread """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Performing help action: %s"</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="grouping">)</span>
        <span class="identifier">thread</span> <span class="arithmetic-assignment">=</span> <span class="identifier">MultiThread</span><span class="grouping">(</span><span class="identifier">getattr</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">thread_count</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>
        <span class="identifier">thread</span><span class="punctuation">.</span><span class="identifier">start</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Performed help action: %s"</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">clear_console</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Clear the console window """</span>
        <span class="identifier">get_config</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">tk_vars</span><span class="grouping">[</span><span class="string-literal">"console_clear"</span><span class="grouping">]</span><span class="punctuation">.</span><span class="identifier">set</span><span class="grouping">(</span><span class="bool-literal">True</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">output_sysinfo</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Output system information to console """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Obtaining system information"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">config</span><span class="grouping">(</span><span class="identifier">cursor</span><span class="arithmetic-assignment">=</span><span class="string-literal">"watch"</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">clear_console</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">try</span><span class="punctuation">:</span>
            <span class="keyword">from</span> <span class="identifier">lib</span><span class="punctuation">.</span><span class="identifier">sysinfo</span> <span class="keyword">import</span> <span class="identifier">sysinfo</span>  <span class="comment"># pylint:disable=import-outside-toplevel</span>
            <span class="identifier">info</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sysinfo</span>
        <span class="keyword">except</span> <span class="invalid">E</span><span class="invalid">x</span><span class="invalid">c</span><span class="invalid">e</span><span class="invalid">p</span><span class="invalid">t</span><span class="invalid">i</span><span class="invalid">o</span><span class="invalid">n</span> <span class="keyword">as</span> <span class="identifier">err</span><span class="punctuation">:</span>  <span class="comment"># pylint:disable=broad-except</span>
            <span class="identifier">info</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Error obtaining system info: {}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">str</span><span class="grouping">(</span><span class="identifier">err</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">clear_console</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Obtained system information: %s"</span><span class="punctuation">,</span> <span class="identifier">info</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">info</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">config</span><span class="grouping">(</span><span class="identifier">cursor</span><span class="arithmetic-assignment">=</span><span class="string-literal">""</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">check</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Check for updates and clone repository """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Checking for updates..."</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">config</span><span class="grouping">(</span><span class="identifier">cursor</span><span class="arithmetic-assignment">=</span><span class="string-literal">"watch"</span><span class="grouping">)</span>
        <span class="identifier">encoding</span> <span class="arithmetic-assignment">=</span> <span class="identifier">locale</span><span class="punctuation">.</span><span class="identifier">getpreferredencoding</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Encoding: %s"</span><span class="punctuation">,</span> <span class="identifier">encoding</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">check_for_updates</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="punctuation">,</span> <span class="identifier">check</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">config</span><span class="grouping">(</span><span class="identifier">cursor</span><span class="arithmetic-assignment">=</span><span class="string-literal">""</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">update</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Check for updates and clone repository """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Updating Faceswap..."</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">config</span><span class="grouping">(</span><span class="identifier">cursor</span><span class="arithmetic-assignment">=</span><span class="string-literal">"watch"</span><span class="grouping">)</span>
        <span class="identifier">encoding</span> <span class="arithmetic-assignment">=</span> <span class="identifier">locale</span><span class="punctuation">.</span><span class="identifier">getpreferredencoding</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Encoding: %s"</span><span class="punctuation">,</span> <span class="identifier">encoding</span><span class="grouping">)</span>
        <span class="identifier">success</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">False</span>
        <span class="keyword">if</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">check_for_updates</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">success</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">do_update</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="grouping">)</span>
        <span class="identifier">update_deps</span><span class="punctuation">.</span><span class="identifier">main</span><span class="grouping">(</span><span class="identifier">logger</span><span class="arithmetic-assignment">=</span><span class="identifier">logger</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">success</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="string-literal">"Please restart Faceswap to complete the update."</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">root</span><span class="punctuation">.</span><span class="identifier">config</span><span class="grouping">(</span><span class="identifier">cursor</span><span class="arithmetic-assignment">=</span><span class="string-literal">""</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">check_for_updates</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="punctuation">,</span> <span class="identifier">check</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Check whether an update is required """</span>
        <span class="comment"># Do the check</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="string-literal">"Checking for updates..."</span><span class="grouping">)</span>
        <span class="identifier">update</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">False</span>
        <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>
        <span class="identifier">gitcmd</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"git remote update && git status -uno"</span>
        <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Popen</span><span class="grouping">(</span><span class="identifier">gitcmd</span><span class="punctuation">,</span> <span class="identifier">shell</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">stdout</span><span class="arithmetic-assignment">=</span><span class="identifier">PIPE</span><span class="punctuation">,</span> <span class="identifier">stderr</span><span class="arithmetic-assignment">=</span><span class="identifier">STDOUT</span><span class="punctuation">,</span> <span class="identifier">cwd</span><span class="arithmetic-assignment">=</span><span class="identifier">_WORKING_DIR</span><span class="grouping">)</span>
        <span class="identifier">stdout</span><span class="punctuation">,</span> <span class="identifier">_</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">communicate</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">retcode</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">poll</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">retcode</span> <span class="relational-operator">!=</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="string-literal">"Git is not installed or you are not running a cloned repo. "</span>
                   <span class="string-literal">"Unable to check for updates"</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">chk</span> <span class="arithmetic-assignment">=</span> <span class="identifier">stdout</span><span class="punctuation">.</span><span class="identifier">decode</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">splitlines</span><span class="grouping">(</span><span class="grouping">)</span>
            <span class="keyword">for</span> <span class="identifier">line</span> <span class="relational-operator">in</span> <span class="identifier">chk</span><span class="punctuation">:</span>
                <span class="keyword">if</span> <span class="identifier">line</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"your branch is ahead"</span><span class="grouping">)</span><span class="punctuation">:</span>
                    <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Your branch is ahead of the remote repo. Not updating"</span>
                    <span class="keyword">break</span>
                <span class="keyword">if</span> <span class="identifier">line</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"your branch is up to date"</span><span class="grouping">)</span><span class="punctuation">:</span>
                    <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Faceswap is up to date."</span>
                    <span class="keyword">break</span>
                <span class="keyword">if</span> <span class="identifier">line</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"your branch is behind"</span><span class="grouping">)</span><span class="punctuation">:</span>
                    <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"There are updates available"</span>
                    <span class="identifier">update</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">True</span>
                    <span class="keyword">break</span>
                <span class="keyword">if</span> <span class="string-literal">"have diverged"</span> <span class="relational-operator">in</span> <span class="identifier">line</span><span class="punctuation">.</span><span class="identifier">lower</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
                    <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"Your branch has diverged from the remote repo. Not updating"</span>
                    <span class="keyword">break</span>
        <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">update</span> <span class="logical-operator">or</span> <span class="identifier">check</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="identifier">msg</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Checked for update. Update required: %s"</span><span class="punctuation">,</span> <span class="identifier">update</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">update</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">do_update</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Update Faceswap """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="string-literal">"A new version is available. Updating..."</span><span class="grouping">)</span>
        <span class="identifier">gitcmd</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"git pull"</span>
        <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Popen</span><span class="grouping">(</span><span class="identifier">gitcmd</span><span class="punctuation">,</span> <span class="identifier">shell</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="punctuation">,</span> <span class="identifier">stdout</span><span class="arithmetic-assignment">=</span><span class="identifier">PIPE</span><span class="punctuation">,</span> <span class="identifier">stderr</span><span class="arithmetic-assignment">=</span><span class="identifier">STDOUT</span><span class="punctuation">,</span> <span class="identifier">bufsize</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="identifier">cwd</span><span class="arithmetic-assignment">=</span><span class="identifier">_WORKING_DIR</span><span class="grouping">)</span>
        <span class="keyword">while</span> <span class="bool-literal">True</span><span class="punctuation">:</span>
            <span class="identifier">output</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">stdout</span><span class="punctuation">.</span><span class="identifier">readline</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">decode</span><span class="grouping">(</span><span class="identifier">encoding</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">output</span> <span class="relational-operator">==</span> <span class="string-literal">""</span> <span class="logical-operator">and</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">poll</span><span class="grouping">(</span><span class="grouping">)</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
                <span class="keyword">break</span>
            <span class="keyword">if</span> <span class="identifier">output</span><span class="punctuation">:</span>
                <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"'%s' output: '%s'"</span><span class="punctuation">,</span> <span class="identifier">gitcmd</span><span class="punctuation">,</span> <span class="identifier">output</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
                <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">output</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">retcode</span> <span class="arithmetic-assignment">=</span> <span class="identifier">cmd</span><span class="punctuation">.</span><span class="identifier">poll</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"'%s' returncode: %s"</span><span class="punctuation">,</span> <span class="identifier">gitcmd</span><span class="punctuation">,</span> <span class="identifier">retcode</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">retcode</span> <span class="relational-operator">!=</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">info</span><span class="grouping">(</span><span class="string-literal">"An error occurred during update. return code: %s"</span><span class="punctuation">,</span> <span class="identifier">retcode</span><span class="grouping">)</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">False</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">retval</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">True</span>
        <span class="keyword">return</span> <span class="identifier">retval</span>


<span class="keyword">class</span> <span class="identifier">TaskBar</span><span class="grouping">(</span><span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">)</span><span class="punctuation">:</span>  <span class="comment"># pylint: disable=too-many-ancestors</span>
    <span class="comment">""" Task bar buttons """</span>
    <span class="keyword">def</span> <span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">,</span> <span class="identifier">parent</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">super</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">__init__</span><span class="grouping">(</span><span class="identifier">parent</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_config</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_btn_frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_btn_frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">TOP</span><span class="punctuation">,</span> <span class="identifier">pady</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>

        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_project_btns</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_group_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_task_btns</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_group_separator</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_settings_btns</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_section_separator</span><span class="grouping">(</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_project_btns</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_btn_frame</span><span class="grouping">)</span>
        <span class="identifier">frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">btntype</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"new", "load", "save", "save_as", "reload"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding button: '%s'"</span><span class="punctuation">,</span> <span class="identifier">btntype</span><span class="grouping">)</span>

            <span class="identifier">loader</span><span class="punctuation">,</span> <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_loader_and_kwargs</span><span class="grouping">(</span><span class="identifier">btntype</span><span class="grouping">)</span>
            <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">getattr</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">project</span><span class="punctuation">,</span> <span class="identifier">loader</span><span class="grouping">)</span>
            <span class="identifier">btn</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Button</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span>
                             <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span><span class="grouping">[</span><span class="identifier">btntype</span><span class="grouping">]</span><span class="punctuation">,</span>
                             <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">fn</span><span class="arithmetic-assignment">=</span><span class="identifier">cmd</span><span class="punctuation">,</span> <span class="identifier">kw</span><span class="arithmetic-assignment">=</span><span class="identifier">kwargs</span><span class="punctuation">:</span> <span class="identifier">fn</span><span class="grouping">(</span><span class="arithmetic-operator">**</span><span class="identifier">kw</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">btn</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">set_help</span><span class="grouping">(</span><span class="identifier">btntype</span><span class="grouping">)</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">btn</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_task_btns</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_btn_frame</span><span class="grouping">)</span>
        <span class="identifier">frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="grouping">)</span>

        <span class="keyword">for</span> <span class="identifier">loadtype</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"load", "save", "save_as", "clear", "reload"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">btntype</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"{}2"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">loadtype</span><span class="grouping">)</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding button: '%s'"</span><span class="punctuation">,</span> <span class="identifier">btntype</span><span class="grouping">)</span>

            <span class="identifier">loader</span><span class="punctuation">,</span> <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_loader_and_kwargs</span><span class="grouping">(</span><span class="identifier">loadtype</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">loadtype</span> <span class="relational-operator">==</span> <span class="string-literal">"load"</span><span class="punctuation">:</span>
                <span class="identifier">kwargs</span><span class="grouping">[</span><span class="string-literal">"current_tab"</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="bool-literal">True</span>
            <span class="identifier">cmd</span> <span class="arithmetic-assignment">=</span> <span class="identifier">getattr</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_config</span><span class="punctuation">.</span><span class="identifier">tasks</span><span class="punctuation">,</span> <span class="identifier">loader</span><span class="grouping">)</span>
            <span class="identifier">btn</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Button</span><span class="grouping">(</span>
                <span class="identifier">frame</span><span class="punctuation">,</span>
                <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span><span class="grouping">[</span><span class="identifier">btntype</span><span class="grouping">]</span><span class="punctuation">,</span>
                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">fn</span><span class="arithmetic-assignment">=</span><span class="identifier">cmd</span><span class="punctuation">,</span> <span class="identifier">kw</span><span class="arithmetic-assignment">=</span><span class="identifier">kwargs</span><span class="punctuation">:</span> <span class="identifier">fn</span><span class="grouping">(</span><span class="arithmetic-operator">**</span><span class="identifier">kw</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">btn</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">set_help</span><span class="grouping">(</span><span class="identifier">btntype</span><span class="grouping">)</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">btn</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">_loader_and_kwargs</span><span class="grouping">(</span><span class="identifier">btntype</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="identifier">btntype</span> <span class="relational-operator">==</span> <span class="string-literal">"save"</span><span class="punctuation">:</span>
            <span class="identifier">loader</span> <span class="arithmetic-assignment">=</span> <span class="identifier">btntype</span>
            <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">save_as</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">btntype</span> <span class="relational-operator">==</span> <span class="string-literal">"save_as"</span><span class="punctuation">:</span>
            <span class="identifier">loader</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"save"</span>
            <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="identifier">save_as</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">loader</span> <span class="arithmetic-assignment">=</span> <span class="identifier">btntype</span>
            <span class="identifier">kwargs</span> <span class="arithmetic-assignment">=</span> <span class="identifier">dict</span><span class="grouping">(</span><span class="grouping">)</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"btntype: %s, loader: %s, kwargs: %s"</span><span class="punctuation">,</span> <span class="identifier">btntype</span><span class="punctuation">,</span> <span class="identifier">loader</span><span class="punctuation">,</span> <span class="identifier">kwargs</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">loader</span><span class="punctuation">,</span> <span class="identifier">kwargs</span>

    <span class="keyword">def</span> <span class="identifier">_settings_btns</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment"># pylint: disable=cell-var-from-loop</span>
        <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_btn_frame</span><span class="grouping">)</span>
        <span class="identifier">frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span> <span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="int-literal">2</span><span class="grouping">)</span>
        <span class="keyword">for</span> <span class="identifier">name</span> <span class="relational-operator">in</span> <span class="grouping">(</span><span class="string-literal">"extract", "train", "convert"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">btntype</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"settings_{}"</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">name</span><span class="grouping">)</span>
            <span class="identifier">btntype</span> <span class="arithmetic-assignment">=</span> <span class="identifier">btntype</span> <span class="keyword">if</span> <span class="identifier">btntype</span> <span class="relational-operator">in</span> <span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span> <span class="keyword">else</span> <span class="string-literal">"settings"</span>
            <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Adding button: '%s'"</span><span class="punctuation">,</span> <span class="identifier">btntype</span><span class="grouping">)</span>
            <span class="identifier">btn</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Button</span><span class="grouping">(</span>
                <span class="identifier">frame</span><span class="punctuation">,</span>
                <span class="identifier">image</span><span class="arithmetic-assignment">=</span><span class="identifier">get_images</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">icons</span><span class="grouping">[</span><span class="identifier">btntype</span><span class="grouping">]</span><span class="punctuation">,</span>
                <span class="identifier">command</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">n</span><span class="arithmetic-assignment">=</span><span class="identifier">name</span><span class="punctuation">:</span> <span class="identifier">open_popup</span><span class="grouping">(</span><span class="identifier">name</span><span class="arithmetic-assignment">=</span><span class="identifier">n</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">btn</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">anchor</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">W</span><span class="grouping">)</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Configure {} settings..."</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">name</span><span class="punctuation">.</span><span class="identifier">title</span><span class="grouping">(</span><span class="grouping">)</span><span class="grouping">)</span>
            <span class="identifier">Tooltip</span><span class="grouping">(</span><span class="identifier">btn</span><span class="punctuation">,</span> <span class="identifier">text</span><span class="arithmetic-assignment">=</span><span class="identifier">hlp</span><span class="punctuation">,</span> <span class="identifier">wrap_length</span><span class="arithmetic-assignment">=</span><span class="int-literal">200</span><span class="grouping">)</span>

    <span class="punctuation">@</span><span class="identifier">staticmethod</span>
    <span class="keyword">def</span> <span class="identifier">set_help</span><span class="grouping">(</span><span class="identifier">btntype</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment">""" Set the helptext for option buttons """</span>
        <span class="identifier">logger</span><span class="punctuation">.</span><span class="identifier">debug</span><span class="grouping">(</span><span class="string-literal">"Setting help"</span><span class="grouping">)</span>
        <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>
        <span class="identifier">task</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"currently selected Task") if btntype[-1] == "2" else _("Project"</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">btntype</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"reload"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Reload {} from disk"</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">task</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">btntype</span> <span class="relational-operator">==</span> <span class="string-literal">"new"</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Create a new {}..."</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">task</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">btntype</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"clear"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Reset {} to default"</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">task</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">btntype</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"save") and "_"</span> <span class="logical-operator">not</span> <span class="relational-operator">in</span> <span class="identifier">btntype</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Save {}"</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">task</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">btntype</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"save_as"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Save {} as..."</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">task</span><span class="grouping">)</span>
        <span class="keyword">elif</span> <span class="identifier">btntype</span><span class="punctuation">.</span><span class="identifier">startswith</span><span class="grouping">(</span><span class="string-literal">"load"</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">msg</span> <span class="arithmetic-assignment">=</span> <span class="identifier">task</span>
            <span class="keyword">if</span> <span class="identifier">msg</span><span class="punctuation">.</span><span class="identifier">endswith</span><span class="grouping">(</span><span class="string-literal">"Task"</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="identifier">msg</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">" from a task or project file"</span><span class="grouping">)</span>
            <span class="identifier">hlp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">_</span><span class="grouping">(</span><span class="string-literal">"Load {}..."</span><span class="grouping">)</span><span class="punctuation">.</span><span class="invalid">f</span><span class="invalid">o</span><span class="invalid">r</span><span class="invalid">m</span><span class="invalid">a</span><span class="invalid">t</span><span class="grouping">(</span><span class="identifier">msg</span><span class="grouping">)</span>
        <span class="keyword">return</span> <span class="identifier">hlp</span>

    <span class="keyword">def</span> <span class="identifier">_group_separator</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">separator</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Separator</span><span class="grouping">(</span><span class="identifier">self</span><span class="punctuation">.</span><span class="identifier">_btn_frame</span><span class="punctuation">,</span> <span class="identifier">orient</span><span class="arithmetic-assignment">=</span><span class="string-literal">"vertical"</span><span class="grouping">)</span>
        <span class="identifier">separator</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">padx</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">Y</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="grouping">)</span>

    <span class="keyword">def</span> <span class="identifier">_section_separator</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">frame</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Frame</span><span class="grouping">(</span><span class="identifier">self</span><span class="grouping">)</span>
        <span class="identifier">frame</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">BOTTOM</span><span class="punctuation">,</span> <span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="grouping">)</span>
        <span class="identifier">separator</span> <span class="arithmetic-assignment">=</span> <span class="identifier">ttk</span><span class="punctuation">.</span><span class="identifier">Separator</span><span class="grouping">(</span><span class="identifier">frame</span><span class="punctuation">,</span> <span class="identifier">orient</span><span class="arithmetic-assignment">=</span><span class="string-literal">"horizontal"</span><span class="grouping">)</span>
        <span class="identifier">separator</span><span class="punctuation">.</span><span class="identifier">pack</span><span class="grouping">(</span><span class="identifier">fill</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">X</span><span class="punctuation">,</span> <span class="identifier">side</span><span class="arithmetic-assignment">=</span><span class="identifier">tk</span><span class="punctuation">.</span><span class="identifier">LEFT</span><span class="punctuation">,</span> <span class="identifier">expand</span><span class="arithmetic-assignment">=</span><span class="bool-literal">True</span><span class="grouping">)</span>

    </pre>
  </body>
</html>