<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment"># Primality Testing with the Rabin-Miller Algorithm</span>

<span class="keyword">import</span> <span class="identifier">random</span>


<span class="keyword">def</span> <span class="identifier">rabinMiller</span><span class="grouping">(</span><span class="identifier">num</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">bool</span><span class="punctuation">:</span>
    <span class="identifier">s</span> <span class="arithmetic-assignment">=</span> <span class="identifier">num</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span>
    <span class="identifier">t</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">0</span>

    <span class="keyword">while</span> <span class="identifier">s</span> <span class="arithmetic-operator">%</span> <span class="int-literal">2</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="punctuation">:</span>
        <span class="identifier">s</span> <span class="arithmetic-assignment">=</span> <span class="identifier">s</span> <span class="arithmetic-operator">//</span> <span class="int-literal">2</span>
        <span class="identifier">t</span> <span class="arithmetic-assignment">+=</span> <span class="int-literal">1</span>

    <span class="keyword">for</span> <span class="identifier">trials</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="int-literal">5</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">a</span> <span class="arithmetic-assignment">=</span> <span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randrange</span><span class="grouping">(</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="identifier">num</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">)</span>
        <span class="identifier">v</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pow</span><span class="grouping">(</span><span class="identifier">a</span><span class="punctuation">,</span> <span class="identifier">s</span><span class="punctuation">,</span> <span class="identifier">num</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">v</span> <span class="relational-operator">!=</span> <span class="int-literal">1</span><span class="punctuation">:</span>
            <span class="identifier">i</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">0</span>
            <span class="keyword">while</span> <span class="identifier">v</span> <span class="relational-operator">!=</span> <span class="grouping">(</span><span class="identifier">num</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="keyword">if</span> <span class="identifier">i</span> <span class="relational-operator">==</span> <span class="identifier">t</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="punctuation">:</span>
                    <span class="keyword">return</span> <span class="bool-literal">False</span>
                <span class="keyword">else</span><span class="punctuation">:</span>
                    <span class="identifier">i</span> <span class="arithmetic-assignment">=</span> <span class="identifier">i</span> <span class="arithmetic-operator">+</span> <span class="int-literal">1</span>
                    <span class="identifier">v</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="identifier">v</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span><span class="grouping">)</span> <span class="arithmetic-operator">%</span> <span class="identifier">num</span>
    <span class="keyword">return</span> <span class="bool-literal">True</span>


<span class="keyword">def</span> <span class="identifier">isPrime</span><span class="grouping">(</span><span class="identifier">num</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">bool</span><span class="punctuation">:</span>
    <span class="keyword">if</span> <span class="identifier">num</span> <span class="relational-operator">&lt;</span> <span class="int-literal">2</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="bool-literal">False</span>

    <span class="identifier">lowPrimes</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span>
        <span class="int-literal">2</span><span class="punctuation">,</span>
        <span class="int-literal">3</span><span class="punctuation">,</span>
        <span class="int-literal">5</span><span class="punctuation">,</span>
        <span class="int-literal">7</span><span class="punctuation">,</span>
        <span class="int-literal">11</span><span class="punctuation">,</span>
        <span class="int-literal">13</span><span class="punctuation">,</span>
        <span class="int-literal">17</span><span class="punctuation">,</span>
        <span class="int-literal">19</span><span class="punctuation">,</span>
        <span class="int-literal">23</span><span class="punctuation">,</span>
        <span class="int-literal">29</span><span class="punctuation">,</span>
        <span class="int-literal">31</span><span class="punctuation">,</span>
        <span class="int-literal">37</span><span class="punctuation">,</span>
        <span class="int-literal">41</span><span class="punctuation">,</span>
        <span class="int-literal">43</span><span class="punctuation">,</span>
        <span class="int-literal">47</span><span class="punctuation">,</span>
        <span class="int-literal">53</span><span class="punctuation">,</span>
        <span class="int-literal">59</span><span class="punctuation">,</span>
        <span class="int-literal">61</span><span class="punctuation">,</span>
        <span class="int-literal">67</span><span class="punctuation">,</span>
        <span class="int-literal">71</span><span class="punctuation">,</span>
        <span class="int-literal">73</span><span class="punctuation">,</span>
        <span class="int-literal">79</span><span class="punctuation">,</span>
        <span class="int-literal">83</span><span class="punctuation">,</span>
        <span class="int-literal">89</span><span class="punctuation">,</span>
        <span class="int-literal">97</span><span class="punctuation">,</span>
        <span class="int-literal">101</span><span class="punctuation">,</span>
        <span class="int-literal">103</span><span class="punctuation">,</span>
        <span class="int-literal">107</span><span class="punctuation">,</span>
        <span class="int-literal">109</span><span class="punctuation">,</span>
        <span class="int-literal">113</span><span class="punctuation">,</span>
        <span class="int-literal">127</span><span class="punctuation">,</span>
        <span class="int-literal">131</span><span class="punctuation">,</span>
        <span class="int-literal">137</span><span class="punctuation">,</span>
        <span class="int-literal">139</span><span class="punctuation">,</span>
        <span class="int-literal">149</span><span class="punctuation">,</span>
        <span class="int-literal">151</span><span class="punctuation">,</span>
        <span class="int-literal">157</span><span class="punctuation">,</span>
        <span class="int-literal">163</span><span class="punctuation">,</span>
        <span class="int-literal">167</span><span class="punctuation">,</span>
        <span class="int-literal">173</span><span class="punctuation">,</span>
        <span class="int-literal">179</span><span class="punctuation">,</span>
        <span class="int-literal">181</span><span class="punctuation">,</span>
        <span class="int-literal">191</span><span class="punctuation">,</span>
        <span class="int-literal">193</span><span class="punctuation">,</span>
        <span class="int-literal">197</span><span class="punctuation">,</span>
        <span class="int-literal">199</span><span class="punctuation">,</span>
        <span class="int-literal">211</span><span class="punctuation">,</span>
        <span class="int-literal">223</span><span class="punctuation">,</span>
        <span class="int-literal">227</span><span class="punctuation">,</span>
        <span class="int-literal">229</span><span class="punctuation">,</span>
        <span class="int-literal">233</span><span class="punctuation">,</span>
        <span class="int-literal">239</span><span class="punctuation">,</span>
        <span class="int-literal">241</span><span class="punctuation">,</span>
        <span class="int-literal">251</span><span class="punctuation">,</span>
        <span class="int-literal">257</span><span class="punctuation">,</span>
        <span class="int-literal">263</span><span class="punctuation">,</span>
        <span class="int-literal">269</span><span class="punctuation">,</span>
        <span class="int-literal">271</span><span class="punctuation">,</span>
        <span class="int-literal">277</span><span class="punctuation">,</span>
        <span class="int-literal">281</span><span class="punctuation">,</span>
        <span class="int-literal">283</span><span class="punctuation">,</span>
        <span class="int-literal">293</span><span class="punctuation">,</span>
        <span class="int-literal">307</span><span class="punctuation">,</span>
        <span class="int-literal">311</span><span class="punctuation">,</span>
        <span class="int-literal">313</span><span class="punctuation">,</span>
        <span class="int-literal">317</span><span class="punctuation">,</span>
        <span class="int-literal">331</span><span class="punctuation">,</span>
        <span class="int-literal">337</span><span class="punctuation">,</span>
        <span class="int-literal">347</span><span class="punctuation">,</span>
        <span class="int-literal">349</span><span class="punctuation">,</span>
        <span class="int-literal">353</span><span class="punctuation">,</span>
        <span class="int-literal">359</span><span class="punctuation">,</span>
        <span class="int-literal">367</span><span class="punctuation">,</span>
        <span class="int-literal">373</span><span class="punctuation">,</span>
        <span class="int-literal">379</span><span class="punctuation">,</span>
        <span class="int-literal">383</span><span class="punctuation">,</span>
        <span class="int-literal">389</span><span class="punctuation">,</span>
        <span class="int-literal">397</span><span class="punctuation">,</span>
        <span class="int-literal">401</span><span class="punctuation">,</span>
        <span class="int-literal">409</span><span class="punctuation">,</span>
        <span class="int-literal">419</span><span class="punctuation">,</span>
        <span class="int-literal">421</span><span class="punctuation">,</span>
        <span class="int-literal">431</span><span class="punctuation">,</span>
        <span class="int-literal">433</span><span class="punctuation">,</span>
        <span class="int-literal">439</span><span class="punctuation">,</span>
        <span class="int-literal">443</span><span class="punctuation">,</span>
        <span class="int-literal">449</span><span class="punctuation">,</span>
        <span class="int-literal">457</span><span class="punctuation">,</span>
        <span class="int-literal">461</span><span class="punctuation">,</span>
        <span class="int-literal">463</span><span class="punctuation">,</span>
        <span class="int-literal">467</span><span class="punctuation">,</span>
        <span class="int-literal">479</span><span class="punctuation">,</span>
        <span class="int-literal">487</span><span class="punctuation">,</span>
        <span class="int-literal">491</span><span class="punctuation">,</span>
        <span class="int-literal">499</span><span class="punctuation">,</span>
        <span class="int-literal">503</span><span class="punctuation">,</span>
        <span class="int-literal">509</span><span class="punctuation">,</span>
        <span class="int-literal">521</span><span class="punctuation">,</span>
        <span class="int-literal">523</span><span class="punctuation">,</span>
        <span class="int-literal">541</span><span class="punctuation">,</span>
        <span class="int-literal">547</span><span class="punctuation">,</span>
        <span class="int-literal">557</span><span class="punctuation">,</span>
        <span class="int-literal">563</span><span class="punctuation">,</span>
        <span class="int-literal">569</span><span class="punctuation">,</span>
        <span class="int-literal">571</span><span class="punctuation">,</span>
        <span class="int-literal">577</span><span class="punctuation">,</span>
        <span class="int-literal">587</span><span class="punctuation">,</span>
        <span class="int-literal">593</span><span class="punctuation">,</span>
        <span class="int-literal">599</span><span class="punctuation">,</span>
        <span class="int-literal">601</span><span class="punctuation">,</span>
        <span class="int-literal">607</span><span class="punctuation">,</span>
        <span class="int-literal">613</span><span class="punctuation">,</span>
        <span class="int-literal">617</span><span class="punctuation">,</span>
        <span class="int-literal">619</span><span class="punctuation">,</span>
        <span class="int-literal">631</span><span class="punctuation">,</span>
        <span class="int-literal">641</span><span class="punctuation">,</span>
        <span class="int-literal">643</span><span class="punctuation">,</span>
        <span class="int-literal">647</span><span class="punctuation">,</span>
        <span class="int-literal">653</span><span class="punctuation">,</span>
        <span class="int-literal">659</span><span class="punctuation">,</span>
        <span class="int-literal">661</span><span class="punctuation">,</span>
        <span class="int-literal">673</span><span class="punctuation">,</span>
        <span class="int-literal">677</span><span class="punctuation">,</span>
        <span class="int-literal">683</span><span class="punctuation">,</span>
        <span class="int-literal">691</span><span class="punctuation">,</span>
        <span class="int-literal">701</span><span class="punctuation">,</span>
        <span class="int-literal">709</span><span class="punctuation">,</span>
        <span class="int-literal">719</span><span class="punctuation">,</span>
        <span class="int-literal">727</span><span class="punctuation">,</span>
        <span class="int-literal">733</span><span class="punctuation">,</span>
        <span class="int-literal">739</span><span class="punctuation">,</span>
        <span class="int-literal">743</span><span class="punctuation">,</span>
        <span class="int-literal">751</span><span class="punctuation">,</span>
        <span class="int-literal">757</span><span class="punctuation">,</span>
        <span class="int-literal">761</span><span class="punctuation">,</span>
        <span class="int-literal">769</span><span class="punctuation">,</span>
        <span class="int-literal">773</span><span class="punctuation">,</span>
        <span class="int-literal">787</span><span class="punctuation">,</span>
        <span class="int-literal">797</span><span class="punctuation">,</span>
        <span class="int-literal">809</span><span class="punctuation">,</span>
        <span class="int-literal">811</span><span class="punctuation">,</span>
        <span class="int-literal">821</span><span class="punctuation">,</span>
        <span class="int-literal">823</span><span class="punctuation">,</span>
        <span class="int-literal">827</span><span class="punctuation">,</span>
        <span class="int-literal">829</span><span class="punctuation">,</span>
        <span class="int-literal">839</span><span class="punctuation">,</span>
        <span class="int-literal">853</span><span class="punctuation">,</span>
        <span class="int-literal">857</span><span class="punctuation">,</span>
        <span class="int-literal">859</span><span class="punctuation">,</span>
        <span class="int-literal">863</span><span class="punctuation">,</span>
        <span class="int-literal">877</span><span class="punctuation">,</span>
        <span class="int-literal">881</span><span class="punctuation">,</span>
        <span class="int-literal">883</span><span class="punctuation">,</span>
        <span class="int-literal">887</span><span class="punctuation">,</span>
        <span class="int-literal">907</span><span class="punctuation">,</span>
        <span class="int-literal">911</span><span class="punctuation">,</span>
        <span class="int-literal">919</span><span class="punctuation">,</span>
        <span class="int-literal">929</span><span class="punctuation">,</span>
        <span class="int-literal">937</span><span class="punctuation">,</span>
        <span class="int-literal">941</span><span class="punctuation">,</span>
        <span class="int-literal">947</span><span class="punctuation">,</span>
        <span class="int-literal">953</span><span class="punctuation">,</span>
        <span class="int-literal">967</span><span class="punctuation">,</span>
        <span class="int-literal">971</span><span class="punctuation">,</span>
        <span class="int-literal">977</span><span class="punctuation">,</span>
        <span class="int-literal">983</span><span class="punctuation">,</span>
        <span class="int-literal">991</span><span class="punctuation">,</span>
        <span class="int-literal">997</span><span class="punctuation">,</span>
    <span class="grouping">]</span>

    <span class="keyword">if</span> <span class="identifier">num</span> <span class="relational-operator">in</span> <span class="identifier">lowPrimes</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="bool-literal">True</span>

    <span class="keyword">for</span> <span class="identifier">prime</span> <span class="relational-operator">in</span> <span class="identifier">lowPrimes</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="grouping">(</span><span class="identifier">num</span> <span class="arithmetic-operator">%</span> <span class="identifier">prime</span><span class="grouping">)</span> <span class="relational-operator">==</span> <span class="int-literal">0</span><span class="punctuation">:</span>
            <span class="keyword">return</span> <span class="bool-literal">False</span>

    <span class="keyword">return</span> <span class="identifier">rabinMiller</span><span class="grouping">(</span><span class="identifier">num</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">generateLargePrime</span><span class="grouping">(</span><span class="identifier">keysize</span><span class="punctuation">:</span> <span class="identifier">int</span> <span class="arithmetic-assignment">=</span> <span class="int-literal">1024</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">int</span><span class="punctuation">:</span>
    <span class="keyword">while</span> <span class="bool-literal">True</span><span class="punctuation">:</span>
        <span class="identifier">num</span> <span class="arithmetic-assignment">=</span> <span class="identifier">random</span><span class="punctuation">.</span><span class="identifier">randrange</span><span class="grouping">(</span><span class="int-literal">2</span> <span class="arithmetic-operator">**</span> <span class="grouping">(</span><span class="identifier">keysize</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">,</span> <span class="int-literal">2</span> <span class="arithmetic-operator">**</span> <span class="grouping">(</span><span class="identifier">keysize</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="keyword">if</span> <span class="identifier">isPrime</span><span class="grouping">(</span><span class="identifier">num</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="keyword">return</span> <span class="identifier">num</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="relational-operator">==</span> <span class="string-literal">"__main__"</span><span class="punctuation">:</span>
    <span class="identifier">num</span> <span class="arithmetic-assignment">=</span> <span class="identifier">generateLargePrime</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="grouping">(</span><span class="string-literal">"Prime number:"</span><span class="punctuation">,</span> <span class="identifier">num</span><span class="grouping">)</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="grouping">(</span><span class="string-literal">"isPrime:"</span><span class="punctuation">,</span> <span class="identifier">isPrime</span><span class="grouping">(</span><span class="identifier">num</span><span class="grouping">)</span><span class="grouping">)</span><span class="grouping">)</span>

    </pre>
  </body>
</html>