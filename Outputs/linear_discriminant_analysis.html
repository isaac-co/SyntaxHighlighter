<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="comment">"""
    Linear Discriminant Analysis



    Assumptions About Data :
        1. The input variables has a gaussian distribution.
        2. The variance calculated for each input variables by class grouping is the
           same.
        3. The mix of classes in your training set is representative of the problem.


    Learning The Model :
        The LDA model requires the estimation of statistics from the training data :
            1. Mean of each input value for each class.
            2. Probability of an instance belong to each class.
            3. Covariance for the input data for each class

        Calculate the class means :
            mean(x) = 1/n ( for i = 1 to i = n --&gt; sum(xi))

        Calculate the class probabilities :
            P(y = 0) = count(y = 0) / (count(y = 0) + count(y = 1))
            P(y = 1) = count(y = 1) / (count(y = 0) + count(y = 1))

        Calculate the variance :
            We can calculate the variance for dataset in two steps :
                1. Calculate the squared difference for each input variable from the
                   group mean.
                2. Calculate the mean of the squared difference.
                ------------------------------------------------
                Squared_Difference = (x - mean(k)) ** 2
                Variance = (1 / (count(x) - count(classes))) *
                    (for i = 1 to i = n --&gt; sum(Squared_Difference(xi)))

    Making Predictions :
        discriminant(x) = x * (mean / variance) -
            ((mean ** 2) / (2 * variance)) + Ln(probability)
        ---------------------------------------------------------------------------
        After calculating the discriminant value for each class, the class with the
        largest discriminant value is taken as the prediction.

    Author: @EverLookNeverSee
"""</span>
<span class="keyword">from</span> <span class="identifier">math</span> <span class="keyword">import</span> <span class="identifier">log</span>
<span class="keyword">from</span> <span class="identifier">os</span> <span class="keyword">import</span> <span class="identifier">name</span><span class="punctuation">,</span> <span class="identifier">system</span>
<span class="keyword">from</span> <span class="identifier">random</span> <span class="keyword">import</span> <span class="identifier">gauss</span><span class="punctuation">,</span> <span class="identifier">seed</span>
<span class="keyword">from</span> <span class="identifier">typing</span> <span class="keyword">import</span> <span class="identifier">Callable</span><span class="punctuation">,</span> <span class="identifier">TypeVar</span>


<span class="comment"># Make a training dataset drawn from a gaussian distribution</span>
<span class="keyword">def</span> <span class="identifier">gaussian_distribution</span><span class="grouping">(</span><span class="identifier">mean</span><span class="punctuation">:</span> <span class="identifier">float</span><span class="punctuation">,</span> <span class="identifier">std_dev</span><span class="punctuation">:</span> <span class="identifier">float</span><span class="punctuation">,</span> <span class="identifier">instance_count</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">list</span><span class="punctuation">:</span>
    <span class="comment">"""
    Generate gaussian distribution instances based-on given mean and standard deviation
    :param mean: mean value of class
    :param std_dev: value of standard deviation entered by usr or default value of it
    :param instance_count: instance number of class
    :return: a list containing generated values based-on given mean, std_dev and
        instance_count

    &gt;&gt;&gt; gaussian_distribution(5.0, 1.0, 20) # doctest: +NORMALIZE_WHITESPACE
    [6.288184753155463, 6.4494456086997705, 5.066335808938262, 4.235456349028368,
     3.9078267848958586, 5.031334516831717, 3.977896829989127, 3.56317055489747,
      5.199311976483754, 5.133374604658605, 5.546468300338232, 4.086029056264687,
       5.005005283626573, 4.935258239627312, 3.494170998739258, 5.537997178661033,
        5.320711100998849, 7.3891120432406865, 5.202969177309964, 4.855297691835079]
    """</span>
    <span class="identifier">seed</span><span class="grouping">(</span><span class="int-literal">1</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="grouping">[</span><span class="identifier">gauss</span><span class="grouping">(</span><span class="identifier">mean</span><span class="punctuation">,</span> <span class="identifier">std_dev</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">_</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">instance_count</span><span class="grouping">)</span><span class="grouping">]</span>


<span class="comment"># Make corresponding Y flags to detecting classes</span>
<span class="keyword">def</span> <span class="identifier">y_generator</span><span class="grouping">(</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">c</span><span class="invalid">o</span><span class="invalid">u</span><span class="invalid">n</span><span class="invalid">t</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">instance_count</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">list</span><span class="punctuation">:</span>
    <span class="comment">"""
    Generate y values for corresponding classes
    :param class_count: Number of classes(data groupings) in dataset
    :param instance_count: number of instances in class
    :return: corresponding values for data groupings in dataset

    &gt;&gt;&gt; y_generator(1, [10])
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    &gt;&gt;&gt; y_generator(2, [5, 10])
    [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
    &gt;&gt;&gt; y_generator(4, [10, 5, 15, 20]) # doctest: +NORMALIZE_WHITESPACE
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
     2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
    """</span>

    <span class="keyword">return</span> <span class="grouping">[</span><span class="identifier">k</span> <span class="keyword">for</span> <span class="identifier">k</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="invalid">c</span><span class="invalid">l</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">s</span><span class="invalid">_</span><span class="invalid">c</span><span class="invalid">o</span><span class="invalid">u</span><span class="invalid">n</span><span class="invalid">t</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">_</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">instance_count</span><span class="grouping">[</span><span class="identifier">k</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">]</span>


<span class="comment"># Calculate the class means</span>
<span class="keyword">def</span> <span class="identifier">calculate_mean</span><span class="grouping">(</span><span class="identifier">instance_count</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">items</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">float</span><span class="punctuation">:</span>
    <span class="comment">"""
    Calculate given class mean
    :param instance_count: Number of instances in class
    :param items: items that related to specific class(data grouping)
    :return: calculated actual mean of considered class

    &gt;&gt;&gt; items = gaussian_distribution(5.0, 1.0, 20)
    &gt;&gt;&gt; calculate_mean(len(items), items)
    5.011267842911003
    """</span>
    <span class="comment"># the sum of all items divided by number of instances</span>
    <span class="keyword">return</span> <span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">items</span><span class="grouping">)</span> <span class="arithmetic-operator">/</span> <span class="identifier">instance_count</span>


<span class="comment"># Calculate the class probabilities</span>
<span class="keyword">def</span> <span class="identifier">calculate_probabilities</span><span class="grouping">(</span><span class="identifier">instance_count</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="punctuation">,</span> <span class="identifier">total_count</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">float</span><span class="punctuation">:</span>
    <span class="comment">"""
    Calculate the probability that a given instance will belong to which class
    :param instance_count: number of instances in class
    :param total_count: the number of all instances
    :return: value of probability for considered class

    &gt;&gt;&gt; calculate_probabilities(20, 60)
    0.3333333333333333
    &gt;&gt;&gt; calculate_probabilities(30, 100)
    0.3
    """</span>
    <span class="comment"># number of instances in specific class divided by number of all instances</span>
    <span class="keyword">return</span> <span class="identifier">instance_count</span> <span class="arithmetic-operator">/</span> <span class="identifier">total_count</span>


<span class="comment"># Calculate the variance</span>
<span class="keyword">def</span> <span class="identifier">calculate_variance</span><span class="grouping">(</span><span class="identifier">items</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="punctuation">,</span> <span class="identifier">means</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="punctuation">,</span> <span class="identifier">total_count</span><span class="punctuation">:</span> <span class="identifier">int</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">float</span><span class="punctuation">:</span>
    <span class="comment">"""
    Calculate the variance
    :param items: a list containing all items(gaussian distribution of all classes)
    :param means: a list containing real mean values of each class
    :param total_count: the number of all instances
    :return: calculated variance for considered dataset

    &gt;&gt;&gt; items = gaussian_distribution(5.0, 1.0, 20)
    &gt;&gt;&gt; means = [5.011267842911003]
    &gt;&gt;&gt; total_count = 20
    &gt;&gt;&gt; calculate_variance([items], means, total_count)
    0.9618530973487491
    """</span>
    <span class="identifier">squared_diff</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>  <span class="comment"># An empty list to store all squared differences</span>
    <span class="comment"># iterate over number of elements in items</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">items</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment"># for loop iterates over number of elements in inner layer of items</span>
        <span class="keyword">for</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">items</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="comment"># appending squared differences to 'squared_diff' list</span>
            <span class="identifier">squared_diff</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="grouping">(</span><span class="identifier">items</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-operator">-</span> <span class="identifier">means</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">)</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span><span class="grouping">)</span>

    <span class="comment"># one divided by (the number of all instances - number of classes) multiplied by</span>
    <span class="comment"># sum of all squared differences</span>
    <span class="identifier">n_classes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">means</span><span class="grouping">)</span>  <span class="comment"># Number of classes in dataset</span>
    <span class="keyword">return</span> <span class="int-literal">1</span> <span class="arithmetic-operator">/</span> <span class="grouping">(</span><span class="identifier">total_count</span> <span class="arithmetic-operator">-</span> <span class="identifier">n_classes</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">squared_diff</span><span class="grouping">)</span>


<span class="comment"># Making predictions</span>
<span class="keyword">def</span> <span class="identifier">predict_y_values</span><span class="grouping">(</span>
    <span class="identifier">x_items</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="punctuation">,</span> <span class="identifier">means</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="punctuation">,</span> <span class="identifier">variance</span><span class="punctuation">:</span> <span class="identifier">float</span><span class="punctuation">,</span> <span class="identifier">probabilities</span><span class="punctuation">:</span> <span class="identifier">list</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">list</span><span class="punctuation">:</span>
    <span class="comment">"""This function predicts new indexes(groups for our data)
    :param x_items: a list containing all items(gaussian distribution of all classes)
    :param means: a list containing real mean values of each class
    :param variance: calculated value of variance by calculate_variance function
    :param probabilities: a list containing all probabilities of classes
    :return: a list containing predicted Y values

    &gt;&gt;&gt; x_items = [[6.288184753155463, 6.4494456086997705, 5.066335808938262,
    ...                4.235456349028368, 3.9078267848958586, 5.031334516831717,
    ...                3.977896829989127, 3.56317055489747, 5.199311976483754,
    ...                5.133374604658605, 5.546468300338232, 4.086029056264687,
    ...                5.005005283626573, 4.935258239627312, 3.494170998739258,
    ...                5.537997178661033, 5.320711100998849, 7.3891120432406865,
    ...                5.202969177309964, 4.855297691835079], [11.288184753155463,
    ...                11.44944560869977, 10.066335808938263, 9.235456349028368,
    ...                8.907826784895859, 10.031334516831716, 8.977896829989128,
    ...                8.56317055489747, 10.199311976483754, 10.133374604658606,
    ...                10.546468300338232, 9.086029056264687, 10.005005283626572,
    ...                9.935258239627313, 8.494170998739259, 10.537997178661033,
    ...                10.320711100998848, 12.389112043240686, 10.202969177309964,
    ...                9.85529769183508], [16.288184753155463, 16.449445608699772,
    ...                15.066335808938263, 14.235456349028368, 13.907826784895859,
    ...                15.031334516831716, 13.977896829989128, 13.56317055489747,
    ...                15.199311976483754, 15.133374604658606, 15.546468300338232,
    ...                14.086029056264687, 15.005005283626572, 14.935258239627313,
    ...                13.494170998739259, 15.537997178661033, 15.320711100998848,
    ...                17.389112043240686, 15.202969177309964, 14.85529769183508]]

    &gt;&gt;&gt; means = [5.011267842911003, 10.011267842911003, 15.011267842911002]
    &gt;&gt;&gt; variance = 0.9618530973487494
    &gt;&gt;&gt; probabilities = [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
    &gt;&gt;&gt; predict_y_values(x_items, means, variance,
    ...                  probabilities)  # doctest: +NORMALIZE_WHITESPACE
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    2, 2, 2, 2, 2, 2, 2, 2, 2]

    """</span>
    <span class="comment"># An empty list to store generated discriminant values of all items in dataset for</span>
    <span class="comment"># each class</span>
    <span class="identifier">results</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
    <span class="comment"># for loop iterates over number of elements in list</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">x_items</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="comment"># for loop iterates over number of inner items of each element</span>
        <span class="keyword">for</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">x_items</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>  <span class="comment"># to store all discriminant values of each item as a list</span>
            <span class="comment"># for loop iterates over number of classes we have in our dataset</span>
            <span class="keyword">for</span> <span class="identifier">k</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">x_items</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="comment"># appending values of discriminants for each class to 'temp' list</span>
                <span class="identifier">temp</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span>
                    <span class="identifier">x_items</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span> <span class="arithmetic-operator">*</span> <span class="grouping">(</span><span class="identifier">means</span><span class="grouping">[</span><span class="identifier">k</span><span class="grouping">]</span> <span class="arithmetic-operator">/</span> <span class="identifier">variance</span><span class="grouping">)</span>
                    <span class="arithmetic-operator">-</span> <span class="grouping">(</span><span class="identifier">means</span><span class="grouping">[</span><span class="identifier">k</span><span class="grouping">]</span> <span class="arithmetic-operator">**</span> <span class="int-literal">2</span> <span class="arithmetic-operator">/</span> <span class="grouping">(</span><span class="int-literal">2</span> <span class="arithmetic-operator">*</span> <span class="identifier">variance</span><span class="grouping">)</span><span class="grouping">)</span>
                    <span class="arithmetic-operator">+</span> <span class="identifier">log</span><span class="grouping">(</span><span class="identifier">probabilities</span><span class="grouping">[</span><span class="identifier">k</span><span class="grouping">]</span><span class="grouping">)</span>
                <span class="grouping">)</span>
            <span class="comment"># appending discriminant values of each item to 'results' list</span>
            <span class="identifier">results</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">temp</span><span class="grouping">)</span>

    <span class="keyword">return</span> <span class="grouping">[</span><span class="identifier">result</span><span class="punctuation">.</span><span class="identifier">index</span><span class="grouping">(</span><span class="identifier">max</span><span class="grouping">(</span><span class="identifier">result</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">result</span> <span class="relational-operator">in</span> <span class="identifier">results</span><span class="grouping">]</span>


<span class="comment"># Calculating Accuracy</span>
<span class="keyword">def</span> <span class="identifier">accuracy</span><span class="grouping">(</span><span class="identifier">actual_y</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="punctuation">,</span> <span class="identifier">predicted_y</span><span class="punctuation">:</span> <span class="identifier">list</span><span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">float</span><span class="punctuation">:</span>
    <span class="comment">"""
    Calculate the value of accuracy based-on predictions
    :param actual_y:a list containing initial Y values generated by 'y_generator'
        function
    :param predicted_y: a list containing predicted Y values generated by
        'predict_y_values' function
    :return: percentage of accuracy

    &gt;&gt;&gt; actual_y = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
    ... 1, 1 ,1 ,1 ,1 ,1 ,1]
    &gt;&gt;&gt; predicted_y = [0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0,
    ... 0, 0, 1, 1, 1, 0, 1, 1, 1]
    &gt;&gt;&gt; accuracy(actual_y, predicted_y)
    50.0

    &gt;&gt;&gt; actual_y = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1,
    ... 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
    &gt;&gt;&gt; predicted_y = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
    ... 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
    &gt;&gt;&gt; accuracy(actual_y, predicted_y)
    100.0
    """</span>
    <span class="comment"># iterate over one element of each list at a time (zip mode)</span>
    <span class="comment"># prediction is correct if actual Y value equals to predicted Y value</span>
    <span class="identifier">correct</span> <span class="arithmetic-assignment">=</span> <span class="identifier">sum</span><span class="grouping">(</span><span class="int-literal">1</span> <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">zip</span><span class="grouping">(</span><span class="identifier">actual_y</span><span class="punctuation">,</span> <span class="identifier">predicted_y</span><span class="grouping">)</span> <span class="keyword">if</span> <span class="identifier">i</span> <span class="relational-operator">==</span> <span class="identifier">j</span><span class="grouping">)</span>
    <span class="comment"># percentage of accuracy equals to number of correct predictions divided by number</span>
    <span class="comment"># of all data and multiplied by 100</span>
    <span class="keyword">return</span> <span class="grouping">(</span><span class="identifier">correct</span> <span class="arithmetic-operator">/</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">actual_y</span><span class="grouping">)</span><span class="grouping">)</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span>


<span class="identifier">num</span> <span class="arithmetic-assignment">=</span> <span class="identifier">TypeVar</span><span class="grouping">(</span><span class="string-literal">"num"</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">valid_input</span><span class="grouping">(</span>
    <span class="identifier">input_type</span><span class="punctuation">:</span> <span class="identifier">Callable</span><span class="grouping">[</span><span class="grouping">[</span><span class="identifier">object</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">num</span><span class="grouping">]</span><span class="punctuation">,</span>  <span class="comment"># Usually float or int</span>
    <span class="identifier">input_msg</span><span class="punctuation">:</span> <span class="identifier">str</span><span class="punctuation">,</span>
    <span class="identifier">err_msg</span><span class="punctuation">:</span> <span class="identifier">str</span><span class="punctuation">,</span>
    <span class="identifier">condition</span><span class="punctuation">:</span> <span class="identifier">Callable</span><span class="grouping">[</span><span class="grouping">[</span><span class="identifier">num</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">bool</span><span class="grouping">]</span> <span class="arithmetic-assignment">=</span> <span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="bool-literal">True</span><span class="punctuation">,</span>
    <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="punctuation">:</span> <span class="identifier">str</span> <span class="arithmetic-assignment">=</span> <span class="none-literal">None</span><span class="punctuation">,</span>
<span class="grouping">)</span> <span class="misc">-&gt;</span> <span class="identifier">num</span><span class="punctuation">:</span>
    <span class="comment">"""
    Ask for user value and validate that it fulfill a condition.

    :input_type: user input expected type of value
    :input_msg: message to show user in the screen
    :err_msg: message to show in the screen in case of error
    :condition: function that represents the condition that user input is valid.
    :default: Default value in case the user does not type anything
    :return: user's input
    """</span>
    <span class="keyword">while</span> <span class="bool-literal">True</span><span class="punctuation">:</span>
        <span class="keyword">try</span><span class="punctuation">:</span>
            <span class="identifier">user_input</span> <span class="arithmetic-assignment">=</span> <span class="identifier">input_type</span><span class="grouping">(</span><span class="identifier">input</span><span class="grouping">(</span><span class="identifier">input_msg</span><span class="grouping">)</span><span class="punctuation">.</span><span class="identifier">strip</span><span class="grouping">(</span><span class="grouping">)</span> <span class="logical-operator">or</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="grouping">)</span>
            <span class="keyword">if</span> <span class="identifier">condition</span><span class="grouping">(</span><span class="identifier">user_input</span><span class="grouping">)</span><span class="punctuation">:</span>
                <span class="keyword">return</span> <span class="identifier">user_input</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"{user_input}: {err_msg}"</span><span class="grouping">)</span>
                <span class="keyword">continue</span>
        <span class="keyword">except</span> <span class="identifier">ValueError</span><span class="punctuation">:</span>
            <span class="identifier">print</span><span class="grouping">(</span>
                <span class="identifier">f</span><span class="string-literal">"{user_input}: Incorrect input type, expected {input_type.__name__!r}"</span>
            <span class="grouping">)</span>


<span class="comment"># Main Function</span>
<span class="keyword">def</span> <span class="identifier">main</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""This function starts execution phase"""</span>
    <span class="keyword">while</span> <span class="bool-literal">True</span><span class="punctuation">:</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">" Linear Discriminant Analysis ".center(50, "*"</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"*" * 50, "\n"</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"First of all we should specify the number of classes that"</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"we want to generate as training dataset"</span><span class="grouping">)</span>
        <span class="comment"># Trying to get number of classes</span>
        <span class="identifier">n_classes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">valid_input</span><span class="grouping">(</span>
            <span class="identifier">input_type</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="punctuation">,</span>
            <span class="identifier">condition</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">,</span>
            <span class="identifier">input_msg</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Enter the number of classes (Data Groupings): "</span><span class="punctuation">,</span>
            <span class="identifier">err_msg</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Number of classes should be positive!"</span><span class="punctuation">,</span>
        <span class="grouping">)</span>

        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Trying to get the value of standard deviation</span>
        <span class="identifier">std_dev</span> <span class="arithmetic-assignment">=</span> <span class="identifier">valid_input</span><span class="grouping">(</span>
            <span class="identifier">input_type</span><span class="arithmetic-assignment">=</span><span class="identifier">float</span><span class="punctuation">,</span>
            <span class="identifier">condition</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span> <span class="relational-operator">&gt;=</span> <span class="int-literal">0</span><span class="punctuation">,</span>
            <span class="identifier">input_msg</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span>
                <span class="string-literal">"Enter the value of standard deviation"</span>
                <span class="string-literal">"(Default value is 1.0 for all classes): "</span>
            <span class="grouping">)</span><span class="punctuation">,</span>
            <span class="identifier">err_msg</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Standard deviation should not be negative!"</span><span class="punctuation">,</span>
            <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="string-literal">"1.0"</span><span class="punctuation">,</span>
        <span class="grouping">)</span>

        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Trying to get number of instances in classes and theirs means to generate</span>
        <span class="comment"># dataset</span>
        <span class="identifier">counts</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>  <span class="comment"># An empty list to store instance counts of classes in dataset</span>
        <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">user_count</span> <span class="arithmetic-assignment">=</span> <span class="identifier">valid_input</span><span class="grouping">(</span>
                <span class="identifier">input_type</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="punctuation">,</span>
                <span class="identifier">condition</span><span class="arithmetic-assignment">=</span><span class="keyword">lambda</span> <span class="identifier">x</span><span class="punctuation">:</span> <span class="identifier">x</span> <span class="relational-operator">&gt;</span> <span class="int-literal">0</span><span class="punctuation">,</span>
                <span class="identifier">input_msg</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Enter The number of instances for class_{i+1}: "</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">err_msg</span><span class="arithmetic-assignment">=</span><span class="string-literal">"Number of instances should be positive!"</span><span class="punctuation">,</span>
            <span class="grouping">)</span>
            <span class="identifier">counts</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">user_count</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># An empty list to store values of user-entered means of classes</span>
        <span class="identifier">user_means</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">]</span>
        <span class="keyword">for</span> <span class="identifier">a</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">user_mean</span> <span class="arithmetic-assignment">=</span> <span class="identifier">valid_input</span><span class="grouping">(</span>
                <span class="identifier">input_type</span><span class="arithmetic-assignment">=</span><span class="identifier">float</span><span class="punctuation">,</span>
                <span class="identifier">input_msg</span><span class="arithmetic-assignment">=</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Enter the value of mean for class_{a+1}: "</span><span class="grouping">)</span><span class="punctuation">,</span>
                <span class="identifier">err_msg</span><span class="arithmetic-assignment">=</span><span class="string-literal">"This is an invalid value."</span><span class="punctuation">,</span>
            <span class="grouping">)</span>
            <span class="identifier">user_means</span><span class="punctuation">.</span><span class="identifier">append</span><span class="grouping">(</span><span class="identifier">user_mean</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Standard deviation: "</span><span class="punctuation">,</span> <span class="identifier">std_dev</span><span class="grouping">)</span>
        <span class="comment"># print out the number of instances in classes in separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">count</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">counts</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Number of instances in class_{i} is: {count}"</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># print out mean values of classes separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">user_mean</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">user_means</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Mean of class_{i} is: {user_mean}"</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Generating training dataset drawn from gaussian distribution</span>
        <span class="identifier">x</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span>
            <span class="identifier">gaussian_distribution</span><span class="grouping">(</span><span class="identifier">user_means</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">std_dev</span><span class="punctuation">,</span> <span class="identifier">counts</span><span class="grouping">[</span><span class="identifier">j</span><span class="grouping">]</span><span class="grouping">)</span>
            <span class="keyword">for</span> <span class="identifier">j</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span>
        <span class="grouping">]</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Generated Normal Distribution: \n"</span><span class="punctuation">,</span> <span class="identifier">x</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Generating Ys to detecting corresponding classes</span>
        <span class="identifier">y</span> <span class="arithmetic-assignment">=</span> <span class="identifier">y_generator</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="punctuation">,</span> <span class="identifier">counts</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Generated Corresponding Ys: \n"</span><span class="punctuation">,</span> <span class="identifier">y</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Calculating the value of actual mean for each class</span>
        <span class="identifier">actual_means</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="identifier">calculate_mean</span><span class="grouping">(</span><span class="identifier">counts</span><span class="grouping">[</span><span class="identifier">k</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">x</span><span class="grouping">[</span><span class="identifier">k</span><span class="grouping">]</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">k</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span><span class="grouping">]</span>
        <span class="comment"># for loop iterates over number of elements in 'actual_means' list and print</span>
        <span class="comment"># out them in separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">actual_mean</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">actual_means</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Actual(Real) mean of class_{i} is: {actual_mean}"</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Calculating the value of probabilities for each class</span>
        <span class="identifier">probabilities</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span>
            <span class="identifier">calculate_probabilities</span><span class="grouping">(</span><span class="identifier">counts</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">counts</span><span class="grouping">)</span><span class="grouping">)</span> <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">n_classes</span><span class="grouping">)</span>
        <span class="grouping">]</span>

        <span class="comment"># for loop iterates over number of elements in 'probabilities' list and print</span>
        <span class="comment"># out them in separated line</span>
        <span class="keyword">for</span> <span class="identifier">i</span><span class="punctuation">,</span> <span class="identifier">probability</span> <span class="relational-operator">in</span> <span class="identifier">enumerate</span><span class="grouping">(</span><span class="identifier">probabilities</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="punctuation">:</span>
            <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Probability of class_{i} is: {probability}"</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Calculating the values of variance for each class</span>
        <span class="identifier">variance</span> <span class="arithmetic-assignment">=</span> <span class="identifier">calculate_variance</span><span class="grouping">(</span><span class="identifier">x</span><span class="punctuation">,</span> <span class="identifier">actual_means</span><span class="punctuation">,</span> <span class="identifier">sum</span><span class="grouping">(</span><span class="identifier">counts</span><span class="grouping">)</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Variance: "</span><span class="punctuation">,</span> <span class="identifier">variance</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Predicting Y values</span>
        <span class="comment"># storing predicted Y values in 'pre_indexes' variable</span>
        <span class="identifier">pre_indexes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">predict_y_values</span><span class="grouping">(</span><span class="identifier">x</span><span class="punctuation">,</span> <span class="identifier">actual_means</span><span class="punctuation">,</span> <span class="identifier">variance</span><span class="punctuation">,</span> <span class="identifier">probabilities</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>

        <span class="comment"># Calculating Accuracy of the model</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Accuracy: {accuracy(y, pre_indexes)}"</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"-"</span> <span class="arithmetic-operator">*</span> <span class="int-literal">100</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">" DONE ".center(100, "+"</span><span class="grouping">)</span><span class="grouping">)</span>

        <span class="keyword">if</span> <span class="identifier">input</span><span class="grouping">(</span><span class="string-literal">"Press any key to restart or 'q' for quit: ").strip().lower() == "q"</span><span class="punctuation">:</span>
            <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"\n" + "GoodBye!".center(100, "-") + "\n"</span><span class="grouping">)</span>
            <span class="keyword">break</span>
        <span class="identifier">system</span><span class="grouping">(</span><span class="string-literal">"cls" if name == "nt" else "clear"</span><span class="grouping">)</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="relational-operator">==</span> <span class="string-literal">"__main__"</span><span class="punctuation">:</span>
    <span class="identifier">main</span><span class="grouping">(</span><span class="grouping">)</span>

    </pre>
  </body>
</html>