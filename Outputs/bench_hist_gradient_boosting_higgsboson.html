<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="keyword">from</span> <span class="identifier">urllib</span><span class="punctuation">.</span><span class="identifier">request</span> <span class="keyword">import</span> <span class="identifier">urlretrieve</span>
<span class="keyword">import</span> <span class="identifier">os</span>
<span class="keyword">from</span> <span class="identifier">gzip</span> <span class="keyword">import</span> <span class="identifier">GzipFile</span>
<span class="keyword">from</span> <span class="identifier">time</span> <span class="keyword">import</span> <span class="identifier">time</span>
<span class="keyword">import</span> <span class="identifier">argparse</span>

<span class="keyword">import</span> <span class="identifier">numpy</span> <span class="keyword">as</span> <span class="identifier">np</span>
<span class="keyword">import</span> <span class="identifier">pandas</span> <span class="keyword">as</span> <span class="identifier">pd</span>
<span class="keyword">from</span> <span class="identifier">joblib</span> <span class="keyword">import</span> <span class="identifier">Memory</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">model_selection</span> <span class="keyword">import</span> <span class="identifier">train_test_split</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">metrics</span> <span class="keyword">import</span> <span class="identifier">accuracy_score</span><span class="punctuation">,</span> <span class="identifier">roc_auc_score</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">ensemble</span> <span class="keyword">import</span> <span class="identifier">HistGradientBoostingClassifier</span>
<span class="keyword">from</span> <span class="identifier">sklearn</span><span class="punctuation">.</span><span class="identifier">ensemble</span><span class="punctuation">.</span><span class="identifier">_hist_gradient_boosting</span><span class="punctuation">.</span><span class="identifier">utils</span> <span class="keyword">import</span> <span class="grouping">(</span>
    <span class="identifier">get_equivalent_estimator</span><span class="grouping">)</span>


<span class="identifier">parser</span> <span class="arithmetic-assignment">=</span> <span class="identifier">argparse</span><span class="punctuation">.</span><span class="identifier">ArgumentParser</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--n-leaf-nodes'</span><span class="punctuation">,</span> <span class="identifier">type</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="int-literal">31</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--n-trees'</span><span class="punctuation">,</span> <span class="identifier">type</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="int-literal">10</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--lightgbm'</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="arithmetic-assignment">=</span><span class="string-literal">"store_true"</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--xgboost'</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="arithmetic-assignment">=</span><span class="string-literal">"store_true"</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--catboost'</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="arithmetic-assignment">=</span><span class="string-literal">"store_true"</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--learning-rate'</span><span class="punctuation">,</span> <span class="identifier">type</span><span class="arithmetic-assignment">=</span><span class="identifier">float</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="punctuation">.</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--subsample'</span><span class="punctuation">,</span> <span class="identifier">type</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--max-bins'</span><span class="punctuation">,</span> <span class="identifier">type</span><span class="arithmetic-assignment">=</span><span class="identifier">int</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="int-literal">255</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--no-predict'</span><span class="punctuation">,</span> <span class="identifier">action</span><span class="arithmetic-assignment">=</span><span class="string-literal">"store_true"</span><span class="punctuation">,</span> <span class="invalid">d</span><span class="invalid">e</span><span class="invalid">f</span><span class="invalid">a</span><span class="invalid">u</span><span class="invalid">l</span><span class="invalid">t</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="grouping">)</span>
<span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">add_argument</span><span class="grouping">(</span><span class="string-literal">'--cache-loc', type=str, default='/tmp'</span><span class="grouping">)</span>
<span class="identifier">args</span> <span class="arithmetic-assignment">=</span> <span class="identifier">parser</span><span class="punctuation">.</span><span class="identifier">parse_args</span><span class="grouping">(</span><span class="grouping">)</span>

<span class="identifier">HERE</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">dirname</span><span class="grouping">(</span><span class="identifier">__file__</span><span class="grouping">)</span>
<span class="identifier">URL</span> <span class="arithmetic-assignment">=</span> <span class="grouping">(</span><span class="string-literal">"https://archive.ics.uci.edu/ml/machine-learning-databases/00280/"</span>
       <span class="string-literal">"HIGGS.csv.gz"</span><span class="grouping">)</span>
<span class="identifier">m</span> <span class="arithmetic-assignment">=</span> <span class="identifier">Memory</span><span class="grouping">(</span><span class="identifier">location</span><span class="arithmetic-assignment">=</span><span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">cache_loc</span><span class="punctuation">,</span> <span class="identifier">mmap_mode</span><span class="arithmetic-assignment">=</span><span class="string-literal">'r'</span><span class="grouping">)</span>

<span class="identifier">n_leaf_nodes</span> <span class="arithmetic-assignment">=</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">n_leaf_nodes</span>
<span class="identifier">n_trees</span> <span class="arithmetic-assignment">=</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">n_trees</span>
<span class="identifier">subsample</span> <span class="arithmetic-assignment">=</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">subsample</span>
<span class="identifier">lr</span> <span class="arithmetic-assignment">=</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">learning_rate</span>
<span class="identifier">max_bins</span> <span class="arithmetic-assignment">=</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">max_bins</span>


<span class="punctuation">@</span><span class="identifier">m</span><span class="punctuation">.</span><span class="identifier">cache</span>
<span class="keyword">def</span> <span class="identifier">load_data</span><span class="grouping">(</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">filename</span> <span class="arithmetic-assignment">=</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">join</span><span class="grouping">(</span><span class="identifier">HERE</span><span class="punctuation">,</span> <span class="identifier">URL</span><span class="punctuation">.</span><span class="identifier">rsplit</span><span class="grouping">(</span><span class="string-literal">'/'</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">)</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="keyword">if</span> <span class="logical-operator">not</span> <span class="identifier">os</span><span class="punctuation">.</span><span class="identifier">path</span><span class="punctuation">.</span><span class="identifier">exists</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Downloading {URL} to {filename} (2.6 GB)..."</span><span class="grouping">)</span>
        <span class="identifier">urlretrieve</span><span class="grouping">(</span><span class="identifier">URL</span><span class="punctuation">,</span> <span class="identifier">filename</span><span class="grouping">)</span>
        <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"done."</span><span class="grouping">)</span>

    <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Parsing {filename}..."</span><span class="grouping">)</span>
    <span class="identifier">tic</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="keyword">with</span> <span class="identifier">GzipFile</span><span class="grouping">(</span><span class="identifier">filename</span><span class="grouping">)</span> <span class="keyword">as</span> <span class="identifier">f</span><span class="punctuation">:</span>
        <span class="identifier">df</span> <span class="arithmetic-assignment">=</span> <span class="identifier">pd</span><span class="punctuation">.</span><span class="identifier">read_csv</span><span class="grouping">(</span><span class="identifier">f</span><span class="punctuation">,</span> <span class="identifier">header</span><span class="arithmetic-assignment">=</span><span class="none-literal">None</span><span class="punctuation">,</span> <span class="identifier">dtype</span><span class="arithmetic-assignment">=</span><span class="identifier">np</span><span class="punctuation">.</span><span class="identifier">float32</span><span class="grouping">)</span>
    <span class="identifier">toc</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Loaded {df.values.nbytes / 1e9:0.3f} GB in {toc - tic:0.3f}s"</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">df</span>


<span class="keyword">def</span> <span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="punctuation">,</span> <span class="identifier">libname</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Fitting a {libname} model..."</span><span class="grouping">)</span>
    <span class="identifier">tic</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">est</span><span class="punctuation">.</span><span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="grouping">)</span>
    <span class="identifier">toc</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"fitted in {toc - tic:.3f}s"</span><span class="grouping">)</span>


<span class="keyword">def</span> <span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_test</span><span class="punctuation">,</span> <span class="identifier">target_test</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="keyword">if</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">no_predict</span><span class="punctuation">:</span>
        <span class="keyword">return</span>
    <span class="identifier">tic</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">predicted_test</span> <span class="arithmetic-assignment">=</span> <span class="identifier">est</span><span class="punctuation">.</span><span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">data_test</span><span class="grouping">)</span>
    <span class="identifier">predicted_proba_test</span> <span class="arithmetic-assignment">=</span> <span class="identifier">est</span><span class="punctuation">.</span><span class="identifier">predict_proba</span><span class="grouping">(</span><span class="identifier">data_test</span><span class="grouping">)</span>
    <span class="identifier">toc</span> <span class="arithmetic-assignment">=</span> <span class="identifier">time</span><span class="grouping">(</span><span class="grouping">)</span>
    <span class="identifier">roc_auc</span> <span class="arithmetic-assignment">=</span> <span class="identifier">roc_auc_score</span><span class="grouping">(</span><span class="identifier">target_test</span><span class="punctuation">,</span> <span class="identifier">predicted_proba_test</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">acc</span> <span class="arithmetic-assignment">=</span> <span class="identifier">accuracy_score</span><span class="grouping">(</span><span class="identifier">target_test</span><span class="punctuation">,</span> <span class="identifier">predicted_test</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"predicted in {toc - tic:.3f}s, "</span>
          <span class="identifier">f</span><span class="string-literal">"ROC AUC: {roc_auc:.4f}, ACC: {acc :.4f}"</span><span class="grouping">)</span>


<span class="identifier">df</span> <span class="arithmetic-assignment">=</span> <span class="identifier">load_data</span><span class="grouping">(</span><span class="grouping">)</span>
<span class="identifier">target</span> <span class="arithmetic-assignment">=</span> <span class="identifier">df</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span>
<span class="identifier">data</span> <span class="arithmetic-assignment">=</span> <span class="identifier">np</span><span class="punctuation">.</span><span class="invalid">a</span><span class="invalid">s</span><span class="invalid">c</span><span class="invalid">o</span><span class="invalid">n</span><span class="invalid">t</span><span class="invalid">i</span><span class="invalid">g</span><span class="invalid">u</span><span class="invalid">o</span><span class="invalid">u</span><span class="invalid">s</span><span class="invalid">a</span><span class="invalid">r</span><span class="invalid">r</span><span class="invalid">a</span><span class="invalid">y</span><span class="grouping">(</span><span class="identifier">df</span><span class="punctuation">.</span><span class="identifier">values</span><span class="grouping">[</span><span class="punctuation">:</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">:</span><span class="grouping">]</span><span class="grouping">)</span>
<span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">data_test</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="punctuation">,</span> <span class="identifier">target_test</span> <span class="arithmetic-assignment">=</span> <span class="identifier">train_test_split</span><span class="grouping">(</span>
    <span class="identifier">data</span><span class="punctuation">,</span> <span class="identifier">target</span><span class="punctuation">,</span> <span class="identifier">test_size</span><span class="arithmetic-assignment">=</span><span class="float-literal">.2</span><span class="punctuation">,</span> <span class="identifier">random_state</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="grouping">)</span>

<span class="keyword">if</span> <span class="identifier">subsample</span> <span class="relational-operator">is</span> <span class="logical-operator">not</span> <span class="none-literal">None</span><span class="punctuation">:</span>
    <span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">target_train</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data_train</span><span class="grouping">[</span><span class="punctuation">:</span><span class="identifier">subsample</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="grouping">[</span><span class="punctuation">:</span><span class="identifier">subsample</span><span class="grouping">]</span>

<span class="identifier">n_samples</span><span class="punctuation">,</span> <span class="identifier">n_features</span> <span class="arithmetic-assignment">=</span> <span class="identifier">data_train</span><span class="punctuation">.</span><span class="identifier">shape</span>
<span class="identifier">print</span><span class="grouping">(</span><span class="identifier">f</span><span class="string-literal">"Training set with {n_samples} records with {n_features} features."</span><span class="grouping">)</span>

<span class="identifier">est</span> <span class="arithmetic-assignment">=</span> <span class="identifier">HistGradientBoostingClassifier</span><span class="grouping">(</span><span class="identifier">loss</span><span class="arithmetic-assignment">=</span><span class="string-literal">'binary_crossentropy'</span><span class="punctuation">,</span>
                                     <span class="identifier">learning_rate</span><span class="arithmetic-assignment">=</span><span class="identifier">lr</span><span class="punctuation">,</span>
                                     <span class="identifier">max_iter</span><span class="arithmetic-assignment">=</span><span class="identifier">n_trees</span><span class="punctuation">,</span>
                                     <span class="identifier">max_bins</span><span class="arithmetic-assignment">=</span><span class="identifier">max_bins</span><span class="punctuation">,</span>
                                     <span class="identifier">max_leaf_nodes</span><span class="arithmetic-assignment">=</span><span class="identifier">n_leaf_nodes</span><span class="punctuation">,</span>
                                     <span class="identifier">early_stopping</span><span class="arithmetic-assignment">=</span><span class="bool-literal">False</span><span class="punctuation">,</span>
                                     <span class="identifier">random_state</span><span class="arithmetic-assignment">=</span><span class="int-literal">0</span><span class="punctuation">,</span>
                                     <span class="identifier">verbose</span><span class="arithmetic-assignment">=</span><span class="int-literal">1</span><span class="grouping">)</span>
<span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="punctuation">,</span> <span class="string-literal">'sklearn'</span><span class="grouping">)</span>
<span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_test</span><span class="punctuation">,</span> <span class="identifier">target_test</span><span class="grouping">)</span>

<span class="keyword">if</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">lightgbm</span><span class="punctuation">:</span>
    <span class="identifier">est</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_equivalent_estimator</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">lib</span><span class="arithmetic-assignment">=</span><span class="string-literal">'lightgbm'</span><span class="grouping">)</span>
    <span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="punctuation">,</span> <span class="string-literal">'lightgbm'</span><span class="grouping">)</span>
    <span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_test</span><span class="punctuation">,</span> <span class="identifier">target_test</span><span class="grouping">)</span>

<span class="keyword">if</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">xgboost</span><span class="punctuation">:</span>
    <span class="identifier">est</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_equivalent_estimator</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">lib</span><span class="arithmetic-assignment">=</span><span class="string-literal">'xgboost'</span><span class="grouping">)</span>
    <span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="punctuation">,</span> <span class="string-literal">'xgboost'</span><span class="grouping">)</span>
    <span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_test</span><span class="punctuation">,</span> <span class="identifier">target_test</span><span class="grouping">)</span>

<span class="keyword">if</span> <span class="identifier">args</span><span class="punctuation">.</span><span class="identifier">catboost</span><span class="punctuation">:</span>
    <span class="identifier">est</span> <span class="arithmetic-assignment">=</span> <span class="identifier">get_equivalent_estimator</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">lib</span><span class="arithmetic-assignment">=</span><span class="string-literal">'catboost'</span><span class="grouping">)</span>
    <span class="identifier">fit</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_train</span><span class="punctuation">,</span> <span class="identifier">target_train</span><span class="punctuation">,</span> <span class="string-literal">'catboost'</span><span class="grouping">)</span>
    <span class="identifier">predict</span><span class="grouping">(</span><span class="identifier">est</span><span class="punctuation">,</span> <span class="identifier">data_test</span><span class="punctuation">,</span> <span class="identifier">target_test</span><span class="grouping">)</span>

    </pre>
  </body>
</html>