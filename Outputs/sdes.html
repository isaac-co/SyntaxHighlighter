<html>
  <head>
    <title>Python Lexical Highliter</title>
    <link rel="stylesheet" href="token_colors.css">
  </head>
  <body>
    <pre><span class="keyword">def</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">inp</span><span class="punctuation">,</span> <span class="identifier">table</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    &gt;&gt;&gt; apply_table("0123456789", list(range(10)))
    '9012345678'
    &gt;&gt;&gt; apply_table("0123456789", list(range(9, -1, -1)))
    '8765432109'
    """</span>
    <span class="identifier">res</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">table</span><span class="punctuation">:</span>
        <span class="identifier">res</span> <span class="arithmetic-assignment">+=</span> <span class="identifier">inp</span><span class="grouping">[</span><span class="identifier">i</span> <span class="arithmetic-operator">-</span> <span class="int-literal">1</span><span class="grouping">]</span>
    <span class="keyword">return</span> <span class="identifier">res</span>


<span class="keyword">def</span> <span class="identifier">left_shift</span><span class="grouping">(</span><span class="identifier">data</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    &gt;&gt;&gt; left_shift("0123456789")
    '1234567890'
    """</span>
    <span class="keyword">return</span> <span class="identifier">data</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">:</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">data</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span>


<span class="keyword">def</span> <span class="identifier">XOR</span><span class="grouping">(</span><span class="identifier">a</span><span class="punctuation">,</span> <span class="identifier">b</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="comment">"""
    &gt;&gt;&gt; XOR("01010101", "00001111")
    '01011010'
    """</span>
    <span class="identifier">res</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">""</span>
    <span class="keyword">for</span> <span class="identifier">i</span> <span class="relational-operator">in</span> <span class="identifier">range</span><span class="grouping">(</span><span class="identifier">len</span><span class="grouping">(</span><span class="identifier">a</span><span class="grouping">)</span><span class="grouping">)</span><span class="punctuation">:</span>
        <span class="keyword">if</span> <span class="identifier">a</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span> <span class="relational-operator">==</span> <span class="identifier">b</span><span class="grouping">[</span><span class="identifier">i</span><span class="grouping">]</span><span class="punctuation">:</span>
            <span class="identifier">res</span> <span class="arithmetic-assignment">+=</span> <span class="string-literal">"0"</span>
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="identifier">res</span> <span class="arithmetic-assignment">+=</span> <span class="string-literal">"1"</span>
    <span class="keyword">return</span> <span class="identifier">res</span>


<span class="keyword">def</span> <span class="identifier">apply_sbox</span><span class="grouping">(</span><span class="identifier">s</span><span class="punctuation">,</span> <span class="identifier">data</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">row</span> <span class="arithmetic-assignment">=</span> <span class="identifier">int</span><span class="grouping">(</span><span class="string-literal">"0b"</span> <span class="arithmetic-operator">+</span> <span class="identifier">data</span><span class="grouping">[</span><span class="int-literal">0</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">data</span><span class="grouping">[</span><span class="arithmetic-operator">-</span><span class="int-literal">1</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">)</span>
    <span class="identifier">col</span> <span class="arithmetic-assignment">=</span> <span class="identifier">int</span><span class="grouping">(</span><span class="string-literal">"0b"</span> <span class="arithmetic-operator">+</span> <span class="identifier">data</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">:</span><span class="int-literal">3</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">bin</span><span class="grouping">(</span><span class="identifier">s</span><span class="grouping">[</span><span class="identifier">row</span><span class="grouping">]</span><span class="grouping">[</span><span class="identifier">col</span><span class="grouping">]</span><span class="grouping">)</span><span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">:</span><span class="grouping">]</span>


<span class="keyword">def</span> <span class="identifier">function</span><span class="grouping">(</span><span class="identifier">expansion</span><span class="punctuation">,</span> <span class="identifier">s0</span><span class="punctuation">,</span> <span class="identifier">s1</span><span class="punctuation">,</span> <span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">message</span><span class="grouping">)</span><span class="punctuation">:</span>
    <span class="identifier">left</span> <span class="arithmetic-assignment">=</span> <span class="identifier">message</span><span class="grouping">[</span><span class="punctuation">:</span><span class="int-literal">4</span><span class="grouping">]</span>
    <span class="identifier">right</span> <span class="arithmetic-assignment">=</span> <span class="identifier">message</span><span class="grouping">[</span><span class="int-literal">4</span><span class="punctuation">:</span><span class="grouping">]</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">right</span><span class="punctuation">,</span> <span class="identifier">expansion</span><span class="grouping">)</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">XOR</span><span class="grouping">(</span><span class="identifier">temp</span><span class="punctuation">,</span> <span class="identifier">key</span><span class="grouping">)</span>
    <span class="identifier">l</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_sbox</span><span class="grouping">(</span><span class="identifier">s0</span><span class="punctuation">,</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="int-literal">4</span><span class="grouping">]</span><span class="grouping">)</span>  <span class="comment"># noqa: E741</span>
    <span class="identifier">r</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_sbox</span><span class="grouping">(</span><span class="identifier">s1</span><span class="punctuation">,</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">4</span><span class="punctuation">:</span><span class="grouping">]</span><span class="grouping">)</span>
    <span class="identifier">l</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"0"</span> <span class="arithmetic-operator">*</span> <span class="grouping">(</span><span class="int-literal">2</span> <span class="arithmetic-operator">-</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">l</span><span class="grouping">)</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="identifier">l</span>  <span class="comment"># noqa: E741</span>
    <span class="identifier">r</span> <span class="arithmetic-assignment">=</span> <span class="string-literal">"0"</span> <span class="arithmetic-operator">*</span> <span class="grouping">(</span><span class="int-literal">2</span> <span class="arithmetic-operator">-</span> <span class="identifier">len</span><span class="grouping">(</span><span class="identifier">r</span><span class="grouping">)</span><span class="grouping">)</span> <span class="arithmetic-operator">+</span> <span class="identifier">r</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">l</span> <span class="arithmetic-operator">+</span> <span class="identifier">r</span><span class="punctuation">,</span> <span class="identifier">p4_table</span><span class="grouping">)</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">XOR</span><span class="grouping">(</span><span class="identifier">left</span><span class="punctuation">,</span> <span class="identifier">temp</span><span class="grouping">)</span>
    <span class="keyword">return</span> <span class="identifier">temp</span> <span class="arithmetic-operator">+</span> <span class="identifier">right</span>


<span class="keyword">if</span> <span class="identifier">__name__</span> <span class="relational-operator">==</span> <span class="string-literal">"__main__"</span><span class="punctuation">:</span>

    <span class="identifier">key</span> <span class="arithmetic-assignment">=</span> <span class="identifier">input</span><span class="grouping">(</span><span class="string-literal">"Enter 10 bit key: "</span><span class="grouping">)</span>
    <span class="identifier">message</span> <span class="arithmetic-assignment">=</span> <span class="identifier">input</span><span class="grouping">(</span><span class="string-literal">"Enter 8 bit message: "</span><span class="grouping">)</span>

    <span class="identifier">p8_table</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="int-literal">6</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">7</span><span class="punctuation">,</span> <span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="punctuation">,</span> <span class="int-literal">9</span><span class="grouping">]</span>
    <span class="identifier">p10_table</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">7</span><span class="punctuation">,</span> <span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">10</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">9</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="punctuation">,</span> <span class="int-literal">6</span><span class="grouping">]</span>
    <span class="identifier">p4_table</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span>
    <span class="identifier">IP</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">6</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">7</span><span class="grouping">]</span>
    <span class="identifier">IP_inv</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">5</span><span class="punctuation">,</span> <span class="int-literal">7</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">8</span><span class="punctuation">,</span> <span class="int-literal">6</span><span class="grouping">]</span>
    <span class="identifier">expansion</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">4</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="grouping">]</span>
    <span class="identifier">s0</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">[</span><span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="grouping">]</span><span class="grouping">]</span>
    <span class="identifier">s1</span> <span class="arithmetic-assignment">=</span> <span class="grouping">[</span><span class="grouping">[</span><span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">3</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="grouping">]</span><span class="punctuation">,</span> <span class="grouping">[</span><span class="int-literal">2</span><span class="punctuation">,</span> <span class="int-literal">1</span><span class="punctuation">,</span> <span class="int-literal">0</span><span class="punctuation">,</span> <span class="int-literal">3</span><span class="grouping">]</span><span class="grouping">]</span>

    <span class="comment"># key generation</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">key</span><span class="punctuation">,</span> <span class="identifier">p10_table</span><span class="grouping">)</span>
    <span class="identifier">left</span> <span class="arithmetic-assignment">=</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="int-literal">5</span><span class="grouping">]</span>
    <span class="identifier">right</span> <span class="arithmetic-assignment">=</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">5</span><span class="punctuation">:</span><span class="grouping">]</span>
    <span class="identifier">left</span> <span class="arithmetic-assignment">=</span> <span class="identifier">left_shift</span><span class="grouping">(</span><span class="identifier">left</span><span class="grouping">)</span>
    <span class="identifier">right</span> <span class="arithmetic-assignment">=</span> <span class="identifier">left_shift</span><span class="grouping">(</span><span class="identifier">right</span><span class="grouping">)</span>
    <span class="identifier">key1</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">left</span> <span class="arithmetic-operator">+</span> <span class="identifier">right</span><span class="punctuation">,</span> <span class="identifier">p8_table</span><span class="grouping">)</span>
    <span class="identifier">left</span> <span class="arithmetic-assignment">=</span> <span class="identifier">left_shift</span><span class="grouping">(</span><span class="identifier">left</span><span class="grouping">)</span>
    <span class="identifier">right</span> <span class="arithmetic-assignment">=</span> <span class="identifier">left_shift</span><span class="grouping">(</span><span class="identifier">right</span><span class="grouping">)</span>
    <span class="identifier">left</span> <span class="arithmetic-assignment">=</span> <span class="identifier">left_shift</span><span class="grouping">(</span><span class="identifier">left</span><span class="grouping">)</span>
    <span class="identifier">right</span> <span class="arithmetic-assignment">=</span> <span class="identifier">left_shift</span><span class="grouping">(</span><span class="identifier">right</span><span class="grouping">)</span>
    <span class="identifier">key2</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">left</span> <span class="arithmetic-operator">+</span> <span class="identifier">right</span><span class="punctuation">,</span> <span class="identifier">p8_table</span><span class="grouping">)</span>

    <span class="comment"># encryption</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">message</span><span class="punctuation">,</span> <span class="identifier">IP</span><span class="grouping">)</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">function</span><span class="grouping">(</span><span class="identifier">expansion</span><span class="punctuation">,</span> <span class="identifier">s0</span><span class="punctuation">,</span> <span class="identifier">s1</span><span class="punctuation">,</span> <span class="identifier">key1</span><span class="punctuation">,</span> <span class="identifier">temp</span><span class="grouping">)</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">4</span><span class="punctuation">:</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="int-literal">4</span><span class="grouping">]</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">function</span><span class="grouping">(</span><span class="identifier">expansion</span><span class="punctuation">,</span> <span class="identifier">s0</span><span class="punctuation">,</span> <span class="identifier">s1</span><span class="punctuation">,</span> <span class="identifier">key2</span><span class="punctuation">,</span> <span class="identifier">temp</span><span class="grouping">)</span>
    <span class="identifier">CT</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">temp</span><span class="punctuation">,</span> <span class="identifier">IP_inv</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Cipher text is:"</span><span class="punctuation">,</span> <span class="identifier">CT</span><span class="grouping">)</span>

    <span class="comment"># decryption</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">CT</span><span class="punctuation">,</span> <span class="identifier">IP</span><span class="grouping">)</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">function</span><span class="grouping">(</span><span class="identifier">expansion</span><span class="punctuation">,</span> <span class="identifier">s0</span><span class="punctuation">,</span> <span class="identifier">s1</span><span class="punctuation">,</span> <span class="identifier">key2</span><span class="punctuation">,</span> <span class="identifier">temp</span><span class="grouping">)</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="int-literal">4</span><span class="punctuation">:</span><span class="grouping">]</span> <span class="arithmetic-operator">+</span> <span class="identifier">temp</span><span class="grouping">[</span><span class="punctuation">:</span><span class="int-literal">4</span><span class="grouping">]</span>
    <span class="identifier">temp</span> <span class="arithmetic-assignment">=</span> <span class="identifier">function</span><span class="grouping">(</span><span class="identifier">expansion</span><span class="punctuation">,</span> <span class="identifier">s0</span><span class="punctuation">,</span> <span class="identifier">s1</span><span class="punctuation">,</span> <span class="identifier">key1</span><span class="punctuation">,</span> <span class="identifier">temp</span><span class="grouping">)</span>
    <span class="identifier">PT</span> <span class="arithmetic-assignment">=</span> <span class="identifier">apply_table</span><span class="grouping">(</span><span class="identifier">temp</span><span class="punctuation">,</span> <span class="identifier">IP_inv</span><span class="grouping">)</span>
    <span class="identifier">print</span><span class="grouping">(</span><span class="string-literal">"Plain text after decypting is:"</span><span class="punctuation">,</span> <span class="identifier">PT</span><span class="grouping">)</span>

    </pre>
  </body>
</html>